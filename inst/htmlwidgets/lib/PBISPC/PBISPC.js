var spc=function(t){"use strict";var e="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:e,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(t){var e=t+="",a=e.indexOf(":");return a>=0&&"xmlns"!==(e=t.slice(0,a))&&(t=t.slice(a+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t}function r(t){return function(){var i=this.ownerDocument,a=this.namespaceURI;return a===e&&i.documentElement.namespaceURI===e?i.createElement(t):i.createElementNS(a,t)}}function o(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l(t){var e=a(t);return(e.local?o:r)(e)}function n(){}function s(t){return null==t?n:function(){return this.querySelector(t)}}function u(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function p(){return[]}function d(t){return function(e){return e.matches(t)}}var c=Array.prototype.find;function h(){return this.firstElementChild}var m=Array.prototype.filter;function f(){return Array.from(this.children)}function y(t){return new Array(t.length)}function g(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function v(t,e,i,a,r,o){for(var l,n=0,s=e.length,u=o.length;n<u;++n)(l=e[n])?(l.__data__=o[n],a[n]=l):i[n]=new g(t,o[n]);for(;n<s;++n)(l=e[n])&&(r[n]=l)}function _(t,e,i,a,r,o,l){var n,s,u,p=new Map,d=e.length,c=o.length,h=new Array(d);for(n=0;n<d;++n)(s=e[n])&&(h[n]=u=l.call(s,s.__data__,n,e)+"",p.has(u)?r[n]=s:p.set(u,s));for(n=0;n<c;++n)u=l.call(t,o[n],n,o)+"",(s=p.get(u))?(a[n]=s,s.__data__=o[n],p.delete(u)):i[n]=new g(t,o[n]);for(n=0;n<d;++n)(s=e[n])&&p.get(h[n])===s&&(r[n]=s)}function w(t){return t.__data__}function b(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function N(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function x(t){return function(){this.removeAttribute(t)}}function S(t){return function(){this.removeAttributeNS(t.space,t.local)}}function k(t,e){return function(){this.setAttribute(t,e)}}function A(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function F(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function M(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function E(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function T(t){return function(){this.style.removeProperty(t)}}function $(t,e,i){return function(){this.style.setProperty(t,e,i)}}function D(t,e,i){return function(){var a=e.apply(this,arguments);null==a?this.style.removeProperty(t):this.style.setProperty(t,a,i)}}function L(t){return function(){delete this[t]}}function C(t,e){return function(){this[t]=e}}function P(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function I(t){return t.trim().split(/^|\s+/)}function R(t){return t.classList||new V(t)}function V(t){this._node=t,this._names=I(t.getAttribute("class")||"")}function O(t,e){for(var i=R(t),a=-1,r=e.length;++a<r;)i.add(e[a])}function j(t,e){for(var i=R(t),a=-1,r=e.length;++a<r;)i.remove(e[a])}function U(t){return function(){O(this,t)}}function G(t){return function(){j(this,t)}}function z(t,e){return function(){(e.apply(this,arguments)?O:j)(this,t)}}function B(){this.textContent=""}function q(t){return function(){this.textContent=t}}function H(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Z(){this.innerHTML=""}function Y(t){return function(){this.innerHTML=t}}function X(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(){return null}function Q(){var t=this.parentNode;t&&t.removeChild(this)}function tt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function et(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function it(t){return function(){var e=this.__on;if(e){for(var i,a=0,r=-1,o=e.length;a<o;++a)i=e[a],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function at(t,e,i){return function(){var a,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var l=0,n=r.length;l<n;++l)if((a=r[l]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=i),void(a.value=e);this.addEventListener(t.type,o,i),a={type:t.type,name:t.name,value:e,listener:o,options:i},r?r.push(a):this.__on=[a]}}function rt(t,e,i){var a=E(t),r=a.CustomEvent;"function"==typeof r?r=new r(e,i):(r=a.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ot(t,e){return function(){return rt(this,t,e)}}function lt(t,e){return function(){return rt(this,t,e.apply(this,arguments))}}g.prototype={constructor:g,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},V.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var nt=[null];function st(t,e){this._groups=t,this._parents=e}function ut(t){return"string"==typeof t?new st([[document.querySelector(t)]],[document.documentElement]):new st([[t]],nt)}function pt(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var a=i.createSVGPoint();return a.x=t.clientX,a.y=t.clientY,[(a=a.matrixTransform(e.getScreenCTM().inverse())).x,a.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}function dt(t){return function(){return t}}st.prototype={constructor:st,select:function(t){"function"!=typeof t&&(t=s(t));for(var e=this._groups,i=e.length,a=new Array(i),r=0;r<i;++r)for(var o,l,n=e[r],u=n.length,p=a[r]=new Array(u),d=0;d<u;++d)(o=n[d])&&(l=t.call(o,o.__data__,d,n))&&("__data__"in o&&(l.__data__=o.__data__),p[d]=l);return new st(a,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return u(t.apply(this,arguments))}}(t):function(t){return null==t?p:function(){return this.querySelectorAll(t)}}(t);for(var e=this._groups,i=e.length,a=[],r=[],o=0;o<i;++o)for(var l,n=e[o],s=n.length,d=0;d<s;++d)(l=n[d])&&(a.push(t.call(l,l.__data__,d,n)),r.push(l));return new st(a,r)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return c.call(this.children,t)}}("function"==typeof t?t:d(t)))},selectChildren:function(t){return this.selectAll(null==t?f:function(t){return function(){return m.call(this.children,t)}}("function"==typeof t?t:d(t)))},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,i=e.length,a=new Array(i),r=0;r<i;++r)for(var o,l=e[r],n=l.length,s=a[r]=[],u=0;u<n;++u)(o=l[u])&&t.call(o,o.__data__,u,l)&&s.push(o);return new st(a,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,w);var i=e?_:v,a=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=r.length,l=new Array(o),n=new Array(o),s=new Array(o),u=0;u<o;++u){var p=a[u],d=r[u],c=d.length,h=b(t.call(p,p&&p.__data__,u,a)),m=h.length,f=n[u]=new Array(m),y=l[u]=new Array(m);i(p,d,f,y,s[u]=new Array(c),h,e);for(var g,N,x=0,S=0;x<m;++x)if(g=f[x]){for(x>=S&&(S=x+1);!(N=y[S])&&++S<m;);g._next=N||null}}return(l=new st(l,a))._enter=n,l._exit=s,l},enter:function(){return new st(this._enter||this._groups.map(y),this._parents)},exit:function(){return new st(this._exit||this._groups.map(y),this._parents)},join:function(t,e,i){var a=this.enter(),r=this,o=this.exit();return"function"==typeof t?(a=t(a))&&(a=a.selection()):a=a.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==i?o.remove():i(o),a&&r?a.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,a=e._groups,r=i.length,o=a.length,l=Math.min(r,o),n=new Array(r),s=0;s<l;++s)for(var u,p=i[s],d=a[s],c=p.length,h=n[s]=new Array(c),m=0;m<c;++m)(u=p[m]||d[m])&&(h[m]=u);for(;s<r;++s)n[s]=i[s];return new st(n,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var a,r=t[e],o=r.length-1,l=r[o];--o>=0;)(a=r[o])&&(l&&4^a.compareDocumentPosition(l)&&l.parentNode.insertBefore(a,l),l=a);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=N);for(var i=this._groups,a=i.length,r=new Array(a),o=0;o<a;++o){for(var l,n=i[o],s=n.length,u=r[o]=new Array(s),p=0;p<s;++p)(l=n[p])&&(u[p]=l);u.sort(e)}return new st(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var a=t[e],r=0,o=a.length;r<o;++r){var l=a[r];if(l)return l}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,a=e.length;i<a;++i)for(var r,o=e[i],l=0,n=o.length;l<n;++l)(r=o[l])&&t.call(r,r.__data__,l,o);return this},attr:function(t,e){var i=a(t);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((null==e?i.local?S:x:"function"==typeof e?i.local?M:F:i.local?A:k)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?T:"function"==typeof e?D:$)(t,e,null==i?"":i)):function(t,e){return t.style.getPropertyValue(e)||E(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?L:"function"==typeof e?P:C)(t,e)):this.node()[t]},classed:function(t,e){var i=I(t+"");if(arguments.length<2){for(var a=R(this.node()),r=-1,o=i.length;++r<o;)if(!a.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?z:e?U:G)(i,e))},text:function(t){return arguments.length?this.each(null==t?B:("function"==typeof t?H:q)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Z:("function"==typeof t?X:Y)(t)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:l(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:l(t),a=null==e?J:"function"==typeof e?e:s(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),a.apply(this,arguments)||null)}))},remove:function(){return this.each(Q)},clone:function(t){return this.select(t?et:tt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var a,r,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),l=o.length;if(!(arguments.length<2)){for(n=e?at:it,a=0;a<l;++a)this.each(n(o[a],e,i));return this}var n=this.node().__on;if(n)for(var s,u=0,p=n.length;u<p;++u)for(a=0,s=n[u];a<l;++a)if((r=o[a]).type===s.type&&r.name===s.name)return s.value},dispatch:function(t,e){return this.each(("function"==typeof e?lt:ot)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var a,r=t[e],o=0,l=r.length;o<l;++o)(a=r[o])&&(yield a)}};const ct=Math.cos,ht=Math.min,mt=Math.sin,ft=Math.sqrt,yt=Math.PI,gt=2*yt,vt=Math.PI,_t=2*vt,wt=1e-6,bt=_t-wt;function Nt(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}class xt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Nt:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Nt;const i=10**e;return function(t){this._+=t[0];for(let e=1,a=t.length;e<a;++e)this._+=Math.round(arguments[e]*i)/i+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,i,a){this._append`Q${+t},${+e},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(t,e,i,a,r,o){this._append`C${+t},${+e},${+i},${+a},${this._x1=+r},${this._y1=+o}`}arcTo(t,e,i,a,r){if(t=+t,e=+e,i=+i,a=+a,(r=+r)<0)throw new Error(`negative radius: ${r}`);let o=this._x1,l=this._y1,n=i-t,s=a-e,u=o-t,p=l-e,d=u*u+p*p;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(d>wt)if(Math.abs(p*n-s*u)>wt&&r){let c=i-o,h=a-l,m=n*n+s*s,f=c*c+h*h,y=Math.sqrt(m),g=Math.sqrt(d),v=r*Math.tan((vt-Math.acos((m+d-f)/(2*y*g)))/2),_=v/g,w=v/y;Math.abs(_-1)>wt&&this._append`L${t+_*u},${e+_*p}`,this._append`A${r},${r},0,0,${+(p*c>u*h)},${this._x1=t+w*n},${this._y1=e+w*s}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,i,a,r,o){if(t=+t,e=+e,o=!!o,(i=+i)<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(a),n=i*Math.sin(a),s=t+l,u=e+n,p=1^o,d=o?a-r:r-a;null===this._x1?this._append`M${s},${u}`:(Math.abs(this._x1-s)>wt||Math.abs(this._y1-u)>wt)&&this._append`L${s},${u}`,i&&(d<0&&(d=d%_t+_t),d>bt?this._append`A${i},${i},0,1,${p},${t-l},${e-n}A${i},${i},0,1,${p},${this._x1=s},${this._y1=u}`:d>wt&&this._append`A${i},${i},0,${+(d>=vt)},${p},${this._x1=t+i*Math.cos(r)},${this._y1=e+i*Math.sin(r)}`)}rect(t,e,i,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function St(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(null==i)e=null;else{const t=Math.floor(i);if(!(t>=0))throw new RangeError(`invalid digits: ${i}`);e=t}return t},()=>new xt(e)}function kt(t){this._context=t}function At(t){return new kt(t)}function Ft(t){return t[0]}function Mt(t){return t[1]}kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const Et=ft(3);var Tt={draw(t,e){const i=.59436*ft(e+ht(e/28,.75)),a=i/2,r=a*Et;t.moveTo(0,i),t.lineTo(0,-i),t.moveTo(-r,-a),t.lineTo(r,a),t.moveTo(-r,a),t.lineTo(r,-a)}},$t={draw(t,e){const i=ft(e/yt);t.moveTo(i,0),t.arc(0,0,i,0,gt)}},Dt={draw(t,e){const i=ft(e/5)/2;t.moveTo(-3*i,-i),t.lineTo(-i,-i),t.lineTo(-i,-3*i),t.lineTo(i,-3*i),t.lineTo(i,-i),t.lineTo(3*i,-i),t.lineTo(3*i,i),t.lineTo(i,i),t.lineTo(i,3*i),t.lineTo(-i,3*i),t.lineTo(-i,i),t.lineTo(-3*i,i),t.closePath()}};const Lt=ft(1/3),Ct=2*Lt;var Pt={draw(t,e){const i=ft(e/Ct),a=i*Lt;t.moveTo(0,-i),t.lineTo(a,0),t.lineTo(0,i),t.lineTo(-a,0),t.closePath()}},It={draw(t,e){const i=ft(e),a=-i/2;t.rect(a,a,i,i)}};const Rt=mt(yt/10)/mt(7*yt/10),Vt=mt(gt/10)*Rt,Ot=-ct(gt/10)*Rt;var jt={draw(t,e){const i=ft(.8908130915292852*e),a=Vt*i,r=Ot*i;t.moveTo(0,-i),t.lineTo(a,r);for(let e=1;e<5;++e){const o=gt*e/5,l=ct(o),n=mt(o);t.lineTo(n*i,-l*i),t.lineTo(l*a-n*r,n*a+l*r)}t.closePath()}};const Ut=ft(3);var Gt={draw(t,e){const i=-ft(e/(3*Ut));t.moveTo(0,2*i),t.lineTo(-Ut*i,-i),t.lineTo(Ut*i,-i),t.closePath()}};const zt=-.5,Bt=ft(3)/2,qt=1/ft(12),Ht=3*(qt/2+1);var Zt={draw(t,e){const i=ft(e/Ht),a=i/2,r=i*qt,o=a,l=i*qt+i,n=-o,s=l;t.moveTo(a,r),t.lineTo(o,l),t.lineTo(n,s),t.lineTo(zt*a-Bt*r,Bt*a+zt*r),t.lineTo(zt*o-Bt*l,Bt*o+zt*l),t.lineTo(zt*n-Bt*s,Bt*n+zt*s),t.lineTo(zt*a+Bt*r,zt*r-Bt*a),t.lineTo(zt*o+Bt*l,zt*l-Bt*o),t.lineTo(zt*n+Bt*s,zt*s-Bt*n),t.closePath()}};function Yt(t,e){let i=null,a=St(r);function r(){let r;if(i||(i=r=a()),t.apply(this,arguments).draw(i,+e.apply(this,arguments)),r)return i=null,r+""||null}return t="function"==typeof t?t:dt(t||$t),e="function"==typeof e?e:dt(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"==typeof e?e:dt(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:dt(+t),r):e},r.context=function(t){return arguments.length?(i=null==t?null:t,r):i},r}function Xt(t){return t}var Wt=1e-6;function Kt(t){return"translate("+t+",0)"}function Jt(t){return"translate(0,"+t+")"}function Qt(t){return e=>+t(e)}function te(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function ee(){return!this.__axis}function ie(t,e){var i=[],a=null,r=null,o=6,l=6,n=3,s="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,u=1===t||4===t?-1:1,p=4===t||2===t?"x":"y",d=1===t||3===t?Kt:Jt;function c(c){var h=null==a?e.ticks?e.ticks.apply(e,i):e.domain():a,m=null==r?e.tickFormat?e.tickFormat.apply(e,i):Xt:r,f=Math.max(o,0)+n,y=e.range(),g=+y[0]+s,v=+y[y.length-1]+s,_=(e.bandwidth?te:Qt)(e.copy(),s),w=c.selection?c.selection():c,b=w.selectAll(".domain").data([null]),N=w.selectAll(".tick").data(h,e).order(),x=N.exit(),S=N.enter().append("g").attr("class","tick"),k=N.select("line"),A=N.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge(S),k=k.merge(S.append("line").attr("stroke","currentColor").attr(p+"2",u*o)),A=A.merge(S.append("text").attr("fill","currentColor").attr(p,u*f).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),c!==w&&(b=b.transition(c),N=N.transition(c),k=k.transition(c),A=A.transition(c),x=x.transition(c).attr("opacity",Wt).attr("transform",(function(t){return isFinite(t=_(t))?d(t+s):this.getAttribute("transform")})),S.attr("opacity",Wt).attr("transform",(function(t){var e=this.parentNode.__axis;return d((e&&isFinite(e=e(t))?e:_(t))+s)}))),x.remove(),b.attr("d",4===t||2===t?l?"M"+u*l+","+g+"H"+s+"V"+v+"H"+u*l:"M"+s+","+g+"V"+v:l?"M"+g+","+u*l+"V"+s+"H"+v+"V"+u*l:"M"+g+","+s+"H"+v),N.attr("opacity",1).attr("transform",(function(t){return d(_(t)+s)})),k.attr(p+"2",u*o),A.attr(p,u*f).text(m),w.filter(ee).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),w.each((function(){this.__axis=_}))}return c.scale=function(t){return arguments.length?(e=t,c):e},c.ticks=function(){return i=Array.from(arguments),c},c.tickArguments=function(t){return arguments.length?(i=null==t?[]:Array.from(t),c):i.slice()},c.tickValues=function(t){return arguments.length?(a=null==t?null:Array.from(t),c):a&&a.slice()},c.tickFormat=function(t){return arguments.length?(r=t,c):r},c.tickSize=function(t){return arguments.length?(o=l=+t,c):o},c.tickSizeInner=function(t){return arguments.length?(o=+t,c):o},c.tickSizeOuter=function(t){return arguments.length?(l=+t,c):l},c.tickPadding=function(t){return arguments.length?(n=+t,c):n},c.offset=function(t){return arguments.length?(s=+t,c):s},c}function ae(t){return ie(3,t)}function re(t){return ie(4,t)}function oe(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function le(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ne(t){let e,i,a;function r(t,a,r=0,o=t.length){if(r<o){if(0!==e(a,a))return o;do{const e=r+o>>>1;i(t[e],a)<0?r=e+1:o=e}while(r<o)}return r}return 2!==t.length?(e=oe,i=(e,i)=>oe(t(e),i),a=(e,i)=>t(e)-i):(e=t===oe||t===le?t:se,i=t,a=t),{left:r,center:function(t,e,i=0,o=t.length){const l=r(t,e,i,o-1);return l>i&&a(t[l-1],e)>-a(t[l],e)?l-1:l},right:function(t,a,r=0,o=t.length){if(r<o){if(0!==e(a,a))return o;do{const e=r+o>>>1;i(t[e],a)<=0?r=e+1:o=e}while(r<o)}return r}}}function se(){return 0}const ue=ne(oe).right;ne((function(t){return null===t?NaN:+t})).center;const pe=Math.sqrt(50),de=Math.sqrt(10),ce=Math.sqrt(2);function he(t,e,i){const a=(e-t)/Math.max(0,i),r=Math.floor(Math.log10(a)),o=a/Math.pow(10,r),l=o>=pe?10:o>=de?5:o>=ce?2:1;let n,s,u;return r<0?(u=Math.pow(10,-r)/l,n=Math.round(t*u),s=Math.round(e*u),n/u<t&&++n,s/u>e&&--s,u=-u):(u=Math.pow(10,r)*l,n=Math.round(t/u),s=Math.round(e/u),n*u<t&&++n,s*u>e&&--s),s<n&&.5<=i&&i<2?he(t,e,2*i):[n,s,u]}function me(t,e,i){return he(t=+t,e=+e,i=+i)[2]}function fe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function ye(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function ge(t,e){var i=Object.create(t.prototype);for(var a in e)i[a]=e[a];return i}function ve(){}var _e=.7,we=1/_e,be="\\s*([+-]?\\d+)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Se=/^#([0-9a-f]{3,8})$/,ke=new RegExp(`^rgb\\(${be},${be},${be}\\)$`),Ae=new RegExp(`^rgb\\(${xe},${xe},${xe}\\)$`),Fe=new RegExp(`^rgba\\(${be},${be},${be},${Ne}\\)$`),Me=new RegExp(`^rgba\\(${xe},${xe},${xe},${Ne}\\)$`),Ee=new RegExp(`^hsl\\(${Ne},${xe},${xe}\\)$`),Te=new RegExp(`^hsla\\(${Ne},${xe},${xe},${Ne}\\)$`),$e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function De(){return this.rgb().formatHex()}function Le(){return this.rgb().formatRgb()}function Ce(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=Se.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?Pe(e):3===i?new Ve(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?Ie(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?Ie(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ke.exec(t))?new Ve(e[1],e[2],e[3],1):(e=Ae.exec(t))?new Ve(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Fe.exec(t))?Ie(e[1],e[2],e[3],e[4]):(e=Me.exec(t))?Ie(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ee.exec(t))?Be(e[1],e[2]/100,e[3]/100,1):(e=Te.exec(t))?Be(e[1],e[2]/100,e[3]/100,e[4]):$e.hasOwnProperty(t)?Pe($e[t]):"transparent"===t?new Ve(NaN,NaN,NaN,0):null}function Pe(t){return new Ve(t>>16&255,t>>8&255,255&t,1)}function Ie(t,e,i,a){return a<=0&&(t=e=i=NaN),new Ve(t,e,i,a)}function Re(t,e,i,a){return 1===arguments.length?((r=t)instanceof ve||(r=Ce(r)),r?new Ve((r=r.rgb()).r,r.g,r.b,r.opacity):new Ve):new Ve(t,e,i,null==a?1:a);var r}function Ve(t,e,i,a){this.r=+t,this.g=+e,this.b=+i,this.opacity=+a}function Oe(){return`#${ze(this.r)}${ze(this.g)}${ze(this.b)}`}function je(){const t=Ue(this.opacity);return`${1===t?"rgb(":"rgba("}${Ge(this.r)}, ${Ge(this.g)}, ${Ge(this.b)}${1===t?")":`, ${t})`}`}function Ue(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ge(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ze(t){return((t=Ge(t))<16?"0":"")+t.toString(16)}function Be(t,e,i,a){return a<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new He(t,e,i,a)}function qe(t){if(t instanceof He)return new He(t.h,t.s,t.l,t.opacity);if(t instanceof ve||(t=Ce(t)),!t)return new He;if(t instanceof He)return t;var e=(t=t.rgb()).r/255,i=t.g/255,a=t.b/255,r=Math.min(e,i,a),o=Math.max(e,i,a),l=NaN,n=o-r,s=(o+r)/2;return n?(l=e===o?(i-a)/n+6*(i<a):i===o?(a-e)/n+2:(e-i)/n+4,n/=s<.5?o+r:2-o-r,l*=60):n=s>0&&s<1?0:l,new He(l,n,s,t.opacity)}function He(t,e,i,a){this.h=+t,this.s=+e,this.l=+i,this.opacity=+a}function Ze(t){return(t=(t||0)%360)<0?t+360:t}function Ye(t){return Math.max(0,Math.min(1,t||0))}function Xe(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}ye(ve,Ce,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:De,formatHex:De,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return qe(this).formatHsl()},formatRgb:Le,toString:Le}),ye(Ve,Re,ge(ve,{brighter(t){return t=null==t?we:Math.pow(we,t),new Ve(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?_e:Math.pow(_e,t),new Ve(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ve(Ge(this.r),Ge(this.g),Ge(this.b),Ue(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oe,formatHex:Oe,formatHex8:function(){return`#${ze(this.r)}${ze(this.g)}${ze(this.b)}${ze(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:je,toString:je})),ye(He,(function(t,e,i,a){return 1===arguments.length?qe(t):new He(t,e,i,null==a?1:a)}),ge(ve,{brighter(t){return t=null==t?we:Math.pow(we,t),new He(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?_e:Math.pow(_e,t),new He(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,a=i+(i<.5?i:1-i)*e,r=2*i-a;return new Ve(Xe(t>=240?t-240:t+120,r,a),Xe(t,r,a),Xe(t<120?t+240:t-120,r,a),this.opacity)},clamp(){return new He(Ze(this.h),Ye(this.s),Ye(this.l),Ue(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ue(this.opacity);return`${1===t?"hsl(":"hsla("}${Ze(this.h)}, ${100*Ye(this.s)}%, ${100*Ye(this.l)}%${1===t?")":`, ${t})`}`}}));var We=t=>()=>t;function Ke(t){return 1==(t=+t)?Je:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(a){return Math.pow(t+a*e,i)}}(e,i,t):We(isNaN(e)?i:e)}}function Je(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):We(isNaN(t)?e:t)}var Qe=function t(e){var i=Ke(e);function a(t,e){var a=i((t=Re(t)).r,(e=Re(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),l=Je(t.opacity,e.opacity);return function(e){return t.r=a(e),t.g=r(e),t.b=o(e),t.opacity=l(e),t+""}}return a.gamma=t,a}(1);function ti(t,e){e||(e=[]);var i,a=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(i=0;i<a;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function ei(t,e){var i,a=e?e.length:0,r=t?Math.min(a,t.length):0,o=new Array(r),l=new Array(a);for(i=0;i<r;++i)o[i]=si(t[i],e[i]);for(;i<a;++i)l[i]=e[i];return function(t){for(i=0;i<r;++i)l[i]=o[i](t);return l}}function ii(t,e){var i=new Date;return t=+t,e=+e,function(a){return i.setTime(t*(1-a)+e*a),i}}function ai(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function ri(t,e){var i,a={},r={};for(i in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)i in t?a[i]=si(t[i],e[i]):r[i]=e[i];return function(t){for(i in a)r[i]=a[i](t);return r}}var oi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,li=new RegExp(oi.source,"g");function ni(t,e){var i,a,r,o=oi.lastIndex=li.lastIndex=0,l=-1,n=[],s=[];for(t+="",e+="";(i=oi.exec(t))&&(a=li.exec(e));)(r=a.index)>o&&(r=e.slice(o,r),n[l]?n[l]+=r:n[++l]=r),(i=i[0])===(a=a[0])?n[l]?n[l]+=a:n[++l]=a:(n[++l]=null,s.push({i:l,x:ai(i,a)})),o=li.lastIndex;return o<e.length&&(r=e.slice(o),n[l]?n[l]+=r:n[++l]=r),n.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var i,a=0;a<e;++a)n[(i=s[a]).i]=i.x(t);return n.join("")})}function si(t,e){var i,a=typeof e;return null==e||"boolean"===a?We(e):("number"===a?ai:"string"===a?(i=Ce(e))?(e=i,Qe):ni:e instanceof Ce?Qe:e instanceof Date?ii:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?ti:Array.isArray(e)?ei:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ri:ai)(t,e)}function ui(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}function pi(t){return+t}var di=[0,1];function ci(t){return t}function hi(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function mi(t,e,i){var a=t[0],r=t[1],o=e[0],l=e[1];return r<a?(a=hi(r,a),o=i(l,o)):(a=hi(a,r),o=i(o,l)),function(t){return o(a(t))}}function fi(t,e,i){var a=Math.min(t.length,e.length)-1,r=new Array(a),o=new Array(a),l=-1;for(t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<a;)r[l]=hi(t[l],t[l+1]),o[l]=i(e[l],e[l+1]);return function(e){var i=ue(t,e,1,a)-1;return o[i](r[i](e))}}function yi(){var t,e,i,a,r,o,l=di,n=di,s=si,u=ci;function p(){var t=Math.min(l.length,n.length);return u!==ci&&(u=function(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}(l[0],l[t-1])),a=t>2?fi:mi,r=o=null,d}function d(e){return null==e||isNaN(e=+e)?i:(r||(r=a(l.map(t),n,s)))(t(u(e)))}return d.invert=function(i){return u(e((o||(o=a(n,l.map(t),ai)))(i)))},d.domain=function(t){return arguments.length?(l=Array.from(t,pi),p()):l.slice()},d.range=function(t){return arguments.length?(n=Array.from(t),p()):n.slice()},d.rangeRound=function(t){return n=Array.from(t),s=ui,p()},d.clamp=function(t){return arguments.length?(u=!!t||ci,p()):u!==ci},d.interpolate=function(t){return arguments.length?(s=t,p()):s},d.unknown=function(t){return arguments.length?(i=t,d):i},function(i,a){return t=i,e=a,p()}}function gi(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,a=t.slice(0,i);return[a.length>1?a[0]+a.slice(2):a,+t.slice(i+1)]}function vi(t){return(t=gi(Math.abs(t)))?t[1]:NaN}var _i,wi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bi(t){if(!(e=wi.exec(t)))throw new Error("invalid format: "+t);var e;return new Ni({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Ni(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function xi(t,e){var i=gi(t,e);if(!i)return t+"";var a=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+a:a.length>r+1?a.slice(0,r+1)+"."+a.slice(r+1):a+new Array(r-a.length+2).join("0")}bi.prototype=Ni.prototype,Ni.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Si={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>xi(100*t,e),r:xi,s:function(t,e){var i=gi(t,e);if(!i)return t+"";var a=i[0],r=i[1],o=r-(_i=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,l=a.length;return o===l?a:o>l?a+new Array(o-l+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+gi(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ki(t){return t}var Ai,Fi,Mi,Ei=Array.prototype.map,Ti=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function $i(t){var e,i,a=void 0===t.grouping||void 0===t.thousands?ki:(e=Ei.call(t.grouping,Number),i=t.thousands+"",function(t,a){for(var r=t.length,o=[],l=0,n=e[0],s=0;r>0&&n>0&&(s+n+1>a&&(n=Math.max(1,a-s)),o.push(t.substring(r-=n,r+n)),!((s+=n+1)>a));)n=e[l=(l+1)%e.length];return o.reverse().join(i)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",l=void 0===t.decimal?".":t.decimal+"",n=void 0===t.numerals?ki:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Ei.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"−":t.minus+"",p=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=bi(t)).fill,i=t.align,d=t.sign,c=t.symbol,h=t.zero,m=t.width,f=t.comma,y=t.precision,g=t.trim,v=t.type;"n"===v?(f=!0,v="g"):Si[v]||(void 0===y&&(y=12),g=!0,v="g"),(h||"0"===e&&"="===i)&&(h=!0,e="0",i="=");var _="$"===c?r:"#"===c&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===c?o:/[%p]/.test(v)?s:"",b=Si[v],N=/[defgprs%]/.test(v);function x(t){var r,o,s,c=_,x=w;if("c"===v)x=b(t)+x,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?p:b(Math.abs(t),y),g&&(t=function(t){t:for(var e,i=t.length,a=1,r=-1;a<i;++a)switch(t[a]){case".":r=e=a;break;case"0":0===r&&(r=a),e=a;break;default:if(!+t[a])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==d&&(S=!1),c=(S?"("===d?d:u:"-"===d||"("===d?"":d)+c,x=("s"===v?Ti[8+_i/3]:"")+x+(S&&"("===d?")":""),N)for(r=-1,o=t.length;++r<o;)if(48>(s=t.charCodeAt(r))||s>57){x=(46===s?l+t.slice(r+1):t.slice(r))+x,t=t.slice(0,r);break}}f&&!h&&(t=a(t,1/0));var k=c.length+t.length+x.length,A=k<m?new Array(m-k+1).join(e):"";switch(f&&h&&(t=a(A+t,A.length?m-x.length:1/0),A=""),i){case"<":t=c+t+x+A;break;case"=":t=c+A+t+x;break;case"^":t=A.slice(0,k=A.length>>1)+c+t+x+A.slice(k);break;default:t=A+c+t+x}return n(t)}return y=void 0===y?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),x.toString=function(){return t+""},x}return{format:d,formatPrefix:function(t,e){var i=d(((t=bi(t)).type="f",t)),a=3*Math.max(-8,Math.min(8,Math.floor(vi(e)/3))),r=Math.pow(10,-a),o=Ti[8+a/3];return function(t){return i(r*t)+o}}}}function Di(t,e,i,a){var r,o=function(t,e,i){i=+i;const a=(e=+e)<(t=+t),r=a?me(e,t,i):me(t,e,i);return(a?-1:1)*(r<0?1/-r:r)}(t,e,i);switch((a=bi(null==a?",f":a)).type){case"s":var l=Math.max(Math.abs(t),Math.abs(e));return null!=a.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(vi(e)/3)))-vi(Math.abs(t)))}(o,l))||(a.precision=r),Mi(a,l);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vi(e)-vi(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(a.precision=r-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(r=function(t){return Math.max(0,-vi(Math.abs(t)))}(o))||(a.precision=r-2*("%"===a.type))}return Fi(a)}function Li(t){var e=t.domain;return t.ticks=function(t){var i=e();return function(t,e,i){if(!((i=+i)>0))return[];if((t=+t)==(e=+e))return[t];const a=e<t,[r,o,l]=a?he(e,t,i):he(t,e,i);if(!(o>=r))return[];const n=o-r+1,s=new Array(n);if(a)if(l<0)for(let t=0;t<n;++t)s[t]=(o-t)/-l;else for(let t=0;t<n;++t)s[t]=(o-t)*l;else if(l<0)for(let t=0;t<n;++t)s[t]=(r+t)/-l;else for(let t=0;t<n;++t)s[t]=(r+t)*l;return s}(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,i){var a=e();return Di(a[0],a[a.length-1],null==t?10:t,i)},t.nice=function(i){null==i&&(i=10);var a,r,o=e(),l=0,n=o.length-1,s=o[l],u=o[n],p=10;for(u<s&&(r=s,s=u,u=r,r=l,l=n,n=r);p-- >0;){if((r=me(s,u,i))===a)return o[l]=s,o[n]=u,e(o);if(r>0)s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r;else{if(!(r<0))break;s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r}a=r}return t},t}function Ci(){var t=yi()(ci,ci);return t.copy=function(){return e=t,Ci().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},fe.apply(t,arguments),Li(t)}Ai=$i({thousands:",",grouping:[3],currency:["$",""]}),Fi=Ai.format,Mi=Ai.formatPrefix;var Pi={value:()=>{}};function Ii(){for(var t,e=0,i=arguments.length,a={};e<i;++e){if(!(t=arguments[e]+"")||t in a||/[\s.]/.test(t))throw new Error("illegal type: "+t);a[t]=[]}return new Ri(a)}function Ri(t){this._=t}function Vi(t,e){for(var i,a=0,r=t.length;a<r;++a)if((i=t[a]).name===e)return i.value}function Oi(t,e,i){for(var a=0,r=t.length;a<r;++a)if(t[a].name===e){t[a]=Pi,t=t.slice(0,a).concat(t.slice(a+1));break}return null!=i&&t.push({name:e,value:i}),t}Ri.prototype=Ii.prototype={constructor:Ri,on:function(t,e){var i,a,r=this._,o=(a=r,(t+"").trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");if(i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),t&&!a.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),l=-1,n=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++l<n;)if(i=(t=o[l]).type)r[i]=Oi(r[i],t.name,e);else if(null==e)for(i in r)r[i]=Oi(r[i],t.name,null);return this}for(;++l<n;)if((i=(t=o[l]).type)&&(i=Vi(r[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Ri(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,a,r=new Array(i),o=0;o<i;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,i=(a=this._[t]).length;o<i;++o)a[o].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var a=this._[t],r=0,o=a.length;r<o;++r)a[r].value.apply(e,i)}};const ji={passive:!1},Ui={capture:!0,passive:!1};function Gi(t){t.stopImmediatePropagation()}function zi(t){t.preventDefault(),t.stopImmediatePropagation()}var Bi=t=>()=>t;function qi(t,{sourceEvent:e,subject:i,target:a,identifier:r,active:o,x:l,y:n,dx:s,dy:u,dispatch:p}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:n,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:p}})}function Hi(t){return!t.ctrlKey&&!t.button}function Zi(){return this.parentNode}function Yi(t,e){return null==e?{x:t.x,y:t.y}:e}function Xi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wi(){var t,e,i,a,r=Hi,o=Zi,l=Yi,n=Xi,s={},u=Ii("start","drag","end"),p=0,d=0;function c(t){t.on("mousedown.drag",h).filter(n).on("touchstart.drag",y).on("touchmove.drag",g,ji).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(l,n){if(!a&&r.call(this,l,n)){var s=_(this,o.call(this,l,n),l,n,"mouse");s&&(ut(l.view).on("mousemove.drag",m,Ui).on("mouseup.drag",f,Ui),function(t){var e=t.document.documentElement,i=ut(t).on("dragstart.drag",zi,Ui);"onselectstart"in e?i.on("selectstart.drag",zi,Ui):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(l.view),Gi(l),i=!1,t=l.clientX,e=l.clientY,s("start",l))}}function m(a){if(zi(a),!i){var r=a.clientX-t,o=a.clientY-e;i=r*r+o*o>d}s.mouse("drag",a)}function f(t){ut(t.view).on("mousemove.drag mouseup.drag",null),function(t,e){var i=t.document.documentElement,a=ut(t).on("dragstart.drag",null);e&&(a.on("click.drag",zi,Ui),setTimeout((function(){a.on("click.drag",null)}),0)),"onselectstart"in i?a.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}(t.view,i),zi(t),s.mouse("end",t)}function y(t,e){if(r.call(this,t,e)){var i,a,l=t.changedTouches,n=o.call(this,t,e),s=l.length;for(i=0;i<s;++i)(a=_(this,n,t,e,l[i].identifier,l[i]))&&(Gi(t),a("start",t,l[i]))}}function g(t){var e,i,a=t.changedTouches,r=a.length;for(e=0;e<r;++e)(i=s[a[e].identifier])&&(zi(t),i("drag",t,a[e]))}function v(t){var e,i,r=t.changedTouches,o=r.length;for(a&&clearTimeout(a),a=setTimeout((function(){a=null}),500),e=0;e<o;++e)(i=s[r[e].identifier])&&(Gi(t),i("end",t,r[e]))}function _(t,e,i,a,r,o){var n,d,h,m=u.copy(),f=pt(o||i,e);if(null!=(h=l.call(t,new qi("beforestart",{sourceEvent:i,target:c,identifier:r,active:p,x:f[0],y:f[1],dx:0,dy:0,dispatch:m}),a)))return n=h.x-f[0]||0,d=h.y-f[1]||0,function i(o,l,u){var y,g=f;switch(o){case"start":s[r]=i,y=p++;break;case"end":delete s[r],--p;case"drag":f=pt(u||l,e),y=p}m.call(o,t,new qi(o,{sourceEvent:l,subject:h,target:c,identifier:r,active:y,x:f[0]+n,y:f[1]+d,dx:f[0]-g[0],dy:f[1]-g[1],dispatch:m}),a)}}return c.filter=function(t){return arguments.length?(r="function"==typeof t?t:Bi(!!t),c):r},c.container=function(t){return arguments.length?(o="function"==typeof t?t:Bi(t),c):o},c.subject=function(t){return arguments.length?(l="function"==typeof t?t:Bi(t),c):l},c.touchable=function(t){return arguments.length?(n="function"==typeof t?t:Bi(!!t),c):n},c.on=function(){var t=u.on.apply(u,arguments);return t===u?c:t},c.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,c):Math.sqrt(d)},c}qi.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Ki=Object.freeze({__proto__:null,axisBottom:ae,axisLeft:re,drag:Wi,line:function(t,e){var i=dt(!0),a=null,r=At,o=null,l=St(n);function n(n){var s,u,p,d=(n=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(n)).length,c=!1;for(null==a&&(o=r(p=l())),s=0;s<=d;++s)!(s<d&&i(u=n[s],s,n))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+t(u,s,n),+e(u,s,n));if(p)return o=null,p+""||null}return t="function"==typeof t?t:void 0===t?Ft:dt(t),e="function"==typeof e?e:void 0===e?Mt:dt(e),n.x=function(e){return arguments.length?(t="function"==typeof e?e:dt(+e),n):t},n.y=function(t){return arguments.length?(e="function"==typeof t?t:dt(+t),n):e},n.defined=function(t){return arguments.length?(i="function"==typeof t?t:dt(!!t),n):i},n.curve=function(t){return arguments.length?(r=t,null!=a&&(o=r(a)),n):r},n.context=function(t){return arguments.length?(null==t?a=o=null:o=r(a=t),n):a},n},scaleLinear:Ci,select:ut,selectAll:function(t){return"string"==typeof t?new st([document.querySelectorAll(t)],[document.documentElement]):new st([u(t)],nt)},symbol:Yt,symbolAsterisk:Tt,symbolCircle:$t,symbolCross:Dt,symbolDiamond:Pt,symbolSquare:It,symbolStar:jt,symbolTriangle:Gt,symbolWye:Zt});const Ji="#00B0F0",Qi="#E46C0A",ta="#490092",ea="#490092",ia="#A6A6A6",aa="#6495ED",ra="#000000",oa={font:{default:"'Arial', sans-serif",valid:["'Arial', sans-serif","Arial","'Arial Black'","'Arial Unicode MS'","Calibri","Cambria","'Cambria Math'","Candara","'Comic Sans MS'","Consolas","Constantia","Corbel","'Courier New'","wf_standard-font, helvetica, arial, sans-serif","wf_standard-font_light, helvetica, arial, sans-serif","Georgia","'Lucida Sans Unicode'","'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif","'Segoe UI Light', wf_segoe-ui_light, helvetica, arial, sans-serif","'Segoe UI Semibold', wf_segoe-ui_semibold, helvetica, arial, sans-serif","'Segoe UI Bold', wf_segoe-ui_bold, helvetica, arial, sans-serif","Symbol","Tahoma","'Times New Roman'","'Trebuchet MS'","Verdana","Wingdings"]},size:{default:10,options:{minValue:{value:0},maxValue:{value:100}}},weight:{default:"normal",valid:["normal","bold","bolder","lighter"]},text_transform:{default:"uppercase",valid:["uppercase","lowercase","capitalize","none"]},text_overflow:{default:"ellipsis",valid:["ellipsis","clip","none"]},text_align:{default:"center",valid:["center","left","right"]}},la={width:{default:1,options:{minValue:{value:0}}},style:{default:"solid",valid:["solid","dotted","dashed","double","groove","ridge","inset","outset","none"]},colour:{default:"#000000"}},na={canvas:{description:"Canvas Settings",displayName:"Canvas Settings",settingsGroups:{all:{show_errors:{displayName:"Show Errors on Canvas",type:"ToggleSwitch",default:!0},lower_padding:{displayName:"Padding Below Plot (pixels):",type:"NumUpDown",default:10},upper_padding:{displayName:"Padding Above Plot (pixels):",type:"NumUpDown",default:10},left_padding:{displayName:"Padding Left of Plot (pixels):",type:"NumUpDown",default:10},right_padding:{displayName:"Padding Right of Plot (pixels):",type:"NumUpDown",default:10}}}},spc:{description:"SPC Settings",displayName:"Data Settings",settingsGroups:{all:{chart_type:{displayName:"Chart Type",type:"Dropdown",default:"i",valid:["run","i","i_m","i_mm","mr","p","pp","u","up","c","xbar","s","g","t"],items:[{displayName:"run - Run Chart",value:"run"},{displayName:"i - Individual Measurements",value:"i"},{displayName:"i_m - Individual Measurements: Median centerline",value:"i_m"},{displayName:"i_mm - Individual Measurements: Median centerline, Median MR Limits",value:"i_mm"},{displayName:"mr - Moving Range of Individual Measurements",value:"mr"},{displayName:"p - Proportions",value:"p"},{displayName:"p prime - Proportions: Large-Sample Corrected",value:"pp"},{displayName:"u - Rates",value:"u"},{displayName:"u prime - Rates: Large-Sample Correction",value:"up"},{displayName:"c - Counts",value:"c"},{displayName:"xbar - Sample Means",value:"xbar"},{displayName:"s - Sample SDs",value:"s"},{displayName:"g - Number of Non-Events Between Events",value:"g"},{displayName:"t - Time Between Events",value:"t"}]},outliers_in_limits:{displayName:"Keep Outliers in Limit Calcs.",type:"ToggleSwitch",default:!1},multiplier:{displayName:"Multiplier",type:"NumUpDown",default:1,options:{minValue:{value:0}}},sig_figs:{displayName:"Decimals to Report:",type:"NumUpDown",default:2,options:{minValue:{value:0},maxValue:{value:20}}},perc_labels:{displayName:"Report as percentage",type:"Dropdown",default:"Automatic",valid:["Automatic","Yes","No"],items:[{displayName:"Automatic",value:"Automatic"},{displayName:"Yes",value:"Yes"},{displayName:"No",value:"No"}]},split_on_click:{displayName:"Split Limits on Click",type:"ToggleSwitch",default:!1},num_points_subset:{displayName:"Subset Number of Points for Limit Calculations",type:"NumUpDown",default:null},subset_points_from:{displayName:"Subset Points From",type:"Dropdown",default:"Start",valid:["Start","End"],items:[{displayName:"Start",value:"Start"},{displayName:"End",value:"End"}]},ttip_show_date:{displayName:"Show Date in Tooltip",type:"ToggleSwitch",default:!0},ttip_label_date:{displayName:"Date Tooltip Label",type:"TextInput",default:"Automatic"},ttip_show_numerator:{displayName:"Show Numerator in Tooltip",type:"ToggleSwitch",default:!0},ttip_label_numerator:{displayName:"Numerator Tooltip Label",type:"TextInput",default:"Numerator"},ttip_show_denominator:{displayName:"Show Denominator in Tooltip",type:"ToggleSwitch",default:!0},ttip_label_denominator:{displayName:"Denominator Tooltip Label",type:"TextInput",default:"Denominator"},ttip_show_value:{displayName:"Show Value in Tooltip",type:"ToggleSwitch",default:!0},ttip_label_value:{displayName:"Value Tooltip Label",type:"TextInput",default:"Automatic"},ll_truncate:{displayName:"Truncate Lower Limits at:",type:"NumUpDown",default:null},ul_truncate:{displayName:"Truncate Upper Limits at:",type:"NumUpDown",default:null}}}},outliers:{description:"Outlier Settings",displayName:"Outlier Settings",settingsGroups:{General:{process_flag_type:{displayName:"Type of Change to Flag",type:"Dropdown",default:"both",valid:["both","improvement","deterioration"],items:[{displayName:"Both",value:"both"},{displayName:"Improvement (Imp.)",value:"improvement"},{displayName:"Deterioration (Det.)",value:"deterioration"}]},improvement_direction:{displayName:"Improvement Direction",type:"Dropdown",default:"increase",valid:["increase","neutral","decrease"],items:[{displayName:"Increase",value:"increase"},{displayName:"Neutral",value:"neutral"},{displayName:"Decrease",value:"decrease"}]}},"Astronomical Points":{astronomical:{displayName:"Highlight Astronomical Points",type:"ToggleSwitch",default:!1},astronomical_limit:{displayName:"Limit for Astronomical Points",type:"Dropdown",default:"3 Sigma",valid:["1 Sigma","2 Sigma","3 Sigma","Specification"],items:[{displayName:"1 Sigma",value:"1 Sigma"},{displayName:"2 Sigma",value:"2 Sigma"},{displayName:"3 Sigma",value:"3 Sigma"},{displayName:"Specification",value:"Specification"}]},ast_colour_improvement:{displayName:"Imp. Ast. Colour",type:"ColorPicker",default:Ji},ast_colour_deterioration:{displayName:"Det. Ast. Colour",type:"ColorPicker",default:Qi},ast_colour_neutral_low:{displayName:"Neutral (Low) Ast. Colour",type:"ColorPicker",default:ta},ast_colour_neutral_high:{displayName:"Neutral (High) Ast. Colour",type:"ColorPicker",default:ea}},Shifts:{shift:{displayName:"Highlight Shifts",type:"ToggleSwitch",default:!1},shift_n:{displayName:"Shift Points",type:"NumUpDown",default:7,options:{minValue:{value:1}}},shift_colour_improvement:{displayName:"Imp. Shift Colour",type:"ColorPicker",default:Ji},shift_colour_deterioration:{displayName:"Det. Shift Colour",type:"ColorPicker",default:Qi},shift_colour_neutral_low:{displayName:"Neutral (Low) Shift Colour",type:"ColorPicker",default:ta},shift_colour_neutral_high:{displayName:"Neutral (High) Shift Colour",type:"ColorPicker",default:ea}},Trends:{trend:{displayName:"Highlight Trends",type:"ToggleSwitch",default:!1},trend_n:{displayName:"Trend Points",type:"NumUpDown",default:5,options:{minValue:{value:1}}},trend_colour_improvement:{displayName:"Imp. Trend Colour",type:"ColorPicker",default:Ji},trend_colour_deterioration:{displayName:"Det. Trend Colour",type:"ColorPicker",default:Qi},trend_colour_neutral_low:{displayName:"Neutral (Low) Trend Colour",type:"ColorPicker",default:ta},trend_colour_neutral_high:{displayName:"Neutral (High) Trend Colour",type:"ColorPicker",default:ea}},"Two-In-Three":{two_in_three:{displayName:"Highlight Two-in-Three",type:"ToggleSwitch",default:!1},two_in_three_highlight_series:{displayName:"Highlight all in Pattern",type:"ToggleSwitch",default:!1},two_in_three_limit:{displayName:"Warning Limit for Two-in-Three",type:"Dropdown",default:"2 Sigma",valid:["1 Sigma","2 Sigma","3 Sigma","Specification"],items:[{displayName:"1 Sigma",value:"1 Sigma"},{displayName:"2 Sigma",value:"2 Sigma"},{displayName:"3 Sigma",value:"3 Sigma"},{displayName:"Specification",value:"Specification"}]},twointhree_colour_improvement:{displayName:"Imp. Two-in-Three Colour",type:"ColorPicker",default:Ji},twointhree_colour_deterioration:{displayName:"Det. Two-in-Three Colour",type:"ColorPicker",default:Qi},twointhree_colour_neutral_low:{displayName:"Neutral (Low) Two-in-Three Colour",type:"ColorPicker",default:ta},twointhree_colour_neutral_high:{displayName:"Neutral (High) Two-in-Three Colour",type:"ColorPicker",default:ea}}}},nhs_icons:{description:"NHS Icons Settings",displayName:"NHS Icons Settings",settingsGroups:{all:{show_variation_icons:{displayName:"Show Variation Icons",type:"ToggleSwitch",default:!1},flag_last_point:{displayName:"Flag Only Last Point",type:"ToggleSwitch",default:!0},variation_icons_locations:{displayName:"Variation Icon Locations",type:"Dropdown",default:"Top Right",valid:["Top Right","Bottom Right","Top Left","Bottom Left"],items:[{displayName:"Top Right",value:"Top Right"},{displayName:"Bottom Right",value:"Bottom Right"},{displayName:"Top Left",value:"Top Left"},{displayName:"Bottom Left",value:"Bottom Left"}]},variation_icons_scaling:{displayName:"Scale Variation Icon Size",type:"NumUpDown",default:1,options:{minValue:{value:0}}},show_assurance_icons:{displayName:"Show Assurance Icons",type:"ToggleSwitch",default:!1},assurance_icons_locations:{displayName:"Assurance Icon Locations",type:"Dropdown",default:"Top Right",valid:["Top Right","Bottom Right","Top Left","Bottom Left"],items:[{displayName:"Top Right",value:"Top Right"},{displayName:"Bottom Right",value:"Bottom Right"},{displayName:"Top Left",value:"Top Left"},{displayName:"Bottom Left",value:"Bottom Left"}]},assurance_icons_scaling:{displayName:"Scale Assurance Icon Size",type:"NumUpDown",default:1,options:{minValue:{value:0}}}}}},scatter:{description:"Scatter Settings",displayName:"Scatter Settings",settingsGroups:{all:{shape:{displayName:"Shape",type:"Dropdown",default:"Circle",valid:["Circle","Cross","Diamond","Square","Star","Triangle","Wye"],items:[{displayName:"Circle",value:"Circle"},{displayName:"Cross",value:"Cross"},{displayName:"Diamond",value:"Diamond"},{displayName:"Square",value:"Square"},{displayName:"Star",value:"Star"},{displayName:"Triangle",value:"Triangle"},{displayName:"Wye",value:"Wye"}]},size:{displayName:"Size",type:"NumUpDown",default:2.5,options:{minValue:{value:0},maxValue:{value:100}}},colour:{displayName:"Colour",type:"ColorPicker",default:ia},colour_outline:{displayName:"Outline Colour",type:"ColorPicker",default:ia},width_outline:{displayName:"Outline Width",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:100}}},opacity:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_selected:{displayName:"Opacity if Selected",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected:{displayName:"Opacity if Unselected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}}}}},lines:{description:"Line Settings",displayName:"Line Settings",settingsGroups:{Main:{show_main:{displayName:"Show Main Line",type:"ToggleSwitch",default:!0},width_main:{displayName:"Main Line Width",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:100}}},type_main:{displayName:"Main Line Type",type:"Dropdown",default:"10 0",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_main:{displayName:"Main Line Colour",type:"ColorPicker",default:ia},opacity_main:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_main:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_main:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},plot_label_show_main:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_main:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_main:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_main:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["above","below","beside"],items:[{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_main:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_main:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_main:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_main:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_main:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_main:{displayName:"Value Prefix",type:"TextInput",default:""}},Target:{show_target:{displayName:"Show Target",type:"ToggleSwitch",default:!0},width_target:{displayName:"Line Width",type:"NumUpDown",default:1.5,options:{minValue:{value:0},maxValue:{value:100}}},type_target:{displayName:"Line Type",type:"Dropdown",default:"10 0",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_target:{displayName:"Line Colour",type:"ColorPicker",default:ra},opacity_target:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_target:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_target:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_target:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_target:{displayName:"Tooltip Label",type:"TextInput",default:"Centerline"},plot_label_show_target:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_target:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_target:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_target:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["above","below","beside"],items:[{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_target:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_target:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_target:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_target:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_target:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_target:{displayName:"Value Prefix",type:"TextInput",default:""}},"Alt. Target":{show_alt_target:{displayName:"Show Alt. Target Line",type:"ToggleSwitch",default:!1},alt_target:{displayName:"Additional Target Value:",type:"NumUpDown",default:null},multiplier_alt_target:{displayName:"Apply Multiplier to Alt. Target",type:"ToggleSwitch",default:!1},width_alt_target:{displayName:"Line Width",type:"NumUpDown",default:1.5,options:{minValue:{value:0},maxValue:{value:100}}},type_alt_target:{displayName:"Line Type",type:"Dropdown",default:"10 0",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_alt_target:{displayName:"Line Colour",type:"ColorPicker",default:ra},opacity_alt_target:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_alt_target:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_alt_target:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_alt_target:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_alt_target:{displayName:"Tooltip Label",type:"TextInput",default:"Alt. Target"},plot_label_show_alt_target:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_alt_target:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_alt_target:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_alt_target:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["above","below","beside"],items:[{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_alt_target:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_alt_target:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_alt_target:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_alt_target:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_alt_target:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_alt_target:{displayName:"Value Prefix",type:"TextInput",default:""}},"68% Limits":{show_68:{displayName:"Show 68% Lines",type:"ToggleSwitch",default:!1},width_68:{displayName:"Line Width",type:"NumUpDown",default:2,options:{minValue:{value:0},maxValue:{value:100}}},type_68:{displayName:"Line Type",type:"Dropdown",default:"2 5",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_68:{displayName:"Line Colour",type:"ColorPicker",default:aa},opacity_68:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_68:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_68:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_68:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_68:{displayName:"Tooltip Label",type:"TextInput",default:"68% Limit"},ttip_label_68_prefix_lower:{displayName:"Tooltip Label - Lower Prefix",type:"TextInput",default:"Lower "},ttip_label_68_prefix_upper:{displayName:"Tooltip Label - Upper Prefix",type:"TextInput",default:"Upper "},plot_label_show_68:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_68:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_68:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_68:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["outside","inside","above","below","beside"],items:[{displayName:"Outside",value:"outside"},{displayName:"Inside",value:"inside"},{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_68:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_68:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_68:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_68:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_68:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_68:{displayName:"Value Prefix",type:"TextInput",default:""}},"95% Limits":{show_95:{displayName:"Show 95% Lines",type:"ToggleSwitch",default:!0},width_95:{displayName:"Line Width",type:"NumUpDown",default:2,options:{minValue:{value:0},maxValue:{value:100}}},type_95:{displayName:"Line Type",type:"Dropdown",default:"2 5",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_95:{displayName:"Line Colour",type:"ColorPicker",default:aa},opacity_95:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_95:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_95:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_95:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_95:{displayName:"Tooltip Label",type:"TextInput",default:"95% Limit"},ttip_label_95_prefix_lower:{displayName:"Tooltip Label - Lower Prefix",type:"TextInput",default:"Lower "},ttip_label_95_prefix_upper:{displayName:"Tooltip Label - Upper Prefix",type:"TextInput",default:"Upper "},plot_label_show_95:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_95:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_95:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_95:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["outside","inside","above","below","beside"],items:[{displayName:"Outside",value:"outside"},{displayName:"Inside",value:"inside"},{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_95:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_95:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_95:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_95:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_95:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_95:{displayName:"Value Prefix",type:"TextInput",default:""}},"99% Limits":{show_99:{displayName:"Show 99% Lines",type:"ToggleSwitch",default:!0},width_99:{displayName:"Line Width",type:"NumUpDown",default:2,options:{minValue:{value:0},maxValue:{value:100}}},type_99:{displayName:"Line Type",type:"Dropdown",default:"10 10",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_99:{displayName:"Line Colour",type:"ColorPicker",default:aa},opacity_99:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_99:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_99:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_99:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_99:{displayName:"Tooltip Label",type:"TextInput",default:"99% Limit"},ttip_label_99_prefix_lower:{displayName:"Tooltip Label - Lower Prefix",type:"TextInput",default:"Lower "},ttip_label_99_prefix_upper:{displayName:"Tooltip Label - Upper Prefix",type:"TextInput",default:"Upper "},plot_label_show_99:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_99:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_99:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_99:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["outside","inside","above","below","beside"],items:[{displayName:"Outside",value:"outside"},{displayName:"Inside",value:"inside"},{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_99:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_99:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_99:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_99:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_99:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_99:{displayName:"Value Prefix",type:"TextInput",default:""}},"Specification Limits":{show_specification:{displayName:"Show Specification Lines",type:"ToggleSwitch",default:!1},specification_upper:{displayName:"Upper Specification Limit:",type:"NumUpDown",default:null},specification_lower:{displayName:"Lower Specification Limit:",type:"NumUpDown",default:null},multiplier_specification:{displayName:"Apply Multiplier to Specification Limits",type:"ToggleSwitch",default:!1},width_specification:{displayName:"Line Width",type:"NumUpDown",default:2,options:{minValue:{value:0},maxValue:{value:100}}},type_specification:{displayName:"Line Type",type:"Dropdown",default:"10 10",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_specification:{displayName:"Line Colour",type:"ColorPicker",default:aa},opacity_specification:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_specification:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_specification:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_specification:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_specification:{displayName:"Tooltip Label",type:"TextInput",default:"specification Limit"},ttip_label_specification_prefix_lower:{displayName:"Tooltip Label - Lower Prefix",type:"TextInput",default:"Lower "},ttip_label_specification_prefix_upper:{displayName:"Tooltip Label - Upper Prefix",type:"TextInput",default:"Upper "},plot_label_show_specification:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_specification:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_specification:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_specification:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["outside","inside","above","below","beside"],items:[{displayName:"Outside",value:"outside"},{displayName:"Inside",value:"inside"},{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_specification:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_specification:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_specification:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_specification:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_specification:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_specification:{displayName:"Value Prefix",type:"TextInput",default:""}},Trend:{show_trend:{displayName:"Show Trend",type:"ToggleSwitch",default:!1},width_trend:{displayName:"Line Width",type:"NumUpDown",default:1.5,options:{minValue:{value:0},maxValue:{value:100}}},type_trend:{displayName:"Line Type",type:"Dropdown",default:"10 0",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},colour_trend:{displayName:"Line Colour",type:"ColorPicker",default:ia},opacity_trend:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},opacity_unselected_trend:{displayName:"Opacity if Any Selected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},join_rebaselines_trend:{displayName:"Connect Rebaselined Limits",type:"ToggleSwitch",default:!1},ttip_show_trend:{displayName:"Show value in tooltip",type:"ToggleSwitch",default:!0},ttip_label_trend:{displayName:"Tooltip Label",type:"TextInput",default:"Centerline"},plot_label_show_trend:{displayName:"Show Value on Plot",type:"ToggleSwitch",default:!1},plot_label_show_all_trend:{displayName:"Show Value at all Re-Baselines",type:"ToggleSwitch",default:!1},plot_label_show_n_trend:{displayName:"Show Value at Last N Re-Baselines",type:"NumUpDown",default:1,options:{minValue:{value:1}}},plot_label_position_trend:{displayName:"Position of Value on Line(s)",type:"Dropdown",default:"beside",valid:["above","below","beside"],items:[{displayName:"Above",value:"above"},{displayName:"Below",value:"below"},{displayName:"Beside",value:"beside"}]},plot_label_vpad_trend:{displayName:"Value Vertical Padding",type:"NumUpDown",default:0},plot_label_hpad_trend:{displayName:"Value Horizontal Padding",type:"NumUpDown",default:10},plot_label_font_trend:{displayName:"Value Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},plot_label_size_trend:{displayName:"Value Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},plot_label_colour_trend:{displayName:"Value Colour",type:"ColorPicker",default:ra},plot_label_prefix_trend:{displayName:"Value Prefix",type:"TextInput",default:""}}}},x_axis:{description:"X Axis Settings",displayName:"X Axis Settings",settingsGroups:{Axis:{xlimit_colour:{displayName:"Axis Colour",type:"ColorPicker",default:ra},xlimit_l:{displayName:"Lower Limit",type:"NumUpDown",default:null},xlimit_u:{displayName:"Upper Limit",type:"NumUpDown",default:null}},Ticks:{xlimit_ticks:{displayName:"Draw Ticks",type:"ToggleSwitch",default:!0},xlimit_tick_count:{displayName:"Maximum Ticks",type:"NumUpDown",default:10,options:{minValue:{value:0},maxValue:{value:100}}},xlimit_tick_font:{displayName:"Tick Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},xlimit_tick_size:{displayName:"Tick Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},xlimit_tick_colour:{displayName:"Tick Font Colour",type:"ColorPicker",default:ra},xlimit_tick_rotation:{displayName:"Tick Rotation (Degrees)",type:"NumUpDown",default:-35,options:{minValue:{value:-360},maxValue:{value:360}}}},Label:{xlimit_label:{displayName:"Label",type:"TextInput",default:null},xlimit_label_font:{displayName:"Label Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},xlimit_label_size:{displayName:"Label Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},xlimit_label_colour:{displayName:"Label Font Colour",type:"ColorPicker",default:ra}}}},y_axis:{description:"Y Axis Settings",displayName:"Y Axis Settings",settingsGroups:{Axis:{ylimit_colour:{displayName:"Axis Colour",type:"ColorPicker",default:ra},limit_multiplier:{displayName:"Axis Scaling Factor",type:"NumUpDown",default:1.5,options:{minValue:{value:0}}},ylimit_sig_figs:{displayName:"Tick Decimal Places",type:"NumUpDown",default:null,options:{minValue:{value:0},maxValue:{value:100}}},ylimit_l:{displayName:"Lower Limit",type:"NumUpDown",default:null},ylimit_u:{displayName:"Upper Limit",type:"NumUpDown",default:null}},Ticks:{ylimit_ticks:{displayName:"Draw Ticks",type:"ToggleSwitch",default:!0},ylimit_tick_count:{displayName:"Maximum Ticks",type:"NumUpDown",default:10,options:{minValue:{value:0},maxValue:{value:100}}},ylimit_tick_font:{displayName:"Tick Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},ylimit_tick_size:{displayName:"Tick Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},ylimit_tick_colour:{displayName:"Tick Font Colour",type:"ColorPicker",default:ra},ylimit_tick_rotation:{displayName:"Tick Rotation (Degrees)",type:"NumUpDown",default:0,options:{minValue:{value:-360},maxValue:{value:360}}}},Label:{ylimit_label:{displayName:"Label",type:"TextInput",default:null},ylimit_label_font:{displayName:"Label Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},ylimit_label_size:{displayName:"Label Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},ylimit_label_colour:{displayName:"Label Font Colour",type:"ColorPicker",default:ra}}}},dates:{description:"Date Settings",displayName:"Date Settings",settingsGroups:{all:{date_format_day:{displayName:"Day Format",type:"Dropdown",default:"DD",valid:["DD","Thurs DD","Thursday DD","(blank)"],items:[{displayName:"DD",value:"DD"},{displayName:"Thurs DD",value:"Thurs DD"},{displayName:"Thursday DD",value:"Thursday DD"},{displayName:"(blank)",value:"(blank)"}]},date_format_month:{displayName:"Month Format",type:"Dropdown",default:"MM",valid:["MM","Mon","Month","(blank)"],items:[{displayName:"MM",value:"MM"},{displayName:"Mon",value:"Mon"},{displayName:"Month",value:"Month"},{displayName:"(blank)",value:"(blank)"}]},date_format_year:{displayName:"Year Format",type:"Dropdown",default:"YYYY",valid:["YYYY","YY","(blank)"],items:[{displayName:"YYYY",value:"YYYY"},{displayName:"YY",value:"YY"},{displayName:"(blank)",value:"(blank)"}]},date_format_delim:{displayName:"Delimiter",type:"Dropdown",default:"/",valid:["/","-"," "],items:[{displayName:"/",value:"/"},{displayName:"-",value:"-"},{displayName:" ",value:" "}]},date_format_locale:{displayName:"Locale",type:"Dropdown",default:"en-GB",valid:["en-GB","en-US"],items:[{displayName:"en-GB",value:"en-GB"},{displayName:"en-US",value:"en-US"}]}}}},summary_table:{description:"Summary Table Settings",displayName:"Summary Table Settings",settingsGroups:{General:{show_table:{displayName:"Show Summary Table",type:"ToggleSwitch",default:!1},table_variation_filter:{displayName:"Filter by Variation Type",type:"Dropdown",default:"all",valid:["all","common","special","improvement","deterioration","neutral"],items:[{displayName:"All",value:"all"},{displayName:"Common Cause",value:"common"},{displayName:"Special Cause - Any",value:"special"},{displayName:"Special Cause - Improvement",value:"improvement"},{displayName:"Special Cause - Deterioration",value:"deterioration"},{displayName:"Special Cause - Neutral",value:"neutral"}]},table_assurance_filter:{displayName:"Filter by Assurance Type",type:"Dropdown",default:"all",valid:["all","any","pass","fail","inconsistent"],items:[{displayName:"All",value:"all"},{displayName:"Consistent - Any",value:"any"},{displayName:"Consistent Pass",value:"pass"},{displayName:"Consistent Fail",value:"fail"},{displayName:"Inconsistent",value:"inconsistent"}]},table_text_overflow:{displayName:"Text Overflow Handling",type:"Dropdown",default:oa.text_overflow.default,valid:oa.text_overflow.valid,items:[{displayName:"Ellipsis",value:"ellipsis"},{displayName:"Truncate",value:"clip"},{displayName:"None",value:"none"}]},table_opacity:{displayName:"Default Opacity",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},table_opacity_selected:{displayName:"Opacity if Selected",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:1}}},table_opacity_unselected:{displayName:"Opacity if Unselected",type:"NumUpDown",default:.2,options:{minValue:{value:0},maxValue:{value:1}}},table_outer_border_style:{displayName:"Outer Border Style",type:"Dropdown",default:la.style.default,valid:la.style.valid,items:[{displayName:"Solid",value:"solid"},{displayName:"Dashed",value:"dashed"},{displayName:"Dotted",value:"dotted"},{displayName:"Double",value:"double"},{displayName:"Groove",value:"groove"},{displayName:"Ridge",value:"ridge"},{displayName:"Inset",value:"inset"},{displayName:"Outset",value:"outset"}]},table_outer_border_width:{displayName:"Outer Border Width",type:"NumUpDown",default:la.width.default,options:la.width.options},table_outer_border_colour:{displayName:"Outer Border Colour",type:"ColorPicker",default:la.colour.default},table_outer_border_top:{displayName:"Outer Border Top",type:"ToggleSwitch",default:!0},table_outer_border_bottom:{displayName:"Outer Border Bottom",type:"ToggleSwitch",default:!0},table_outer_border_left:{displayName:"Outer Border Left",type:"ToggleSwitch",default:!0},table_outer_border_right:{displayName:"Outer Border Right",type:"ToggleSwitch",default:!0}},Header:{table_header_font:{displayName:"Header Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},table_header_size:{displayName:"Header Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},table_header_text_align:{displayName:"Text Alignment",type:"AlignmentGroup",default:oa.text_align.default,valid:oa.text_align.valid},table_header_font_weight:{displayName:"Header Font Weight",type:"Dropdown",default:oa.weight.default,valid:oa.weight.valid,items:[{displayName:"Normal",value:"normal"},{displayName:"Bold",value:"bold"}]},table_header_text_transform:{displayName:"Header Text Transform",type:"Dropdown",default:oa.text_transform.default,valid:oa.text_transform.valid,items:[{displayName:"Uppercase",value:"uppercase"},{displayName:"Lowercase",value:"lowercase"},{displayName:"Capitalise",value:"capitalize"},{displayName:"None",value:"none"}]},table_header_text_padding:{displayName:"Padding Around Text",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:100}}},table_header_colour:{displayName:"Header Font Colour",type:"ColorPicker",default:ra},table_header_bg_colour:{displayName:"Header Background Colour",type:"ColorPicker",default:"#D3D3D3"},table_header_border_style:{displayName:"Header Border Style",type:"Dropdown",default:la.style.default,valid:la.style.valid,items:[{displayName:"Solid",value:"solid"},{displayName:"Dashed",value:"dashed"},{displayName:"Dotted",value:"dotted"},{displayName:"Double",value:"double"},{displayName:"Groove",value:"groove"},{displayName:"Ridge",value:"ridge"},{displayName:"Inset",value:"inset"},{displayName:"Outset",value:"outset"}]},table_header_border_width:{displayName:"Header Border Width",type:"NumUpDown",default:la.width.default,options:la.width.options},table_header_border_colour:{displayName:"Header Border Colour",type:"ColorPicker",default:la.colour.default},table_header_border_bottom:{displayName:"Bottom Border",type:"ToggleSwitch",default:!0},table_header_border_inner:{displayName:"Inner Borders",type:"ToggleSwitch",default:!0}},Body:{table_body_font:{displayName:"Body Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},table_body_size:{displayName:"Body Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},table_body_text_align:{displayName:"Text Alignment",type:"AlignmentGroup",default:oa.text_align.default,valid:oa.text_align.valid},table_body_font_weight:{displayName:"Font Weight",type:"Dropdown",default:oa.weight.default,valid:oa.weight.valid,items:[{displayName:"Normal",value:"normal"},{displayName:"Bold",value:"bold"}]},table_body_text_transform:{displayName:"Text Transform",type:"Dropdown",default:oa.text_transform.default,valid:oa.text_transform.valid,items:[{displayName:"Uppercase",value:"uppercase"},{displayName:"Lowercase",value:"lowercase"},{displayName:"Capitalise",value:"capitalize"},{displayName:"None",value:"none"}]},table_body_text_padding:{displayName:"Padding Around Text",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:100}}},table_body_colour:{displayName:"Body Font Colour",type:"ColorPicker",default:ra},table_body_bg_colour:{displayName:"Body Background Colour",type:"ColorPicker",default:"#FFFFFF"},table_body_border_style:{displayName:"Body Border Style",type:"Dropdown",default:la.style.default,valid:la.style.valid,items:[{displayName:"Solid",value:"solid"},{displayName:"Dashed",value:"dashed"},{displayName:"Dotted",value:"dotted"},{displayName:"Double",value:"double"},{displayName:"Groove",value:"groove"},{displayName:"Ridge",value:"ridge"},{displayName:"Inset",value:"inset"},{displayName:"Outset",value:"outset"}]},table_body_border_width:{displayName:"Body Border Width",type:"NumUpDown",default:la.width.default,options:la.width.options},table_body_border_colour:{displayName:"Body Border Colour",type:"ColorPicker",default:la.colour.default},table_body_border_top_bottom:{displayName:"Top/Bottom Borders",type:"ToggleSwitch",default:!0},table_body_border_left_right:{displayName:"Left/Right Borders",type:"ToggleSwitch",default:!0}}}},download_options:{description:"Download Options",displayName:"Download Options",settingsGroups:{all:{show_button:{displayName:"Show Download Button",type:"ToggleSwitch",default:!1}}}},labels:{description:"Labels Settings",displayName:"Labels Settings",settingsGroups:{all:{show_labels:{displayName:"Show Value Labels",type:"ToggleSwitch",default:!0},label_position:{displayName:"Label Position",type:"Dropdown",default:"top",valid:["top","bottom"],items:[{displayName:"Top",value:"top"},{displayName:"Bottom",value:"bottom"}]},label_y_offset:{displayName:"Label Offset from Top/Bottom (px)",type:"NumUpDown",default:20},label_line_offset:{displayName:"Label Offset from Connecting Line (px)",type:"NumUpDown",default:5},label_angle_offset:{displayName:"Label Angle Offset (degrees)",type:"NumUpDown",default:0,options:{minValue:{value:-90},maxValue:{value:90}}},label_font:{displayName:"Label Font",type:"FontPicker",default:oa.font.default,valid:oa.font.valid},label_size:{displayName:"Label Font Size",type:"NumUpDown",default:oa.size.default,options:oa.size.options},label_colour:{displayName:"Label Font Colour",type:"ColorPicker",default:ra},label_line_colour:{displayName:"Connecting Line Colour",type:"ColorPicker",default:ra},label_line_width:{displayName:"Connecting Line Width",type:"NumUpDown",default:1,options:{minValue:{value:0},maxValue:{value:100}}},label_line_type:{displayName:"Connecting Line Type",type:"Dropdown",default:"10 0",valid:["10 0","10 10","2 5"],items:[{displayName:"Solid",value:"10 0"},{displayName:"Dashed",value:"10 10"},{displayName:"Dotted",value:"2 5"}]},label_line_max_length:{displayName:"Max Connecting Line Length (px)",type:"NumUpDown",default:1e3,options:{minValue:{value:0},maxValue:{value:1e4}}},label_marker_show:{displayName:"Show Line Markers",type:"ToggleSwitch",default:!0},label_marker_offset:{displayName:"Marker Offset from Value (px)",type:"NumUpDown",default:5},label_marker_size:{displayName:"Marker Size",type:"NumUpDown",default:3,options:{minValue:{value:0},maxValue:{value:100}}},label_marker_colour:{displayName:"Marker Fill Colour",type:"ColorPicker",default:ra},label_marker_outline_colour:{displayName:"Marker Outline Colour",type:"ColorPicker",default:ra}}}}},sa=[];for(const t in na){const e=[];for(const i in na[t].settingsGroups)for(const a in na[t].settingsGroups[i])e.push([a,na[t].settingsGroups[i][a]]);sa.push([t,Object.fromEntries(e)])}const ua=Object.fromEntries(sa);function pa(t,e){e.plotProperties.displayPlot||e.viewModel.inputSettings.settings.summary_table.show_table||e.viewModel.showGrouped?t.on("contextmenu",(t=>{const i=ut(t.target).datum();e.selectionManager.showContextMenu(i?i.identity:{},{x:t.clientX,y:t.clientY}),t.preventDefault()})):t.on("contextmenu",(()=>{}))}function da(t,e,i){var a;if(!i.chart_type_props.has_control_limits)return"none";const r=e.outliers.improvement_direction,o=t.ll99.length-1,l=null===(a=null==t?void 0:t.alt_targets)||void 0===a?void 0:a[o];if(ca(l)||"neutral"===r)return"none";const n="increase"===r;return l>t.ul99[o]?n?"consistentFail":"consistentPass":l<t.ll99[o]?n?"consistentPass":"consistentFail":"inconsistent"}function ca(t){return null==t}function ha(t,e,i){let a=!0;return ca(e)||(a=a&&t>=e),ca(i)||(a=a&&t<=i),a}function ma(t){return function(e,i){return Array.isArray(e)&&Array.isArray(i)?e.map(((e,a)=>t(e,i[a]))):Array.isArray(e)&&!Array.isArray(i)?e.map((e=>t(e,i))):!Array.isArray(e)&&Array.isArray(i)?i.map((i=>t(e,i))):t(e,i)}}const fa=ma(((t,e)=>t>=0?Math.pow(t,e):-Math.pow(-t,e))),ya=ma(((t,e)=>t+e)),ga=ma(((t,e)=>t-e)),va=ma(((t,e)=>t/e)),_a=ma(((t,e)=>ca(t)||ca(e)?null:t*e));function wa(t){return function(e){return Array.isArray(e)?e.map((e=>t(e))):t(e)}}const ba=wa(Math.sqrt),Na=wa((t=>t?Math.abs(t):t)),xa=wa(Math.exp),Sa=wa((t=>Math.pow(t,2)));function ka(t,e){return function(i,a){return function(t,e,i,a){const r=a.percentLabels?"%":"",o=i.spc.sig_figs;if(ca(t))return"";switch(e){case"date":return t;case"integer":return t.toFixed(a.chart_type_props.integer_num_den?0:o);default:return t.toFixed(o)+r}}(i,a,t,e)}}function Aa(t,e,i,a){const r=i.outliers.astronomical_limit,o=i.outliers.two_in_three_limit,l=ka(i,a),n=new Array;if(i.spc.ttip_show_date){const e=i.spc.ttip_label_date;n.push({displayName:"Automatic"===e?a.chart_type_props.date_name:e,value:t.date})}if(i.spc.ttip_show_value){const e=i.spc.ttip_label_value;n.push({displayName:"Automatic"===e?a.chart_type_props.value_name:e,value:l(t.value,"value")})}if(i.spc.ttip_show_numerator&&!ca(t.numerator)&&n.push({displayName:i.spc.ttip_label_numerator,value:l(t.numerator,"integer")}),i.spc.ttip_show_denominator&&!ca(t.denominator)&&n.push({displayName:i.spc.ttip_label_denominator,value:l(t.denominator,"integer")}),i.lines.ttip_show_trend&&i.lines.show_trend&&n.push({displayName:i.lines.ttip_label_trend,value:l(t.trend_line,"value")}),i.lines.show_specification&&i.lines.ttip_show_specification&&(ca(t.speclimits_upper)||n.push({displayName:`Upper ${i.lines.ttip_label_specification}`,value:l(t.speclimits_upper,"value")}),ca(t.speclimits_lower)||n.push({displayName:`Lower ${i.lines.ttip_label_specification}`,value:l(t.speclimits_lower,"value")})),a.chart_type_props.has_control_limits&&["99","95","65"].forEach((e=>{i.lines[`ttip_show_${e}`]&&i.lines[`show_${e}`]&&n.push({displayName:`${i.lines[`ttip_label_${e}_prefix_upper`]}${i.lines[`ttip_label_${e}`]}`,value:l(t[`ul${e}`],"value")})})),i.lines.show_target&&i.lines.ttip_show_target&&n.push({displayName:i.lines.ttip_label_target,value:l(t.target,"value")}),i.lines.show_alt_target&&i.lines.ttip_show_alt_target&&!ca(t.alt_target)&&n.push({displayName:i.lines.ttip_label_alt_target,value:l(t.alt_target,"value")}),a.chart_type_props.has_control_limits&&["68","95","99"].forEach((e=>{i.lines[`ttip_show_${e}`]&&i.lines[`show_${e}`]&&n.push({displayName:`${i.lines[`ttip_label_${e}_prefix_lower`]}${i.lines[`ttip_label_${e}`]}`,value:l(t[`ll${e}`],"value")})})),[t.astpoint,t.trend,t.shift,t.two_in_three].some((t=>"none"!==t))){const e=new Array;if("none"!==t.astpoint){let t="Astronomical Point";"3 Sigma"!==r&&(t=`${t} (${r})`),e.push(t)}if("none"!==t.trend&&e.push("Trend"),"none"!==t.shift&&e.push("Shift"),"none"!==t.two_in_three){let t="Two-in-Three";"2 Sigma"!==o&&(t=`${t} (${o})`),e.push(t)}n.push({displayName:"Pattern(s)",value:e.join("\n")})}return!ca(e)&&e.length>0&&e.forEach((t=>n.push(t))),n}const Fa=ma(((t,e)=>{if("none"===t)return t;const i={increase:{upper:"improvement",lower:"deterioration"}[t],decrease:{lower:"improvement",upper:"deterioration"}[t],neutral:{lower:"neutral_low",upper:"neutral_high"}[t]}[e.improvement_direction];return"both"!==e.process_flag_type?i===e.process_flag_type?i:"none":i}));function Ma(t){if(t<=1||ca(t))return null;const e=t-1;return ba(2/e)*xa(pr(t/2)-pr(e/2))}const Ea=wa((t=>ba(1-Sa(Ma(t))))),Ta=wa((t=>{const e=t<=1?null:t;return 3/(Ma(e)*ba(e))})),$a=ma(((t,e)=>e*Ea(t)/Ma(t))),Da=ma(((t,e)=>1-$a(t,e))),La=ma(((t,e)=>1+$a(t,e)));function Ca(t){return t.map(((t,e,i)=>e>0?t-i[e-1]:null))}function Pa(t,e){return Array(e).fill(t)}function Ia(t,e,i,a){var r;const o=null===(r=null==t?void 0:t[e])||void 0===r?void 0:r[i];return ca(o)?a:(null==o?void 0:o.solid)?o.solid.color:o}function Ra(t,e,i,a){var r,o,l;if(ca(null==t?void 0:t.categories))return{values:null,validation:{status:0,messages:Pa(new Array,1)}};if(0===(null===(l=null===(o=null===(r=null==t?void 0:t.categories)||void 0===r?void 0:r[0])||void 0===o?void 0:o.identity)||void 0===l?void 0:l.length))return{values:null,validation:{status:0,messages:Pa(new Array,1)}};const n=t.categories[0],s=Object.keys(i[e]),u=JSON.parse(JSON.stringify({status:0,messages:Pa([],n.values.length)})),p=a.length;let d=new Array(p);for(let t=0;t<p;t++){const i=n.objects?n.objects[a[t]]:null;d[t]=Object.fromEntries(s.map((a=>{var r,o,l,n,s,p,d;const c=ua[e][a].default;let h=Ia(i,e,a,c);h=""===h?c:h;const m=null!==(o=null===(r=ua[e][a])||void 0===r?void 0:r.valid)&&void 0!==o?o:null===(l=ua[e][a])||void 0===l?void 0:l.options,f=!ca(null==m?void 0:m.minValue)||!ca(null==m?void 0:m.maxValue);if(m){let i="";m instanceof Array&&!m.includes(h)?i=`${h} is not a valid value for ${a}. Valid values are: ${m.join(", ")}`:f&&!ha(h,null===(n=null==m?void 0:m.minValue)||void 0===n?void 0:n.value,null===(s=null==m?void 0:m.maxValue)||void 0===s?void 0:s.value)&&(i=`${h} is not a valid value for ${a}. Valid values are between ${null===(p=null==m?void 0:m.minValue)||void 0===p?void 0:p.value} and ${null===(d=null==m?void 0:m.maxValue)||void 0===d?void 0:d.value}`),""!==i&&(h=ua[e][a].default,u.messages[t].push(i))}return[a,h]})))}const c=u.messages.filter((t=>t.length>0));return u.messages.some((t=>0===t.length))||(u.status=1,u.error=`${c[0][0]}`),{values:d,validation:u}}function Va(t){const e=Object.fromEntries(t.filter((t=>"literal"!==t.type)).map((t=>[t.type,t.value])));return["weekday","day","month","year"].forEach((t=>{var i;null!==(i=e[t])&&void 0!==i||(e[t]="")})),e}function Oa(t,e,i){var a,r,o;const l=i.length;let n=new Array(l);if(1===t.length&&!(null===(a=t[0].source.type)||void 0===a?void 0:a.temporal)){for(let e=0;e<l;e++)n[e]=ca(t[0].values[i[e]])?null:String(t[0].values[i[e]]);return n}const s=e.dates.date_format_delim;if(!t.every((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.type)||void 0===i?void 0:i.temporal}))){const e=Pa("",t.length).join(s);for(let a=0;a<l;a++){const r=t.map((t=>t.values[i[a]])).join(s);n[a]=r===e?null:r}return n}const u=function(t,e){var i,a,r,o,l;const n=e.length;let s=[];const u=[];if(t.length>1)for(let o=0;o<n;o++){const l=[];for(let i=0;i<t.length;i++)l.push(ar(t[i].source.type,t[i].values[e[o]]));const n=Object.fromEntries(l);(null==n?void 0:n.quarter)&&u.push(n.quarter),s[o]=new Date(null!==(i=null==n?void 0:n.year)&&void 0!==i?i:1970,null!==(a=null==n?void 0:n.month)&&void 0!==a?a:0,null!==(r=null==n?void 0:n.day)&&void 0!==r?r:1)}else for(let i=0;i<n;i++)s[i]=ca(null===(o=null==t?void 0:t[0])||void 0===o?void 0:o.values[e[i]])?null:new Date(null===(l=null==t?void 0:t[0])||void 0===l?void 0:l.values[e[i]]);return{dates:s,quarters:u}}(t,i),p=new Intl.DateTimeFormat(e.dates.date_format_locale,function(t){const e=new Array;return Object.keys(t).forEach((i=>{if("date_format_locale"!==i&&"date_format_delim"!==i){const a=i.replace("date_format_",""),r=er[a][t[i]];ca(r)||(e.push([a,r]),"day"===a&&"DD"!==t[i]&&e.push(["weekday",tr[t[i]]]))}})),Object.fromEntries(e)}(e.dates));let d="en-GB"===e.dates.date_format_locale?"day":"month",c="en-GB"===e.dates.date_format_locale?"month":"day";for(let t=0;t<l;t++)if(ca(u.dates[t]))n[t]=null;else{const e=Va(p.formatToParts(u.dates[t])),i=[e.weekday+" "+e[d],e[c],null!==(o=null===(r=u.quarters)||void 0===r?void 0:r[t])&&void 0!==o?o:"",e.year];n[t]=i.filter((t=>String(t).trim())).join(s)}return n}function ja(t,e,i,a){var r,o,l,n;if("key"===e)return function(t,e,i){const a=t.categories.filter((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.roles)||void 0===i?void 0:i.key})),r={};let o=a.map((t=>{var e,i;return null!==(i=null===(e=t.source)||void 0===e?void 0:e.queryName)&&void 0!==i?i:""}));const l=new Set;o=o.map(((t,e)=>(l.has(t)&&(t=`${e}_${t}`),l.add(t),t))),a.forEach(((t,e)=>{let i=o[e];if(i.includes("Date Hierarchy")){const t=i.lastIndexOf(".");-1!==t&&(i=i.substring(0,t))}r[i]||(r[i]=[]),r[i].push(t)}));const n=[];for(const t in r){const a=Oa(r[t],e,i);n.push(a)}const s=[],u=i.length;for(let t=0;t<u;t++){const e=n.map((e=>e[t])).filter((t=>null!=t));s.push(e.length>0?e.join(" "):null)}return s}(t,i,a);if("tooltips"===e)return function(t,e,i){const a=t.values.filter((t=>t.source.roles.tooltips)),r=i.length;let o=new Array(r);for(let t=0;t<r;t++)o[t]=a.map((a=>{var r;const o={valueType:a.source.type,dateSettings:e.dates},l=Qa(null===(r=null==a?void 0:a.values)||void 0===r?void 0:r[i[t]],o);return{displayName:a.source.displayName,value:l}}));return o}(t,i,a);const s=t.values.filter((t=>{var i,a;return null===(a=null===(i=null==t?void 0:t.source)||void 0===i?void 0:i.roles)||void 0===a?void 0:a[e]}));if(0===s.length)return null;const u=a.length;if("groupings"===e||"labels"===e){let t=new Array(u);for(let e=0;e<u;e++)t[e]=ca(null===(o=null===(r=null==s?void 0:s[0])||void 0===r?void 0:r.values)||void 0===o?void 0:o[a[e]])?null:String(s[0].values[a[e]]);return t}let p=new Array(u);for(let t=0;t<u;t++)p[t]=ca(null===(n=null===(l=null==s?void 0:s[0])||void 0===l?void 0:l.values)||void 0===n?void 0:n[a[t]])?null:Number(s[0].values[a[t]]);return p}function Ua(t,e,i,a,r){var o,l,n,s,u,p,d;const c=ja(t,"numerators",e,r),h=ja(t,"denominators",e,r),m=ja(t,"xbar_sds",e,r),f=ja(t,"key",e,r),y=ja(t,"tooltips",e,r),g=ja(t,"groupings",e,r),v=ja(t,"labels",e,r),_=r.map((e=>{var i,a,r;return null===(r=null===(a=null===(i=null==t?void 0:t.values)||void 0===i?void 0:i[0])||void 0===a?void 0:a.highlights)||void 0===r?void 0:r[e]}));let w=null===(o=Ra(t,"scatter",e,r))||void 0===o?void 0:o.values,b=null===(l=Ra(t,"lines",e,r))||void 0===l?void 0:l.values,N=null===(n=Ra(t,"labels",e,r))||void 0===n?void 0:n.values,x=null===(s=Ra(t,"lines",e,r))||void 0===s?void 0:s.values.map((t=>e.lines.show_alt_target?t.alt_target:null)),S=null===(u=Ra(t,"lines",e,r))||void 0===u?void 0:u.values.map((t=>t.show_specification?t.specification_lower:null)),k=null===(p=Ra(t,"lines",e,r))||void 0===p?void 0:p.values.map((t=>t.show_specification?t.specification_upper:null)),A=null===(d=Ra(t,"spc",e,r))||void 0===d?void 0:d.values;const F=function(t,e,i,a,r,o){let l=!1,n=new Array,s=new Array;const u=r.needs_denominator||r.denominator_optional&&!ca(i)&&i.length>0,p=o.length;for(let o=0;o<p;o++){const l=Ja(t[o],null==e?void 0:e[o],null==i?void 0:i[o],null==a?void 0:a[o],r,u);n.push(l.message),s.push(l.type)}let d=new Set(s);l=1===d.size;let c=Array.from(d)[0],h={status:l&&0!==c?1:0,messages:n};if(0===h.status){if(s.every((t=>0!==t)))return h.status=1,h.error="No valid data found!",h}if(l&&0!==c)switch(c){case 1:h.error="Grouping missing";break;case 2:h.error="All dates/IDs are missing or null!";break;case 3:h.error="All numerators are missing or null!";break;case 10:h.error="All numerators are not numbers!";break;case 4:h.error="All numerators are negative!";break;case 5:h.error="All denominators missing or null!";break;case 11:h.error="All denominators are not numbers!";break;case 6:h.error="All denominators are negative!";break;case 7:h.error="All denominators are smaller than numerators!";break;case 8:h.error="All SDs missing or null!";break;case 12:h.error="All SDs are not numbers!";break;case 9:h.error="All SDs are negative!"}return h}(f,c,h,m,i.chart_type_props,r);if(0!==F.status)return function(t){return{limitInputArgs:null,spcSettings:null,highlights:null,anyHighlights:!1,categories:null,groupings:null,groupingIndexes:null,scatter_formatting:null,line_formatting:null,label_formatting:null,tooltips:null,labels:null,anyLabels:!1,warningMessage:t.error,alt_targets:null,speclimits_lower:null,speclimits_upper:null,validationStatus:t}}(F);const M=new Array,E=new Array,T=new Array,$=t.categories[0].source.displayName,D=a;let L=0;const C=i.chart_type_props.x_axis_use_date;r.forEach(((t,e)=>{""===F.messages[e]?(M.push(e),E.push({x:L,id:t,label:C?f[e]:L.toString()}),L+=1,D[t].length>0&&D[t].forEach((t=>{T.push(`Conditional formatting for ${$} ${f[e]} ignored due to: ${t}.`)}))):T.push(`${$} ${f[e]} removed due to: ${F.messages[e]}.`)}));const P=Ga(g,M),I=new Array;let R=P[0];P.forEach(((t,e)=>{t!==R&&(I.push(e-1),R=t)}));const V=Ga(x,M);if(e.nhs_icons.show_assurance_icons){const t=null==V?void 0:V.length;if(t>0){ca(null==V?void 0:V[t-1])&&T.push("NHS Assurance icon requires a valid alt. target at last observation.")}i.chart_type_props.has_control_limits||T.push("NHS Assurance icon requires chart with control limits.")}const O=Ga(_,M),j=A[0].num_points_subset;let U;U=ca(j)||!ha(j,1,M.length)?or(0,M.length-1):"Start"===A[0].subset_points_from?or(0,A[0].num_points_subset-1):or(M.length-A[0].num_points_subset,M.length-1);const G=Ga(v,M);return{limitInputArgs:{keys:E,numerators:Ga(c,M),denominators:Ga(h,M),xbar_sds:Ga(m,M),outliers_in_limits:A[0].outliers_in_limits,subset_points:U},spcSettings:A[0],tooltips:Ga(y,M),labels:G,anyLabels:G.filter((t=>!ca(t)&&""!==t)).length>0,highlights:O,anyHighlights:O.filter((t=>!ca(t))).length>0,categories:t.categories[0],groupings:P,groupingIndexes:I,scatter_formatting:Ga(w,M),line_formatting:Ga(b,M),label_formatting:Ga(N,M),warningMessage:T.length>0?T.join("\n"):"",alt_targets:V,speclimits_lower:Ga(S,M),speclimits_upper:Ga(k,M),validationStatus:F}}function Ga(t,e){return t?t.filter(((t,i)=>-1!=e.indexOf(i))):[]}const za={ll99:"99",ll95:"95",ll68:"68",ul68:"68",ul95:"95",ul99:"99",targets:"target",values:"main",alt_targets:"alt_target",speclimits_lower:"specification",speclimits_upper:"specification",trend_line:"trend"};function Ba(t,e,i,a){const r=i+"_"+(e.includes("line")?za[t]:t);return a[e][r]}const qa=ma(((t,e)=>{let i=t;return(e.lower||0==e.lower)&&(i=i<e.lower?e.lower:i),e.upper&&(i=i>e.upper?e.upper:i),i}));function Ha(t,e){const i={High:"Low",Low:"High","":""},a={increase:"High",decrease:"Low",neutral:""}[e.outliers.improvement_direction];let r;if(e.nhs_icons.flag_last_point){const e=t.astpoint.length-1;r=[t.astpoint[e],t.shift[e],t.trend[e],t.two_in_three[e]]}else r=t.astpoint.concat(t.shift,t.trend,t.two_in_three);const o=new Array;return r.includes("improvement")&&o.push("improvement"+a),r.includes("deterioration")&&o.push("concern"+i[a]),r.includes("neutral_low")&&o.push("neutralLow"),r.includes("neutral_high")&&o.push("neutralHigh"),0===o.length&&o.push("commonCause"),o}function Za(t){const e=t.length;if(0===e)return NaN;const i=[...t].sort(((t,e)=>t-e)),a=Math.floor(e/2);return e%2==0?(i[a-1]+i[a])/2:i[a]}function Ya(t){return Math.max(...t)}function Xa(t){return Math.min(...t)}function Wa(t){const e=t.length;if(0===e)return NaN;let i=0;for(let a=0;a<e;a++)i+=t[a];return i/e}function Ka(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i];return e}function Ja(t,e,i,a,r,o){const l={message:"",type:0};return ca(t)&&(l.message="Date missing",l.type=2),ca(e)&&(l.message="Numerator missing",l.type=3),isNaN(e)&&(l.message="Numerator is not a number",l.type=10),r.numerator_non_negative&&e<0&&(l.message="Numerator negative",l.type=4),o&&(ca(i)?(l.message="Denominator missing",l.type=5):isNaN(i)?(l.message="Denominator is not a number",l.type=11):i<0?(l.message="Denominator negative",l.type=6):r.numerator_leq_denominator&&i<e&&(l.message="Denominator < numerator",l.type=7)),r.needs_sd&&(ca(a)?(l.message="SD missing",l.type=8):isNaN(a)?(l.message="SD is not a number",l.type=12):a<0&&(l.message="SD negative",l.type=9)),l}const Qa=ma(((t,e)=>ca(t)?null:e.valueType.numeric?t.toString():t)),tr={DD:null,"Thurs DD":"short","Thursday DD":"long","(blank)":null},er={weekday:tr,day:{DD:"2-digit","Thurs DD":"2-digit","Thursday DD":"2-digit","(blank)":null},month:{MM:"2-digit",Mon:"short",Month:"long","(blank)":null},year:{YYYY:"numeric",YY:"2-digit","(blank)":null}};const ir={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11};function ar(t,e){return t.temporal?"DayOfMonth"===(null==t?void 0:t.category)?["day",e]:"Months"===(null==t?void 0:t.category)?["month",ir[e]]:"Quarters"===(null==t?void 0:t.category)?["quarter",e]:"Years"===(null==t?void 0:t.category)?["year",e]:null:null}function rr(t,e){const i=e.getSelectionIds();var a=!1;for(const e of i)if(Array.isArray(t)){for(const i of t)if(e===i){a=!0;break}}else if(e===t){a=!0;break}return a}function or(t,e){return Array.from({length:e-t+1},((e,i)=>t+i))}function lr(t){const e=t.length;if(0===e)return[];let i=0,a=0,r=0,o=0;for(let l=0;l<e;l++){const e=l+1,n=t[l];a+=e,i+=n,r+=e*n,o+=e*e}const l=(e*r-a*i)/(e*o-a*a),n=(i-l*a)/e,s=[];for(let t=0;t<e;t++)s.push(l*(t+1)+n);return s}function nr(t){return!ca(t)&&!isNaN(t)&&isFinite(t)}const sr=1.1447298858494002,ur=1.8378770664093456;function pr(t){const e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(Number.isNaN(t))throw new Error("Input must be a valid number.");if(t<=0&&Number.isInteger(t))throw new Error("lgamma is undefined for non-positive integers.");if(t<.5)return sr-Math.log(Math.sin(Math.PI*t))-pr(1-t);let i=e[0];const a=(t-=1)+7+.5;for(let a=1;a<e.length;a++)i+=e[a]/(t+a);return.5*ur+(t+.5)*Math.log(a)-a+Math.log(i)}function dr(t,e){const i=e.plotProperties.yAxis.lower,a=e.plotProperties.yAxis.upper,r=e.plotProperties.xAxis.lower,o=e.plotProperties.xAxis.upper;t.select(".dotsgroup").selectAll("path").data(e.viewModel.plotPoints).join("path").filter((t=>!ca(t.value))).attr("d",(t=>{const e=t.aesthetics.shape,i=t.aesthetics.size;return Yt().type(Ki[`symbol${e}`]).size(i*i*Math.PI)()})).attr("transform",(t=>ha(t.value,i,a)&&ha(t.x,r,o)?`translate(${e.plotProperties.xScale(t.x)}, ${e.plotProperties.yScale(t.value)})`:"translate(0, 0) scale(0)")).style("fill",(t=>t.aesthetics.colour)).style("stroke",(t=>t.aesthetics.colour_outline)).style("stroke-width",(t=>t.aesthetics.width_outline)).on("click",((t,i)=>{if(e.host.hostCapabilities.allowInteractions){if(e.viewModel.inputSettings.settings.spc.split_on_click){const t=e.viewModel.splitIndexes.indexOf(i.x);t>-1?e.viewModel.splitIndexes.splice(t,1):e.viewModel.splitIndexes.push(i.x),e.host.persistProperties({replace:[{objectName:"split_indexes_storage",selector:void 0,properties:{split_indexes:JSON.stringify(e.viewModel.splitIndexes)}}]})}else e.selectionManager.select(i.identity,t.ctrlKey||t.metaKey).then((()=>{e.updateHighlighting()}));t.stopPropagation()}})).on("mouseover",((t,i)=>{const a=t.pageX,r=t.pageY;e.host.tooltipService.show({dataItems:i.tooltip,identities:[i.identity],coordinates:[a,r],isTouchEvent:!1})})).on("mouseout",(()=>{e.host.tooltipService.hide({immediately:!0,isTouchEvent:!1})})),t.on("click",(()=>{e.selectionManager.clear(),e.updateHighlighting()}))}var cr=Object.freeze({__proto__:null,commonCause:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#A6A6A6").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#A6A6A6").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M106.903 196.084 144.607 228.433 138.766 235.241 101.062 202.892Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M146.159 218.909 179.921 159.846 187.708 164.298 153.946 223.361Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M198.708 154.94 239.365 214.134 231.971 219.212 191.314 160.019Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M238.825 216.117 285.383 198.784 288.512 207.19 241.954 224.523Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M76.5001 195C76.5001 183.678 85.6782 174.5 97.0001 174.5 108.322 174.5 117.5 183.678 117.5 195 117.5 206.322 108.322 215.5 97.0001 215.5 85.6782 215.5 76.5001 206.322 76.5001 195Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M123.5 233C123.5 221.678 132.678 212.5 144 212.5 155.322 212.5 164.5 221.678 164.5 233 164.5 244.322 155.322 253.5 144 253.5 132.678 253.5 123.5 244.322 123.5 233Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M170.5 153.5C170.5 141.902 179.902 132.5 191.5 132.5 203.098 132.5 212.5 141.902 212.5 153.5 212.5 165.098 203.098 174.5 191.5 174.5 179.902 174.5 170.5 165.098 170.5 153.5Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M217.5 221.5C217.5 209.902 226.902 200.5 238.5 200.5 250.098 200.5 259.5 209.902 259.5 221.5 259.5 233.098 250.098 242.5 238.5 242.5 226.902 242.5 217.5 233.098 217.5 221.5Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd"),t.append("path").attr("d","M265.5 206.5C265.5 194.902 274.678 185.5 286 185.5 297.322 185.5 306.5 194.902 306.5 206.5 306.5 218.098 297.322 227.5 286 227.5 274.678 227.5 265.5 218.098 265.5 206.5Z").attr("stroke","#A6A6A6").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#A6A6A6").attr("fill-rule","evenodd")},concernHigh:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M0 155.53C-1.9801e-14 69.6331 69.6331-1.9801e-14 155.53-3.96021e-14 241.427-7.92042e-14 311.06 69.6331 311.06 155.53 311.06 241.427 241.427 311.06 155.53 311.06 69.6331 311.06-9.90052e-14 241.427 0 155.53Z").attr("stroke","#E46C0A").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 17.47 328.36)"),t.append("path").attr("d","M0 151C-1.92243e-14 67.605 67.605-1.92243e-14 151-3.84486e-14 234.395-7.68973e-14 302 67.605 302 151 302 234.395 234.395 302 151 302 67.605 302-9.61216e-14 234.395 0 151Z").attr("stroke","#E46C0A").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 38 340)"),t.append("text").attr("fill","#E46C0A").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(106.228 172) scale(10, 10)").text("H"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.919094 0.394039 0.394039 -0.919094 95.4025 215.096)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.880045 -0.47489 -0.47489 -0.880045 149.897 232.457)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.715824 -0.698281 -0.698281 -0.715824 199.882 206.276)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.937161 0.348898 0.348898 -0.937161 238.113 168.387)"),t.append("path").attr("d","M0 21C-2.60992e-15 9.40202 9.17816-2.67358e-15 20.5-5.34716e-15 31.8218-1.06943e-14 41 9.40202 41 21 41 32.598 31.8218 42 20.5 42 9.17816 42-1.30496e-14 32.598 0 21Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 76.5001 231.5)"),t.append("path").attr("d","M0 20.5C-2.60992e-15 9.17816 9.17816-2.60992e-15 20.5-5.21985e-15 31.8218-1.04397e-14 41 9.17816 41 20.5 41 31.8218 31.8218 41 20.5 41 9.17816 41-1.30496e-14 31.8218 0 20.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 123.5 249.5)"),t.append("path").attr("d","M0 21C-2.67358e-15 9.40202 9.40202-2.67358e-15 21-5.34716e-15 32.598-1.06943e-14 42 9.40202 42 21 42 32.598 32.598 42 21 42 9.40202 42-1.33679e-14 32.598 0 21Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 170.5 231.5)"),t.append("path").attr("d","M0 20.5C-2.67358e-15 9.17816 9.40202-2.60992e-15 21-5.21985e-15 32.598-1.04397e-14 42 9.17816 42 20.5 42 31.8218 32.598 41 21 41 9.40202 41-1.33679e-14 31.8218 0 20.5Z").attr("stroke","#E46C0A").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#E46C0A").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 217.5 185.5)"),t.append("path").attr("d","M0 20.5C-2.60992e-15 9.17816 9.17816-2.60992e-15 20.5-5.21985e-15 31.8218-1.04397e-14 41 9.17816 41 20.5 41 31.8218 31.8218 41 20.5 41 9.17816 41-1.30496e-14 31.8218 0 20.5Z").attr("stroke","#E46C0A").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#E46C0A").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 265.5 200.5)")},concernLow:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#E46C0A").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#E46C0A").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("text").attr("fill","#E46C0A").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(106.228 292) scale(10, 10)").text("L"),t.append("path").attr("d","M95.4025 162.857 141.063 143.281 144.597 151.525 98.9371 171.101Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M149.897 145.496 193.618 169.089 189.358 176.983 145.638 153.39Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M199.882 171.677 235.443 206.367 229.18 212.788 193.618 178.098Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M238.113 209.566 284.671 192.233 287.8 200.639 241.243 217.972Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M76.5001 168.5C76.5001 156.902 85.6782 147.5 97.0001 147.5 108.322 147.5 117.5 156.902 117.5 168.5 117.5 180.098 108.322 189.5 97.0001 189.5 85.6782 189.5 76.5001 180.098 76.5001 168.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M123.5 150C123.5 138.678 132.678 129.5 144 129.5 155.322 129.5 164.5 138.678 164.5 150 164.5 161.322 155.322 170.5 144 170.5 132.678 170.5 123.5 161.322 123.5 150Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M170.5 168.5C170.5 156.902 179.902 147.5 191.5 147.5 203.098 147.5 212.5 156.902 212.5 168.5 212.5 180.098 203.098 189.5 191.5 189.5 179.902 189.5 170.5 180.098 170.5 168.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M217.5 214C217.5 202.678 226.902 193.5 238.5 193.5 250.098 193.5 259.5 202.678 259.5 214 259.5 225.322 250.098 234.5 238.5 234.5 226.902 234.5 217.5 225.322 217.5 214Z").attr("stroke","#E46C0A").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#E46C0A").attr("fill-rule","evenodd"),t.append("path").attr("d","M265.5 199C265.5 187.678 274.678 178.5 286 178.5 297.322 178.5 306.5 187.678 306.5 199 306.5 210.322 297.322 219.5 286 219.5 274.678 219.5 265.5 210.322 265.5 199Z").attr("stroke","#E46C0A").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#E46C0A").attr("fill-rule","evenodd")},consistentFail:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#FF6600").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#FF6600").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("text").attr("fill","#FF6600").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(155.851 158) scale(10, 10)").text("F"),t.append("path").attr("d","M38.5001 185.5 340.862 185.5").attr("stroke","#FF6600").attr("stroke-width","8.66667").attr("stroke-miterlimit","8").attr("stroke-dasharray","26 8.66667").attr("fill","none").attr("fill-rule","evenodd"),t.append("path").attr("d","M72.5001 238.762C89.0456 218.168 107.725 200.801 129.638 200.507 152.134 201.459 176.57 238.689 192.563 241.313 206.31 244.118 205.897 217.733 212.814 216.659 217.563 215.414 220.151 238.182 233.066 240.463 248.557 243.786 291.62 234.385 302.5 236.212").attr("stroke","#7F7F7F").attr("stroke-width","10.66667").attr("stroke-miterlimit","8").attr("fill","none").attr("fill-rule","evenodd")},consistentPass:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#0072C6").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#0072C6").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("text").attr("fill","#0072C6").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(155.851 158) scale(10, 10)").text("P"),t.append("path").attr("d","M55.5001 257.5 323.847 257.5").attr("stroke","#0072C6").attr("stroke-width","8.66667").attr("stroke-miterlimit","8").attr("stroke-dasharray","26 8.66667").attr("fill","none").attr("fill-rule","evenodd"),t.append("path").attr("d","M72.5001 238.762C89.0456 218.168 107.725 200.801 129.638 200.507 152.134 201.459 176.57 238.689 192.563 241.313 206.31 244.118 205.897 217.733 212.814 216.659 217.563 215.414 220.151 238.182 233.066 240.463 248.557 243.786 291.62 234.385 302.5 236.212").attr("stroke","#7F7F7F").attr("stroke-width","10.66667").attr("stroke-miterlimit","8").attr("fill","none").attr("fill-rule","evenodd")},improvementHigh:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M0 155.53C-1.9801e-14 69.6331 69.6331-1.9801e-14 155.53-3.96021e-14 241.427-7.92042e-14 311.06 69.6331 311.06 155.53 311.06 241.427 241.427 311.06 155.53 311.06 69.6331 311.06-9.90052e-14 241.427 0 155.53Z").attr("stroke","#00B0F0").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 17.47 328.36)"),t.append("path").attr("d","M0 151C-1.92243e-14 67.605 67.605-1.92243e-14 151-3.84486e-14 234.395-7.68973e-14 302 67.605 302 151 302 234.395 234.395 302 151 302 67.605 302-9.61216e-14 234.395 0 151Z").attr("stroke","#00B0F0").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 38 340)"),t.append("text").attr("fill","#00B0F0").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(106.228 172) scale(10, 10)").text("H"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.919094 0.394039 0.394039 -0.919094 95.4025 215.096)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.880045 -0.47489 -0.47489 -0.880045 149.897 232.457)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.715824 -0.698281 -0.698281 -0.715824 199.882 206.276)"),t.append("rect").attr("x","0").attr("y","0").attr("width","49.6797").attr("height","8.97008").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("transform","matrix(0.937161 0.348898 0.348898 -0.937161 238.113 168.387)"),t.append("path").attr("d","M0 21C-2.60992e-15 9.40202 9.17816-2.67358e-15 20.5-5.34716e-15 31.8218-1.06943e-14 41 9.40202 41 21 41 32.598 31.8218 42 20.5 42 9.17816 42-1.30496e-14 32.598 0 21Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 76.5001 231.5)"),t.append("path").attr("d","M0 20.5C-2.60992e-15 9.17816 9.17816-2.60992e-15 20.5-5.21985e-15 31.8218-1.04397e-14 41 9.17816 41 20.5 41 31.8218 31.8218 41 20.5 41 9.17816 41-1.30496e-14 31.8218 0 20.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 123.5 249.5)"),t.append("path").attr("d","M0 21C-2.67358e-15 9.40202 9.40202-2.67358e-15 21-5.34716e-15 32.598-1.06943e-14 42 9.40202 42 21 42 32.598 32.598 42 21 42 9.40202 42-1.33679e-14 32.598 0 21Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 170.5 231.5)"),t.append("path").attr("d","M0 20.5C-2.67358e-15 9.17816 9.40202-2.60992e-15 21-5.21985e-15 32.598-1.04397e-14 42 9.17816 42 20.5 42 31.8218 32.598 41 21 41 9.40202 41-1.33679e-14 31.8218 0 20.5Z").attr("stroke","#00B0F0").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#00B0F0").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 217.5 185.5)"),t.append("path").attr("d","M0 20.5C-2.60992e-15 9.17816 9.17816-2.60992e-15 20.5-5.21985e-15 31.8218-1.04397e-14 41 9.17816 41 20.5 41 31.8218 31.8218 41 20.5 41 9.17816 41-1.30496e-14 31.8218 0 20.5Z").attr("stroke","#00B0F0").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#00B0F0").attr("fill-rule","evenodd").attr("transform","matrix(1 0 0 -1 265.5 200.5)")},improvementLow:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#00B0F0").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#00B0F0").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("text").attr("fill","#00B0F0").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(106.228 292) scale(10, 10)").text("L"),t.append("path").attr("d","M95.4025 162.857 141.063 143.281 144.597 151.525 98.9371 171.101Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M149.897 145.496 193.618 169.089 189.358 176.983 145.638 153.39Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M199.882 171.677 235.443 206.367 229.18 212.788 193.618 178.098Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M238.113 209.566 284.671 192.233 287.8 200.639 241.243 217.972Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M76.5001 168.5C76.5001 156.902 85.6782 147.5 97.0001 147.5 108.322 147.5 117.5 156.902 117.5 168.5 117.5 180.098 108.322 189.5 97.0001 189.5 85.6782 189.5 76.5001 180.098 76.5001 168.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M123.5 150C123.5 138.678 132.678 129.5 144 129.5 155.322 129.5 164.5 138.678 164.5 150 164.5 161.322 155.322 170.5 144 170.5 132.678 170.5 123.5 161.322 123.5 150Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M170.5 168.5C170.5 156.902 179.902 147.5 191.5 147.5 203.098 147.5 212.5 156.902 212.5 168.5 212.5 180.098 203.098 189.5 191.5 189.5 179.902 189.5 170.5 180.098 170.5 168.5Z").attr("stroke","#7F7F7F").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#7F7F7F").attr("fill-rule","evenodd"),t.append("path").attr("d","M217.5 214C217.5 202.678 226.902 193.5 238.5 193.5 250.098 193.5 259.5 202.678 259.5 214 259.5 225.322 250.098 234.5 238.5 234.5 226.902 234.5 217.5 225.322 217.5 214Z").attr("stroke","#00B0F0").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#00B0F0").attr("fill-rule","evenodd"),t.append("path").attr("d","M265.5 199C265.5 187.678 274.678 178.5 286 178.5 297.322 178.5 306.5 187.678 306.5 199 306.5 210.322 297.322 219.5 286 219.5 274.678 219.5 265.5 210.322 265.5 199Z").attr("stroke","#00B0F0").attr("stroke-width","2.66667").attr("stroke-miterlimit","8").attr("fill","#00B0F0").attr("fill-rule","evenodd")},inconsistent:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 173.345C17.47 87.1637 87.1031 17.3 173 17.3 258.897 17.3 328.53 87.1637 328.53 173.345 328.53 259.526 258.897 329.39 173 329.39 87.1031 329.39 17.47 259.526 17.47 173.345Z").attr("stroke","#BFBFBF").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189.5C38 105.829 105.605 38 189 38 272.395 38 340 105.829 340 189.5 340 273.171 272.395 341 189 341 105.605 341 38 273.171 38 189.5Z").attr("stroke","#BFBFBF").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("text").attr("fill","#7F7F7F").attr("font-family","Arial,Arial_MSFontService,sans-serif").attr("font-weight","700").attr("font-size","11.7").attr("transform","translate(155.851 158) scale(10, 10)").text("?"),t.append("path").attr("d","M38.5001 222.5 340.862 222.5").attr("stroke","#BFBFBF").attr("stroke-width","8.66667").attr("stroke-miterlimit","8").attr("stroke-dasharray","26 8.66667").attr("fill","none").attr("fill-rule","evenodd"),t.append("path").attr("d","M72.5001 239.762C89.0456 219.168 107.725 201.801 129.638 201.507 152.134 202.459 176.57 239.689 192.563 242.313 206.31 245.118 205.897 218.733 212.814 217.659 217.563 216.414 220.151 239.182 233.066 241.463 248.557 244.786 291.62 235.385 302.5 237.212").attr("stroke","#7F7F7F").attr("stroke-width","10.66667").attr("stroke-miterlimit","8").attr("fill","none").attr("fill-rule","evenodd")},neutralHigh:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#490092").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#490092").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M103.652 242.245 180.02 165.878 151.735 137.593 258.273 119.68 240.359 226.217 212.075 197.933 135.708 274.3Z").attr("fill","#490092").attr("fill-rule","evenodd")},neutralLow:function(t){t.append("g").attr("clip-path","url(#clip2)").append("g").attr("clip-path","url(#clip3)").attr("filter","url(#fx0)").attr("transform","translate(16 25)").append("g").attr("clip-path","url(#clip4)").append("path").attr("d","M17.47 172.83C17.47 86.9332 87.1031 17.3 173 17.3 258.897 17.3 328.53 86.9332 328.53 172.83 328.53 258.727 258.897 328.36 173 328.36 87.1031 328.36 17.47 258.727 17.47 172.83Z").attr("stroke","#490092").attr("stroke-width","21").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M38 189C38 105.605 105.605 38 189 38 272.395 38 340 105.605 340 189 340 272.395 272.395 340 189 340 105.605 340 38 272.395 38 189Z").attr("stroke","#490092").attr("stroke-width","20").attr("stroke-miterlimit","8").attr("fill","#FFFFFF").attr("fill-rule","evenodd"),t.append("path").attr("d","M135.708 103.652 212.075 180.02 240.359 151.735 258.273 258.273 151.735 240.359 180.02 212.075 103.652 135.708Z").attr("fill","#490092").attr("fill-rule","evenodd")}});function hr(t,e,i,a,r){const o=e/378*.08*a;return`scale(${o}) translate(${i.includes("Right")?t/o-(378+378*r):i.includes("Centre")?t/o/2-189:378*r}, ${i.includes("Bottom")?e/o-378:i.includes("Centre")?e/o/2-189:0})`}function mr(t,e,i){const a=t.append("g").classed("icongroup",!0);i&&a.attr("transform",i);const r=a.append("defs"),o=r.append("filter").attr("id","fx0").attr("x","-10%").attr("y","-10%").attr("width","120%").attr("height","120%").attr("filterUnits","userSpaceOnUse").attr("userSpaceOnUse","userSpaceOnUse"),l=o.append("feComponentTransfer").attr("color-interpolation-filters","sRGB");l.append("feFuncR").attr("type","discrete").attr("tableValues","0 0"),l.append("feFuncG").attr("type","discrete").attr("tableValues","0 0"),l.append("feFuncB").attr("type","discrete").attr("tableValues","0 0"),l.append("feFuncA").attr("type","linear").attr("slope","0.4").attr("intercept","0"),o.append("feGaussianBlur").attr("stdDeviation","1.77778 1.77778"),r.append("clipPath").attr("id","clip1").append("rect").attr("x","0").attr("y","0").attr("width","378").attr("height","378"),r.append("clipPath").attr("id","clip2").append("path").attr("d","M189 38C105.605 38 38 105.605 38 189 38 272.395 105.605 340 189 340 272.395 340 340 272.395 340 189 340 105.605 272.395 38 189 38ZM5.63264e-06 5.63264e-06 378 5.63264e-06 378 378 5.63264e-06 378Z").attr("fill-rule","evenodd").attr("clip-rule","evenodd"),r.append("clipPath").attr("id","clip3").append("rect").attr("x","-2").attr("y","-2").attr("width","346").attr("height","346"),a.append("g").classed(e,!0).attr("clip-path","url(#clip1)").append("rect").attr("x","0").attr("y","0").attr("width","378").attr("height","378").attr("fill","#FFFFFF")}function fr(t,e){if(t.selectAll(".icongroup").remove(),!e.plotProperties.displayPlot)return;const i=e.viewModel.inputSettings.settings.nhs_icons,a=i.show_variation_icons,r=i.variation_icons_locations,o=e.viewModel.svgWidth,l=e.viewModel.svgHeight;let n=0;if(a){const a=i.variation_icons_scaling,s=Ha(e.viewModel.outliers,e.viewModel.inputSettings.settings);s.forEach(((e,i)=>{t.call(mr,e,hr(o,l,r,a,i)).selectAll(`.${e}`).call(cr[e])})),n=s.length}if(i.show_assurance_icons){const a=i.assurance_icons_locations,s=i.assurance_icons_scaling,u=da(e.viewModel.controlLimits,e.viewModel.inputSettings.settings,e.viewModel.inputSettings.derivedSettings);if("none"===u)return;const p=n>0&&r===a?n:0;t.call(mr,u,hr(o,l,a,s,p)).selectAll(`.${u}`).call(cr[u])}}function yr(t,e){const i=e.plotProperties.yAxis.lower,a=e.plotProperties.yAxis.upper,r=e.plotProperties.xAxis.lower,o=e.plotProperties.xAxis.upper;t.select(".linesgroup").selectAll(".linegroup").data(e.viewModel.groupedLines).join("g").classed("linegroup",!0).each((function(t){const l=t[0],n=t[1].filter((t=>ha(t.x,r,o))),s=n.length;let u=new Array(s),p=!1,d=new Array(s),c=new Array(s);for(let t=0;t<s;t++){const r=n[t];d[t]=e.plotProperties.xScale(r.x),c[t]=e.plotProperties.yScale(r.line_value),u[t]=!ca(r.line_value)&&ha(r.line_value,i,a),p=p||u[t]}p?ut(this).selectAll("line").data(n.slice(1)).join("line").attr("x1",((t,e)=>u[e]?d[e]:d[e+1])).attr("y1",((t,e)=>u[e]?c[e]:c[e+1])).attr("x2",((t,e)=>u[e+1]?d[e+1]:d[e])).attr("y2",((t,e)=>u[e+1]?c[e+1]:c[e])).attr("fill","none").attr("stroke",(t=>e.viewModel.colourPalette.isHighContrast?e.viewModel.colourPalette.foregroundColour:Ba(l,"lines","colour",{lines:t.aesthetics}))).attr("stroke-width",(t=>Ba(l,"lines","width",{lines:t.aesthetics}))).attr("stroke-dasharray",(t=>Ba(l,"lines","type",{lines:t.aesthetics}))).attr("stroke-dashoffset",((t,i)=>{const a=e.plotProperties.xScale(n[0].x);return e.plotProperties.xScale(n[i].x)-a})):ut(this).selectAll("line").remove()}))}function gr(t,e){const i=e.plotProperties,a=e.viewModel.colourPalette.isHighContrast?e.viewModel.colourPalette.foregroundColour:"black",r=t.select(".ttip-line-x").attr("x1",0).attr("x2",0).attr("y1",i.yAxis.end_padding).attr("y2",e.viewModel.svgHeight-i.yAxis.start_padding).attr("stroke-width","1px").attr("stroke",a).style("stroke-opacity",0),o=t.select(".ttip-line-y").attr("x1",i.xAxis.start_padding).attr("x2",e.viewModel.svgWidth-i.xAxis.end_padding).attr("y1",0).attr("y2",0).attr("stroke-width","1px").attr("stroke",a).style("stroke-opacity",0);t.on("mousemove",(t=>{if(!i.displayPlot)return;const a=e.viewModel.plotPoints,l=e.svg.node().getBoundingClientRect(),n=t.pageX-l.left;let s,u,p,d=1/0;for(let t=0;t<a.length;t++){const e=i.xScale(a[t].x),r=Math.abs(e-n);r<d&&(d=r,s=t,u=e,p=i.yScale(a[t].value))}e.host.tooltipService.show({dataItems:a[s].tooltip,identities:[a[s].identity],coordinates:[u,p],isTouchEvent:!1}),r.style("stroke-opacity",.4).attr("x1",u).attr("x2",u),o.style("stroke-opacity",.4).attr("y1",p).attr("y2",p)})).on("mouseleave",(()=>{i.displayPlot&&(e.host.tooltipService.hide({immediately:!0,isTouchEvent:!1}),r.style("stroke-opacity",0),o.style("stroke-opacity",0))}))}function vr(t,e){const i=e.plotProperties.xAxis,a=ae(e.plotProperties.xScale);i.ticks?(i.tick_count&&a.ticks(i.tick_count),e.viewModel.tickLabels&&a.tickFormat((t=>{const i=e.viewModel.tickLabels.filter((e=>e.x==t));return i.length>0?i[0].label:""}))):a.tickValues([]);const r=e.viewModel.svgHeight,o=r-e.plotProperties.yAxis.start_padding,l=e.plotProperties.displayPlot;t.select(".xaxisgroup").call(a).attr("color",l?i.colour:"#FFFFFF").attr("transform",`translate(0, ${o})`).selectAll(".tick text").style("text-anchor",i.tick_rotation<0?"end":"start").attr("dx",i.tick_rotation<0?"-.8em":".8em").attr("dy",i.tick_rotation<0?"-.15em":".15em").attr("transform","rotate("+i.tick_rotation+")").style("font-size",i.tick_size).style("font-family",i.tick_font).style("fill",l?i.tick_colour:"#FFFFFF");const n=e.viewModel.svgWidth/2;let s;if(e.viewModel.frontend)s=r-e.plotProperties.yAxis.start_padding/3;else{const e=t.selectAll(".xaxisgroup").node();if(!e)return void t.select(".xaxislabel").style("fill",l?i.label_colour:"#FFFFFF");s=r-(r-e.getBoundingClientRect().bottom)/2}t.select(".xaxislabel").attr("x",n).attr("y",s).style("text-anchor","middle").text(i.label).style("font-size",i.label_size).style("font-family",i.label_font).style("fill",l?i.label_colour:"#FFFFFF")}function _r(t,e){const i=e.plotProperties.yAxis,a=re(e.plotProperties.yScale),r=e.viewModel.inputSettings.settings.y_axis.ylimit_sig_figs,o=ca(r)?e.viewModel.inputSettings.settings.spc.sig_figs:r,l=e.plotProperties.displayPlot;i.ticks?(i.tick_count&&a.ticks(i.tick_count),e.viewModel.inputData&&a.tickFormat((t=>e.viewModel.inputSettings.derivedSettings.percentLabels?t.toFixed(o)+"%":t.toFixed(o)))):a.tickValues([]);let n;t.select(".yaxisgroup").call(a).attr("color",l?i.colour:"#FFFFFF").attr("transform",`translate(${e.plotProperties.xAxis.start_padding}, 0)`).selectAll(".tick text").style("text-anchor","right").attr("transform",`rotate(${i.tick_rotation})`).style("font-size",i.tick_size).style("font-family",i.tick_font).style("fill",l?i.tick_colour:"#FFFFFF");const s=e.viewModel.svgHeight/2;if(e.viewModel.frontend)n=e.plotProperties.xAxis.start_padding/2;else{const e=t.selectAll(".yaxisgroup").node();if(!e)return void t.select(".yaxislabel").style("fill",l?i.label_colour:"#FFFFFF");n=.7*e.getBoundingClientRect().x}t.select(".yaxislabel").attr("x",n).attr("y",s).attr("transform",`rotate(-90, ${n}, ${s})`).text(i.label).style("text-anchor","middle").style("font-size",i.label_size).style("font-family",i.label_font).style("fill",l?i.label_colour:"#FFFFFF")}function wr(t,e=!1){e&&t.selectChildren().remove(),t.append("line").classed("ttip-line-x",!0),t.append("line").classed("ttip-line-y",!0),t.append("g").classed("xaxisgroup",!0),t.append("text").classed("xaxislabel",!0),t.append("g").classed("yaxisgroup",!0),t.append("text").classed("yaxislabel",!0),t.append("g").classed("linesgroup",!0),t.append("g").classed("dotsgroup",!0)}function br(t,e,i,a,r=null){t.call(wr,!0);const o=t.append("g").classed("errormessage",!0);if(r){const t={internal:"Internal Error! Please file a bug report with the following text:",settings:"Invalid settings provided for all observations! First error:"};o.append("text").attr("x",e.viewport.width/2).attr("y",e.viewport.height/3).style("text-anchor","middle").text(t[r]).style("font-size","10px").style("fill",i.foregroundColour)}o.append("text").attr("x",e.viewport.width/2).attr("y",e.viewport.height/2).style("text-anchor","middle").text(a).style("font-size","10px").style("fill",i.foregroundColour)}function Nr(t,e,i,a){const r=t.select(".table-header").selectAll("th").data(e).join("th");r.selectAll("text").data((t=>[t.label])).join("text").text((t=>t)).style("font-size",`${i.table_header_size}px`).style("font-family",i.table_header_font).style("color",i.table_header_colour),r.style("padding",`${i.table_header_text_padding}px`).style("background-color",i.table_header_bg_colour).style("font-weight",i.table_header_font_weight).style("text-transform",i.table_header_text_transform).style("text-align",i.table_header_text_align).style("border-width",`${i.table_header_border_width}px`).style("border-style",i.table_header_border_style).style("border-color",i.table_header_border_colour).style("border-top","inherit"),i.table_header_border_bottom||r.style("border-bottom","none"),i.table_header_border_inner||r.style("border-left","none").style("border-right","none"),"none"!==i.table_text_overflow?r.style("overflow","hidden").style("max-width",`${a}px`).style("text-overflow",i.table_text_overflow):r.style("overflow","auto").style("max-width","none")}function xr(t,e,i,a,r){const o=t.select(".table-body").selectAll("tr").data(i).join("tr").on("click",((t,i)=>{if(e.host.hostCapabilities.allowInteractions){const a=rr(i.identity,e.selectionManager);e.selectionManager.select(i.identity,a||t.ctrlKey||t.metaKey).then((()=>e.updateHighlighting())),t.stopPropagation()}})).on("mouseover",(t=>{ut(t.target).select((function(){return this.closest("td")})).style("background-color","lightgray")})).on("mouseout",(t=>{var e,i;let a=ut(t.target).select((function(){return this.closest("td")})),r=ut(a.node().parentNode).datum();a.style("background-color",null!==(i=null===(e=r.aesthetics)||void 0===e?void 0:e.table_body_bg_colour)&&void 0!==i?i:"inherit")}));"none"!==a.table_text_overflow?o.style("overflow","hidden").style("max-width",`${r}px`).style("text-overflow",a.table_text_overflow):o.style("overflow","auto").style("max-width","none")}function Sr(t,e){t.select(".table-group").style("border-width",`${e.table_outer_border_width}px`).style("border-style",e.table_outer_border_style).style("border-color",e.table_outer_border_colour),["top","right","bottom","left"].forEach((i=>{e[`table_outer_border_${i}`]||t.select(".table-group").style(`border-${i}`,"none")})),t.selectAll("th:first-child").style("border-left","inherit"),t.selectAll("th:last-child").style("border-right","inherit"),t.selectAll("td:first-child").style("border-left","inherit"),t.selectAll("td:last-child").style("border-right","inherit"),t.selectAll("tr:first-child").selectAll("td").style("border-top","inherit"),t.selectAll("tr:last-child").selectAll("td").style("border-bottom","inherit")}function kr(t,e,i,a){const r=t.select(".table-body").selectAll("tr").selectAll("td").data((t=>e.map((e=>({column:e.name,value:t.table_row[e.name]}))))).join("td"),o=i.nhs_icons.show_variation_icons||i.nhs_icons.show_assurance_icons,l=r.node().getBoundingClientRect();r.each((function(t){var e;const r=ut(this),n=ut(r.property("parentNode")).datum();if(a&&o&&("variation"===t.column||"assurance"===t.column)){if("none"!==t.value){const e=i.nhs_icons[`${t.column}_icons_scaling`];r.append("svg").attr("width",.5*l.width*e+"px").attr("viewBox","0 0 378 378").classed("rowsvg",!0).call(mr,t.value).selectAll(".icongroup").selectAll(`.${t.value}`).call(cr[t.value])}}else{const e="number"==typeof t.value?t.value.toFixed(i.spc.sig_figs):t.value;r.text(e).classed("cell-text",!0)}const s=(null===(e=n.aesthetics)||void 0===e?void 0:e.table_body_bg_colour)?n.aesthetics:i.summary_table;r.style("background-color",s.table_body_bg_colour).style("font-weight",s.table_body_font_weight).style("text-transform",s.table_body_text_transform).style("text-align",s.table_body_text_align).style("font-size",`${s.table_body_size}px`).style("font-family",s.table_body_font).style("color",s.table_body_colour).style("border-width",`${s.table_body_border_width}px`).style("border-style",s.table_body_border_style).style("border-color",s.table_body_border_colour).style("padding",`${s.table_body_text_padding}px`).style("opacity","inherit"),s.table_body_border_left_right||r.style("border-left","none").style("border-right","none"),s.table_body_border_top_bottom||r.style("border-top","none").style("border-bottom","none")}))}function Ar(t,e){let i,a;t.selectAll(".rowsvg").remove(),t.selectAll(".cell-text").remove(),e.viewModel.showGrouped?(i=e.viewModel.plotPointsGrouped,a=e.viewModel.tableColumnsGrouped):(i=e.viewModel.plotPoints,a=e.viewModel.tableColumns);const r=e.viewModel.svgWidth/a.length,o=e.viewModel.inputSettings.settings.summary_table;t.call(Nr,a,o,r).call(xr,e,i,o,r),i.length>0&&t.call(kr,a,e.viewModel.inputSettings.settings,e.viewModel.showGrouped),t.call(Sr,o),t.on("click",(()=>{e.selectionManager.clear(),e.updateHighlighting()}))}function Fr(t,e){if(!e.viewModel.inputSettings.settings.download_options.show_button)return void t.select(".download-btn-group").remove();t.select(".download-btn-group").empty()&&t.append("text").classed("download-btn-group",!0);const i=e.viewModel.plotPoints.map((t=>t.table_row)),a=new Array;a.push(Object.keys(i[0]).join(",")),i.forEach((t=>{a.push(Object.values(t).join(","))})),t.select(".download-btn-group").attr("x",e.viewModel.svgWidth-50).attr("y",e.viewModel.svgHeight-5).text("Download").style("font-size","10px").style("text-decoration","underline").on("click",(()=>{e.host.downloadService.exportVisualsContent(a.join("\n"),"chartdata.csv","csv","csv file")}))}function Mr(t,e){if(!e.viewModel.inputSettings.settings.labels.show_labels||!e.viewModel.inputData.anyLabels)return void t.select(".text-labels").remove();t.select(".text-labels").empty()&&t.append("g").classed("text-labels",!0);const i=Wi().on("drag",(function(t){const i=t.subject,a=e.plotProperties.xScale(i.x),r=e.plotProperties.yScale(i.value),o=180*Math.atan2(t.sourceEvent.y-r,t.sourceEvent.x-a)/Math.PI,l=Math.sqrt(Math.pow(t.sourceEvent.y-r,2)+Math.pow(t.sourceEvent.x-a,2)),n=10*Math.cos(o*Math.PI/180),s=10*Math.sin(o*Math.PI/180);t.subject.label.angle=o,t.subject.label.distance=l,ut(this).select("text").attr("x",t.sourceEvent.x).attr("y",t.sourceEvent.y);let u=i.label.aesthetics.label_line_offset;u="top"===i.label.aesthetics.label_position?u:-(u+i.label.aesthetics.label_size/2),ut(this).select("line").attr("x1",t.sourceEvent.x).attr("y1",t.sourceEvent.y+u).attr("x2",a+n).attr("y2",r+s),ut(this).select("path").attr("transform",`translate(${a+n}, ${r+s}) rotate(${o-90})`)}));t.select(".text-labels").selectAll(".text-group-inner").data(e.viewModel.plotPoints).join("g").classed("text-group-inner",!0).each((function(t){var a;const r=ut(this);if(""===(null!==(a=t.label.text_value)&&void 0!==a?a:""))return void r.remove();r.selectAll("*").remove();const o=r.append("text"),l=r.append("line"),n=r.append("path"),{x:s,y:u,line_offset:p,marker_offset:d,theta:c}=function(t,e){var i,a;const r="top"===t.label.aesthetics.label_position?-1:1,o=e.viewModel.svgHeight-e.plotProperties.yAxis.start_padding,l=t.label.aesthetics.label_position;let n=t.label.aesthetics.label_y_offset;const s="top"===l?0+n:o-n,u=e.plotProperties.yScale(t.value);let p="top"===l?u-s:s-u;const d=e.plotProperties.xScale(t.x),c=e.plotProperties.yScale(t.value),h=null!==(i=t.label.angle)&&void 0!==i?i:t.label.aesthetics.label_angle_offset+90*r;p=null!==(a=t.label.distance)&&void 0!==a?a:Math.min(p,t.label.aesthetics.label_line_max_length);let m=t.label.aesthetics.label_line_offset;m="top"===l?m:-(m+t.label.aesthetics.label_size/2);let f=t.label.aesthetics.label_marker_offset+t.label.aesthetics.label_size/2;f="top"===l?-f:f;const y=d+p*Math.cos(h*Math.PI/180),g=c+p*Math.sin(h*Math.PI/180);return nr(y)&&nr(g)?{x:y,y:g,theta:h,line_offset:m,marker_offset:f}:{x:0,y:0,theta:0,line_offset:0,marker_offset:0}}(t,e);if(0===s&&0===u)return void r.remove();const h=c-("top"===t.label.aesthetics.label_position?180:0),m=h*Math.PI/180;o.attr("x",s).attr("y",u).text(t.label.text_value).style("text-anchor","middle").style("font-size",`${t.label.aesthetics.label_size}px`).style("font-family",t.label.aesthetics.label_font).style("fill",t.label.aesthetics.label_colour);const f=Math.pow(t.label.aesthetics.label_marker_size,2),y=e.plotProperties.xScale(t.x)+d*Math.cos(m),g=e.plotProperties.yScale(t.value)+d*Math.sin(m);l.attr("x1",s).attr("y1",u+p).attr("x2",y).attr("y2",g).style("stroke",e.viewModel.inputSettings.settings.labels.label_line_colour).style("stroke-width",e.viewModel.inputSettings.settings.labels.label_line_width).style("stroke-dasharray",e.viewModel.inputSettings.settings.labels.label_line_type);const v=h+("top"===t.label.aesthetics.label_position?90:270);n.attr("d",Yt().type(Gt).size(f)()).attr("transform",`translate(${y}, ${g}) rotate(${v})`).style("fill",t.label.aesthetics.label_marker_colour).style("stroke",t.label.aesthetics.label_marker_outline_colour),e.viewModel.headless||r.call(i)}))}const Er={above:-1,below:1,beside:-1},Tr={ll99:"below",ll95:"below",ll68:"below",ul68:"above",ul95:"above",ul99:"above",speclimits_lower:"below",speclimits_upper:"above"},$r={ll99:"above",ll95:"above",ll68:"above",ul68:"below",ul95:"below",ul99:"below",speclimits_lower:"above",speclimits_upper:"below"};function Dr(t,e){const i=e.viewModel.inputSettings.settings.lines,a=new Array;e.viewModel.groupedLines[0][1].forEach(((t,i)=>{null===t.line_value&&a.push(i-1),i===e.viewModel.groupedLines[0][1].length-1&&a.push(i)}));const r=e.viewModel.groupedLines.map((t=>t[0])),o=new Array;a.forEach(((t,e)=>{r.forEach(((r,l)=>{const n=a[a.length-1],s=a.length-Math.min(a.length,i[`plot_label_show_n_${za[r]}`]),u=i[`plot_label_show_all_${za[r]}`]||t==n;(e>=s||u)&&o.push({index:t,limit:l})}))}));const l=ka(e.viewModel.inputSettings.settings,e.viewModel.inputSettings.derivedSettings);t.select(".linesgroup").selectAll("text").data(o).join("text").text((t=>{const a=e.viewModel.groupedLines[t.limit];return i[`plot_label_show_${za[a[0]]}`]?i[`plot_label_prefix_${za[a[0]]}`]+l(a[1][t.index].line_value,"value"):""})).attr("x",(t=>{const i=e.viewModel.groupedLines[t.limit];return e.plotProperties.xScale(i[1][t.index].x)})).attr("y",(t=>{const i=e.viewModel.groupedLines[t.limit];return e.plotProperties.yScale(i[1][t.index].line_value)})).attr("fill",(t=>{const a=e.viewModel.groupedLines[t.limit];return i[`plot_label_colour_${za[a[0]]}`]})).attr("font-size",(t=>{const a=e.viewModel.groupedLines[t.limit];return`${i[`plot_label_size_${za[a[0]]}`]}px`})).attr("font-family",(t=>{const a=e.viewModel.groupedLines[t.limit];return i[`plot_label_font_${za[a[0]]}`]})).attr("text-anchor",(t=>{const a=e.viewModel.groupedLines[t.limit];return"beside"===i[`plot_label_position_${za[a[0]]}`]?"start":"end"})).attr("dx",(t=>{const a=e.viewModel.groupedLines[t.limit];return`${("beside"===i[`plot_label_position_${za[a[0]]}`]?1:-1)*i[`plot_label_hpad_${za[a[0]]}`]}px`})).attr("dy",(function(t){const a=e.viewModel.groupedLines[t.limit],r=ut(this).node().getBoundingClientRect();let o=i[`plot_label_position_${za[a[0]]}`],l=i[`plot_label_vpad_${za[a[0]]}`];["outside","inside"].includes(o)&&(o="outside"===o?Tr[a[0]]:$r[a[0]]);const n={above:-i[`width_${za[a[0]]}`],below:i[`plot_label_size_${za[a[0]]}`],beside:r.height/4};return`${Er[o]*l+n[o]}px`}))}class Lr{initialiseScale(t,e){this.xScale=Ci().domain([this.xAxis.lower,this.xAxis.upper]).range([this.xAxis.start_padding,t-this.xAxis.end_padding]),this.yScale=Ci().domain([this.yAxis.lower,this.yAxis.upper]).range([e-this.yAxis.start_padding,this.yAxis.end_padding])}update(t,e){var i,a,r,o,l,n,s,u,p;const d=e.plotPoints,c=e.controlLimits,h=e.inputData,m=e.inputSettings.settings,f=e.inputSettings.derivedSettings,y=e.colourPalette;this.displayPlot=d?d.length>1:null;let g=m.x_axis.xlimit_l,v=m.x_axis.xlimit_u,_=m.y_axis.ylimit_l,w=m.y_axis.ylimit_u;if(0==(null===(i=null==h?void 0:h.validationStatus)||void 0===i?void 0:i.status)&&c){v=ca(v)?Ya(c.keys.map((t=>t.x))):v;const t=m.y_axis.limit_multiplier,e=c.values.filter((t=>nr(t))),i=null===(a=null==c?void 0:c.ul99)||void 0===a?void 0:a.filter((t=>nr(t))),d=null===(r=null==c?void 0:c.speclimits_upper)||void 0===r?void 0:r.filter((t=>nr(t))),h=null===(o=null==c?void 0:c.ll99)||void 0===o?void 0:o.filter((t=>nr(t))),y=null===(l=null==c?void 0:c.speclimits_lower)||void 0===l?void 0:l.filter((t=>nr(t))),b=null===(n=c.alt_targets)||void 0===n?void 0:n.filter((t=>nr(t))),N=null===(s=c.targets)||void 0===s?void 0:s.filter((t=>nr(t))),x=Ya(e),S=Ya(e.concat(i).concat(d).concat(b)),k=Xa(e.concat(h).concat(y).concat(b)),A=null!==(u=Ya(N))&&void 0!==u?u:0,F=null!==(p=Xa(N))&&void 0!==p?p:0,M=A+(S-A)*t,E=F-(F-k)*t,T=f.multiplier;null!=w||(w=!f.percentLabels||x>1*T?M:qa(M,{upper:1*T})),null!=_||(_=f.percentLabels?qa(E,{lower:0*T}):E);const $=c.keys.map((t=>t.x));g=ca(g)?Xa($):g,v=ca(v)?Ya($):v}const b=m.x_axis.xlimit_tick_size,N=m.y_axis.ylimit_tick_size,x=m.y_axis.ylimit_label?m.y_axis.ylimit_label_size:0,S=m.x_axis.xlimit_label?m.x_axis.xlimit_label_size:0;this.xAxis={lower:ca(g)?0:g,upper:v,start_padding:m.canvas.left_padding+x,end_padding:m.canvas.right_padding,colour:y.isHighContrast?y.foregroundColour:m.x_axis.xlimit_colour,ticks:m.x_axis.xlimit_ticks,tick_size:`${b}px`,tick_font:m.x_axis.xlimit_tick_font,tick_colour:y.isHighContrast?y.foregroundColour:m.x_axis.xlimit_tick_colour,tick_rotation:m.x_axis.xlimit_tick_rotation,tick_count:m.x_axis.xlimit_tick_count,label:m.x_axis.xlimit_label,label_size:`${m.x_axis.xlimit_label_size}px`,label_font:m.x_axis.xlimit_label_font,label_colour:y.isHighContrast?y.foregroundColour:m.x_axis.xlimit_label_colour},this.yAxis={lower:_,upper:w,start_padding:m.canvas.lower_padding+S,end_padding:m.canvas.upper_padding,colour:y.isHighContrast?y.foregroundColour:m.y_axis.ylimit_colour,ticks:m.y_axis.ylimit_ticks,tick_size:`${N}px`,tick_font:m.y_axis.ylimit_tick_font,tick_colour:y.isHighContrast?y.foregroundColour:m.y_axis.ylimit_tick_colour,tick_rotation:m.y_axis.ylimit_tick_rotation,tick_count:m.y_axis.ylimit_tick_count,label:m.y_axis.ylimit_label,label_size:`${m.y_axis.ylimit_label_size}px`,label_font:m.y_axis.ylimit_label_font,label_colour:y.isHighContrast?y.foregroundColour:m.y_axis.ylimit_label_colour},this.initialiseScale(t.viewport.width,t.viewport.height)}}var Cr,Pr,Ir,Rr,Vr,Or,jr,Ur,Gr,zr,Br,qr,Hr,Zr,Yr,Xr,Wr,Kr,Jr,Qr,to,eo,io,ao,ro,oo,lo,no,so,uo,po,co,ho,mo,fo,yo,go,vo,_o,wo,bo,No,xo,So,ko,Ao,Fo,Mo,Eo,To,$o,Do,Lo,Co,Po,Io,Ro,Vo,Oo,jo,Uo,Go,zo,Bo,qo,Ho,Zo,Yo,Xo,Wo,Ko,Jo,Qo,tl,el,il,al,rl,ol,ll,nl,sl,ul,pl,dl,cl,hl,ml,fl,yl={},gl={exports:{}};function vl(){if(Pr)return Cr;Pr=1;const t=Number.MAX_SAFE_INTEGER||9007199254740991;return Cr={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}function _l(){if(Rr)return Ir;Rr=1;const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};return Ir=t}function wl(){return Vr||(Vr=1,function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:a,MAX_LENGTH:r}=vl(),o=_l(),l=(e=t.exports={}).re=[],n=e.safeRe=[],s=e.src=[],u=e.t={};let p=0;const d="[a-zA-Z0-9-]",c=[["\\s",1],["\\d",r],[d,a]],h=(t,e,i)=>{const a=(t=>{for(const[e,i]of c)t=t.split(`${e}*`).join(`${e}{0,${i}}`).split(`${e}+`).join(`${e}{1,${i}}`);return t})(e),r=p++;o(t,r,e),u[t]=r,s[r]=e,l[r]=new RegExp(e,i?"g":void 0),n[r]=new RegExp(a,i?"g":void 0)};h("NUMERICIDENTIFIER","0|[1-9]\\d*"),h("NUMERICIDENTIFIERLOOSE","\\d+"),h("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),h("MAINVERSION",`(${s[u.NUMERICIDENTIFIER]})\\.(${s[u.NUMERICIDENTIFIER]})\\.(${s[u.NUMERICIDENTIFIER]})`),h("MAINVERSIONLOOSE",`(${s[u.NUMERICIDENTIFIERLOOSE]})\\.(${s[u.NUMERICIDENTIFIERLOOSE]})\\.(${s[u.NUMERICIDENTIFIERLOOSE]})`),h("PRERELEASEIDENTIFIER",`(?:${s[u.NUMERICIDENTIFIER]}|${s[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASEIDENTIFIERLOOSE",`(?:${s[u.NUMERICIDENTIFIERLOOSE]}|${s[u.NONNUMERICIDENTIFIER]})`),h("PRERELEASE",`(?:-(${s[u.PRERELEASEIDENTIFIER]}(?:\\.${s[u.PRERELEASEIDENTIFIER]})*))`),h("PRERELEASELOOSE",`(?:-?(${s[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[u.PRERELEASEIDENTIFIERLOOSE]})*))`),h("BUILDIDENTIFIER",`${d}+`),h("BUILD",`(?:\\+(${s[u.BUILDIDENTIFIER]}(?:\\.${s[u.BUILDIDENTIFIER]})*))`),h("FULLPLAIN",`v?${s[u.MAINVERSION]}${s[u.PRERELEASE]}?${s[u.BUILD]}?`),h("FULL",`^${s[u.FULLPLAIN]}$`),h("LOOSEPLAIN",`[v=\\s]*${s[u.MAINVERSIONLOOSE]}${s[u.PRERELEASELOOSE]}?${s[u.BUILD]}?`),h("LOOSE",`^${s[u.LOOSEPLAIN]}$`),h("GTLT","((?:<|>)?=?)"),h("XRANGEIDENTIFIERLOOSE",`${s[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),h("XRANGEIDENTIFIER",`${s[u.NUMERICIDENTIFIER]}|x|X|\\*`),h("XRANGEPLAIN",`[v=\\s]*(${s[u.XRANGEIDENTIFIER]})(?:\\.(${s[u.XRANGEIDENTIFIER]})(?:\\.(${s[u.XRANGEIDENTIFIER]})(?:${s[u.PRERELEASE]})?${s[u.BUILD]}?)?)?`),h("XRANGEPLAINLOOSE",`[v=\\s]*(${s[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[u.XRANGEIDENTIFIERLOOSE]})(?:${s[u.PRERELEASELOOSE]})?${s[u.BUILD]}?)?)?`),h("XRANGE",`^${s[u.GTLT]}\\s*${s[u.XRANGEPLAIN]}$`),h("XRANGELOOSE",`^${s[u.GTLT]}\\s*${s[u.XRANGEPLAINLOOSE]}$`),h("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),h("COERCE",`${s[u.COERCEPLAIN]}(?:$|[^\\d])`),h("COERCEFULL",s[u.COERCEPLAIN]+`(?:${s[u.PRERELEASE]})?`+`(?:${s[u.BUILD]})?(?:$|[^\\d])`),h("COERCERTL",s[u.COERCE],!0),h("COERCERTLFULL",s[u.COERCEFULL],!0),h("LONETILDE","(?:~>?)"),h("TILDETRIM",`(\\s*)${s[u.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",h("TILDE",`^${s[u.LONETILDE]}${s[u.XRANGEPLAIN]}$`),h("TILDELOOSE",`^${s[u.LONETILDE]}${s[u.XRANGEPLAINLOOSE]}$`),h("LONECARET","(?:\\^)"),h("CARETTRIM",`(\\s*)${s[u.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",h("CARET",`^${s[u.LONECARET]}${s[u.XRANGEPLAIN]}$`),h("CARETLOOSE",`^${s[u.LONECARET]}${s[u.XRANGEPLAINLOOSE]}$`),h("COMPARATORLOOSE",`^${s[u.GTLT]}\\s*(${s[u.LOOSEPLAIN]})$|^$`),h("COMPARATOR",`^${s[u.GTLT]}\\s*(${s[u.FULLPLAIN]})$|^$`),h("COMPARATORTRIM",`(\\s*)${s[u.GTLT]}\\s*(${s[u.LOOSEPLAIN]}|${s[u.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",h("HYPHENRANGE",`^\\s*(${s[u.XRANGEPLAIN]})\\s+-\\s+(${s[u.XRANGEPLAIN]})\\s*$`),h("HYPHENRANGELOOSE",`^\\s*(${s[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[u.XRANGEPLAINLOOSE]})\\s*$`),h("STAR","(<|>)?=?\\s*\\*"),h("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),h("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(gl,gl.exports)),gl.exports}function bl(){if(jr)return Or;jr=1;const t=Object.freeze({loose:!0}),e=Object.freeze({});return Or=i=>i?"object"!=typeof i?t:i:e}function Nl(){if(Gr)return Ur;Gr=1;const t=/^[0-9]+$/,e=(e,i)=>{const a=t.test(e),r=t.test(i);return a&&r&&(e=+e,i=+i),e===i?0:a&&!r?-1:r&&!a?1:e<i?-1:1};return Ur={compareIdentifiers:e,rcompareIdentifiers:(t,i)=>e(i,t)},Ur}function xl(){if(Br)return zr;Br=1;const t=_l(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:i}=vl(),{safeRe:a,t:r}=wl(),o=bl(),{compareIdentifiers:l}=Nl();class n{constructor(l,s){if(s=o(s),l instanceof n){if(l.loose===!!s.loose&&l.includePrerelease===!!s.includePrerelease)return l;l=l.version}else if("string"!=typeof l)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>e)throw new TypeError(`version is longer than ${e} characters`);t("SemVer",l,s),this.options=s,this.loose=!!s.loose,this.includePrerelease=!!s.includePrerelease;const u=l.trim().match(s.loose?a[r.LOOSE]:a[r.FULL]);if(!u)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+u[1],this.minor=+u[2],this.patch=+u[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");u[4]?this.prerelease=u[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<i)return e}return t})):this.prerelease=[],this.build=u[5]?u[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(t("SemVer.compare",this.version,this.options,e),!(e instanceof n)){if("string"==typeof e&&e===this.version)return 0;e=new n(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(t){return t instanceof n||(t=new n(t,this.options)),l(this.major,t.major)||l(this.minor,t.minor)||l(this.patch,t.patch)}comparePre(e){if(e instanceof n||(e=new n(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let i=0;do{const a=this.prerelease[i],r=e.prerelease[i];if(t("prerelease compare",i,a,r),void 0===a&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===a)return-1;if(a!==r)return l(a,r)}while(++i)}compareBuild(e){e instanceof n||(e=new n(e,this.options));let i=0;do{const a=this.build[i],r=e.build[i];if(t("build compare",i,a,r),void 0===a&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===a)return-1;if(a!==r)return l(a,r)}while(++i)}inc(t,e,i){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,i),this.inc("pre",e,i);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,i),this.inc("pre",e,i);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const t=Number(i)?1:0;if(!e&&!1===i)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[t];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(e===this.prerelease.join(".")&&!1===i)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(e){let a=[e,t];!1===i&&(a=[e]),0===l(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return zr=n}function Sl(){if(Hr)return qr;Hr=1;const t=xl();return qr=(e,i,a=!1)=>{if(e instanceof t)return e;try{return new t(e,i)}catch(t){if(!a)return null;throw t}},qr}function kl(){if(po)return uo;po=1;const t=xl();return uo=(e,i,a)=>new t(e,a).compare(new t(i,a)),uo}function Al(){if(go)return yo;go=1;const t=xl();return yo=(e,i,a)=>{const r=new t(e,a),o=new t(i,a);return r.compare(o)||r.compareBuild(o)},yo}function Fl(){if(xo)return No;xo=1;const t=kl();return No=(e,i,a)=>t(e,i,a)>0,No}function Ml(){if(ko)return So;ko=1;const t=kl();return So=(e,i,a)=>t(e,i,a)<0,So}function El(){if(Fo)return Ao;Fo=1;const t=kl();return Ao=(e,i,a)=>0===t(e,i,a),Ao}function Tl(){if(Eo)return Mo;Eo=1;const t=kl();return Mo=(e,i,a)=>0!==t(e,i,a),Mo}function $l(){if($o)return To;$o=1;const t=kl();return To=(e,i,a)=>t(e,i,a)>=0,To}function Dl(){if(Lo)return Do;Lo=1;const t=kl();return Do=(e,i,a)=>t(e,i,a)<=0,Do}function Ll(){if(Po)return Co;Po=1;const t=El(),e=Tl(),i=Fl(),a=$l(),r=Ml(),o=Dl();return Co=(l,n,s,u)=>{switch(n){case"===":return"object"==typeof l&&(l=l.version),"object"==typeof s&&(s=s.version),l===s;case"!==":return"object"==typeof l&&(l=l.version),"object"==typeof s&&(s=s.version),l!==s;case"":case"=":case"==":return t(l,s,u);case"!=":return e(l,s,u);case">":return i(l,s,u);case">=":return a(l,s,u);case"<":return r(l,s,u);case"<=":return o(l,s,u);default:throw new TypeError(`Invalid operator: ${n}`)}},Co}function Cl(){if(Uo)return jo;Uo=1;const t=/\s+/g;class e{constructor(i,o){if(o=a(o),i instanceof e)return i.loose===!!o.loose&&i.includePrerelease===!!o.includePrerelease?i:new e(i.raw,o);if(i instanceof r)return this.raw=i.value,this.set=[[i]],this.formatted=void 0,this;if(this.options=o,this.loose=!!o.loose,this.includePrerelease=!!o.includePrerelease,this.raw=i.trim().replace(t," "),this.set=this.raw.split("||").map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!m(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&f(t[0])){this.set=[t];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");const e=this.set[t];for(let t=0;t<e.length;t++)t>0&&(this.formatted+=" "),this.formatted+=e[t].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){const e=((this.options.includePrerelease&&c)|(this.options.loose&&h))+":"+t,a=i.get(e);if(a)return a;const l=this.options.loose,f=l?n[s.HYPHENRANGELOOSE]:n[s.HYPHENRANGE];t=t.replace(f,F(this.options.includePrerelease)),o("hyphen replace",t),t=t.replace(n[s.COMPARATORTRIM],u),o("comparator trim",t),t=t.replace(n[s.TILDETRIM],p),o("tilde trim",t),t=t.replace(n[s.CARETTRIM],d),o("caret trim",t);let y=t.split(" ").map((t=>g(t,this.options))).join(" ").split(/\s+/).map((t=>A(t,this.options)));l&&(y=y.filter((t=>(o("loose invalid filter",t,this.options),!!t.match(n[s.COMPARATORLOOSE]))))),o("range list",y);const v=new Map,_=y.map((t=>new r(t,this.options)));for(const t of _){if(m(t))return[t];v.set(t.value,t)}v.size>1&&v.has("")&&v.delete("");const w=[...v.values()];return i.set(e,w),w}intersects(t,i){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>y(e,i)&&t.set.some((t=>y(t,i)&&e.every((e=>t.every((t=>e.intersects(t,i)))))))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new l(t,this.options)}catch(t){return!1}for(let e=0;e<this.set.length;e++)if(M(this.set[e],t,this.options))return!0;return!1}}jo=e;const i=new(Oo?Vo:(Oo=1,Vo=class{constructor(){this.max=1e3,this.map=new Map}get(t){const e=this.map.get(t);return void 0===e?void 0:(this.map.delete(t),this.map.set(t,e),e)}delete(t){return this.map.delete(t)}set(t,e){if(!this.delete(t)&&void 0!==e){if(this.map.size>=this.max){const t=this.map.keys().next().value;this.delete(t)}this.map.set(t,e)}return this}})),a=bl(),r=Pl(),o=_l(),l=xl(),{safeRe:n,t:s,comparatorTrimReplace:u,tildeTrimReplace:p,caretTrimReplace:d}=wl(),{FLAG_INCLUDE_PRERELEASE:c,FLAG_LOOSE:h}=vl(),m=t=>"<0.0.0-0"===t.value,f=t=>""===t.value,y=(t,e)=>{let i=!0;const a=t.slice();let r=a.pop();for(;i&&a.length;)i=a.every((t=>r.intersects(t,e))),r=a.pop();return i},g=(t,e)=>(o("comp",t,e),t=b(t,e),o("caret",t),t=_(t,e),o("tildes",t),t=x(t,e),o("xrange",t),t=k(t,e),o("stars",t),t),v=t=>!t||"x"===t.toLowerCase()||"*"===t,_=(t,e)=>t.trim().split(/\s+/).map((t=>w(t,e))).join(" "),w=(t,e)=>{const i=e.loose?n[s.TILDELOOSE]:n[s.TILDE];return t.replace(i,((e,i,a,r,l)=>{let n;return o("tilde",t,e,i,a,r,l),v(i)?n="":v(a)?n=`>=${i}.0.0 <${+i+1}.0.0-0`:v(r)?n=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:l?(o("replaceTilde pr",l),n=`>=${i}.${a}.${r}-${l} <${i}.${+a+1}.0-0`):n=`>=${i}.${a}.${r} <${i}.${+a+1}.0-0`,o("tilde return",n),n}))},b=(t,e)=>t.trim().split(/\s+/).map((t=>N(t,e))).join(" "),N=(t,e)=>{o("caret",t,e);const i=e.loose?n[s.CARETLOOSE]:n[s.CARET],a=e.includePrerelease?"-0":"";return t.replace(i,((e,i,r,l,n)=>{let s;return o("caret",t,e,i,r,l,n),v(i)?s="":v(r)?s=`>=${i}.0.0${a} <${+i+1}.0.0-0`:v(l)?s="0"===i?`>=${i}.${r}.0${a} <${i}.${+r+1}.0-0`:`>=${i}.${r}.0${a} <${+i+1}.0.0-0`:n?(o("replaceCaret pr",n),s="0"===i?"0"===r?`>=${i}.${r}.${l}-${n} <${i}.${r}.${+l+1}-0`:`>=${i}.${r}.${l}-${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${l}-${n} <${+i+1}.0.0-0`):(o("no pr"),s="0"===i?"0"===r?`>=${i}.${r}.${l}${a} <${i}.${r}.${+l+1}-0`:`>=${i}.${r}.${l}${a} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${l} <${+i+1}.0.0-0`),o("caret return",s),s}))},x=(t,e)=>(o("replaceXRanges",t,e),t.split(/\s+/).map((t=>S(t,e))).join(" ")),S=(t,e)=>{t=t.trim();const i=e.loose?n[s.XRANGELOOSE]:n[s.XRANGE];return t.replace(i,((i,a,r,l,n,s)=>{o("xRange",t,i,a,r,l,n,s);const u=v(r),p=u||v(l),d=p||v(n),c=d;return"="===a&&c&&(a=""),s=e.includePrerelease?"-0":"",u?i=">"===a||"<"===a?"<0.0.0-0":"*":a&&c?(p&&(l=0),n=0,">"===a?(a=">=",p?(r=+r+1,l=0,n=0):(l=+l+1,n=0)):"<="===a&&(a="<",p?r=+r+1:l=+l+1),"<"===a&&(s="-0"),i=`${a+r}.${l}.${n}${s}`):p?i=`>=${r}.0.0${s} <${+r+1}.0.0-0`:d&&(i=`>=${r}.${l}.0${s} <${r}.${+l+1}.0-0`),o("xRange return",i),i}))},k=(t,e)=>(o("replaceStars",t,e),t.trim().replace(n[s.STAR],"")),A=(t,e)=>(o("replaceGTE0",t,e),t.trim().replace(n[e.includePrerelease?s.GTE0PRE:s.GTE0],"")),F=t=>(e,i,a,r,o,l,n,s,u,p,d,c)=>`${i=v(a)?"":v(r)?`>=${a}.0.0${t?"-0":""}`:v(o)?`>=${a}.${r}.0${t?"-0":""}`:l?`>=${i}`:`>=${i}${t?"-0":""}`} ${s=v(u)?"":v(p)?`<${+u+1}.0.0-0`:v(d)?`<${u}.${+p+1}.0-0`:c?`<=${u}.${p}.${d}-${c}`:t?`<${u}.${p}.${+d+1}-0`:`<=${s}`}`.trim(),M=(t,e,i)=>{for(let i=0;i<t.length;i++)if(!t[i].test(e))return!1;if(e.prerelease.length&&!i.includePrerelease){for(let i=0;i<t.length;i++)if(o(t[i].semver),t[i].semver!==r.ANY&&t[i].semver.prerelease.length>0){const a=t[i].semver;if(a.major===e.major&&a.minor===e.minor&&a.patch===e.patch)return!0}return!1}return!0};return jo}function Pl(){if(zo)return Go;zo=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(a,r){if(r=i(r),a instanceof e){if(a.loose===!!r.loose)return a;a=a.value}a=a.trim().split(/\s+/).join(" "),l("comparator",a,r),this.options=r,this.loose=!!r.loose,this.parse(a),this.semver===t?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const i=this.options.loose?a[r.COMPARATORLOOSE]:a[r.COMPARATOR],o=e.match(i);if(!o)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==o[1]?o[1]:"","="===this.operator&&(this.operator=""),o[2]?this.semver=new n(o[2],this.options.loose):this.semver=t}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===t||e===t)return!0;if("string"==typeof e)try{e=new n(e,this.options)}catch(t){return!1}return o(e,this.operator,this.semver,this.options)}intersects(t,a){if(!(t instanceof e))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new s(t.value,a).test(this.value):""===t.operator?""===t.value||new s(this.value,a).test(t.semver):(!(a=i(a)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==t.value)&&(!(!a.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!t.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!t.operator.startsWith("<"))||(!(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))||(!!(o(this.semver,"<",t.semver,a)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))||!!(o(this.semver,">",t.semver,a)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))))))}}Go=e;const i=bl(),{safeRe:a,t:r}=wl(),o=Ll(),l=_l(),n=xl(),s=Cl();return Go}function Il(){if(qo)return Bo;qo=1;const t=Cl();return Bo=(e,i,a)=>{try{i=new t(i,a)}catch(t){return!1}return i.test(e)},Bo}function Rl(){if(el)return tl;el=1;const t=Cl();return tl=(e,i)=>{try{return new t(e,i).range||"*"}catch(t){return null}},tl}function Vl(){if(al)return il;al=1;const t=xl(),e=Pl(),{ANY:i}=e,a=Cl(),r=Il(),o=Fl(),l=Ml(),n=Dl(),s=$l();return il=(u,p,d,c)=>{let h,m,f,y,g;switch(u=new t(u,c),p=new a(p,c),d){case">":h=o,m=n,f=l,y=">",g=">=";break;case"<":h=l,m=s,f=o,y="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(r(u,p,c))return!1;for(let t=0;t<p.set.length;++t){const a=p.set[t];let r=null,o=null;if(a.forEach((t=>{t.semver===i&&(t=new e(">=0.0.0")),r=r||t,o=o||t,h(t.semver,r.semver,c)?r=t:f(t.semver,o.semver,c)&&(o=t)})),r.operator===y||r.operator===g)return!1;if((!o.operator||o.operator===y)&&m(u,o.semver))return!1;if(o.operator===g&&f(u,o.semver))return!1}return!0},il}function Ol(){if(fl)return ml;fl=1;const t=wl(),e=vl(),i=xl(),a=Nl(),r=Sl(),o=function(){if(Yr)return Zr;Yr=1;const t=Sl();return Zr=(e,i)=>{const a=t(e,i);return a?a.version:null},Zr}(),l=function(){if(Wr)return Xr;Wr=1;const t=Sl();return Xr=(e,i)=>{const a=t(e.trim().replace(/^[=v]+/,""),i);return a?a.version:null},Xr}(),n=function(){if(Jr)return Kr;Jr=1;const t=xl();return Kr=(e,i,a,r,o)=>{"string"==typeof a&&(o=r,r=a,a=void 0);try{return new t(e instanceof t?e.version:e,a).inc(i,r,o).version}catch(t){return null}},Kr}(),s=function(){if(to)return Qr;to=1;const t=Sl();return Qr=(e,i)=>{const a=t(e,null,!0),r=t(i,null,!0),o=a.compare(r);if(0===o)return null;const l=o>0,n=l?a:r,s=l?r:a,u=!!n.prerelease.length;if(s.prerelease.length&&!u)return s.patch||s.minor?n.patch?"patch":n.minor?"minor":"major":"major";const p=u?"pre":"";return a.major!==r.major?p+"major":a.minor!==r.minor?p+"minor":a.patch!==r.patch?p+"patch":"prerelease"}}(),u=function(){if(io)return eo;io=1;const t=xl();return eo=(e,i)=>new t(e,i).major,eo}(),p=function(){if(ro)return ao;ro=1;const t=xl();return ao=(e,i)=>new t(e,i).minor,ao}(),d=function(){if(lo)return oo;lo=1;const t=xl();return oo=(e,i)=>new t(e,i).patch,oo}(),c=function(){if(so)return no;so=1;const t=Sl();return no=(e,i)=>{const a=t(e,i);return a&&a.prerelease.length?a.prerelease:null},no}(),h=kl(),m=function(){if(ho)return co;ho=1;const t=kl();return co=(e,i,a)=>t(i,e,a),co}(),f=function(){if(fo)return mo;fo=1;const t=kl();return mo=(e,i)=>t(e,i,!0),mo}(),y=Al(),g=function(){if(_o)return vo;_o=1;const t=Al();return vo=(e,i)=>e.sort(((e,a)=>t(e,a,i))),vo}(),v=function(){if(bo)return wo;bo=1;const t=Al();return wo=(e,i)=>e.sort(((e,a)=>t(a,e,i))),wo}(),_=Fl(),w=Ml(),b=El(),N=Tl(),x=$l(),S=Dl(),k=Ll(),A=function(){if(Ro)return Io;Ro=1;const t=xl(),e=Sl(),{safeRe:i,t:a}=wl();return Io=(r,o)=>{if(r instanceof t)return r;if("number"==typeof r&&(r=String(r)),"string"!=typeof r)return null;let l=null;if((o=o||{}).rtl){const t=o.includePrerelease?i[a.COERCERTLFULL]:i[a.COERCERTL];let e;for(;(e=t.exec(r))&&(!l||l.index+l[0].length!==r.length);)l&&e.index+e[0].length===l.index+l[0].length||(l=e),t.lastIndex=e.index+e[1].length+e[2].length;t.lastIndex=-1}else l=r.match(o.includePrerelease?i[a.COERCEFULL]:i[a.COERCE]);if(null===l)return null;const n=l[2],s=l[3]||"0",u=l[4]||"0",p=o.includePrerelease&&l[5]?`-${l[5]}`:"",d=o.includePrerelease&&l[6]?`+${l[6]}`:"";return e(`${n}.${s}.${u}${p}${d}`,o)},Io}(),F=Pl(),M=Cl(),E=Il(),T=function(){if(Zo)return Ho;Zo=1;const t=Cl();return Ho=(e,i)=>new t(e,i).set.map((t=>t.map((t=>t.value)).join(" ").trim().split(" "))),Ho}(),$=function(){if(Xo)return Yo;Xo=1;const t=xl(),e=Cl();return Yo=(i,a,r)=>{let o=null,l=null,n=null;try{n=new e(a,r)}catch(t){return null}return i.forEach((e=>{n.test(e)&&(o&&-1!==l.compare(e)||(o=e,l=new t(o,r)))})),o},Yo}(),D=function(){if(Ko)return Wo;Ko=1;const t=xl(),e=Cl();return Wo=(i,a,r)=>{let o=null,l=null,n=null;try{n=new e(a,r)}catch(t){return null}return i.forEach((e=>{n.test(e)&&(o&&1!==l.compare(e)||(o=e,l=new t(o,r)))})),o},Wo}(),L=function(){if(Qo)return Jo;Qo=1;const t=xl(),e=Cl(),i=Fl();return Jo=(a,r)=>{a=new e(a,r);let o=new t("0.0.0");if(a.test(o))return o;if(o=new t("0.0.0-0"),a.test(o))return o;o=null;for(let e=0;e<a.set.length;++e){const r=a.set[e];let l=null;r.forEach((e=>{const a=new t(e.semver.version);switch(e.operator){case">":0===a.prerelease.length?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":l&&!i(a,l)||(l=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!l||o&&!i(o,l)||(o=l)}return o&&a.test(o)?o:null},Jo}(),C=Rl(),P=Vl(),I=function(){if(ol)return rl;ol=1;const t=Vl();return rl=(e,i,a)=>t(e,i,">",a),rl}(),R=function(){if(nl)return ll;nl=1;const t=Vl();return ll=(e,i,a)=>t(e,i,"<",a),ll}(),V=function(){if(ul)return sl;ul=1;const t=Cl();return sl=(e,i,a)=>(e=new t(e,a),i=new t(i,a),e.intersects(i,a))}(),O=function(){if(dl)return pl;dl=1;const t=Il(),e=kl();return pl=(i,a,r)=>{const o=[];let l=null,n=null;const s=i.sort(((t,i)=>e(t,i,r)));for(const e of s)t(e,a,r)?(n=e,l||(l=e)):(n&&o.push([l,n]),n=null,l=null);l&&o.push([l,null]);const u=[];for(const[t,e]of o)t===e?u.push(t):e||t!==s[0]?e?t===s[0]?u.push(`<=${e}`):u.push(`${t} - ${e}`):u.push(`>=${t}`):u.push("*");const p=u.join(" || "),d="string"==typeof a.raw?a.raw:String(a);return p.length<d.length?p:a},pl}(),j=function(){if(hl)return cl;hl=1;const t=Cl(),e=Pl(),{ANY:i}=e,a=Il(),r=kl(),o=[new e(">=0.0.0-0")],l=[new e(">=0.0.0")],n=(t,e,n)=>{if(t===e)return!0;if(1===t.length&&t[0].semver===i){if(1===e.length&&e[0].semver===i)return!0;t=n.includePrerelease?o:l}if(1===e.length&&e[0].semver===i){if(n.includePrerelease)return!0;e=l}const p=new Set;let d,c,h,m,f,y,g;for(const e of t)">"===e.operator||">="===e.operator?d=s(d,e,n):"<"===e.operator||"<="===e.operator?c=u(c,e,n):p.add(e.semver);if(p.size>1)return null;if(d&&c){if(h=r(d.semver,c.semver,n),h>0)return null;if(0===h&&(">="!==d.operator||"<="!==c.operator))return null}for(const t of p){if(d&&!a(t,String(d),n))return null;if(c&&!a(t,String(c),n))return null;for(const i of e)if(!a(t,String(i),n))return!1;return!0}let v=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,_=!(!d||n.includePrerelease||!d.semver.prerelease.length)&&d.semver;v&&1===v.prerelease.length&&"<"===c.operator&&0===v.prerelease[0]&&(v=!1);for(const t of e){if(g=g||">"===t.operator||">="===t.operator,y=y||"<"===t.operator||"<="===t.operator,d)if(_&&t.semver.prerelease&&t.semver.prerelease.length&&t.semver.major===_.major&&t.semver.minor===_.minor&&t.semver.patch===_.patch&&(_=!1),">"===t.operator||">="===t.operator){if(m=s(d,t,n),m===t&&m!==d)return!1}else if(">="===d.operator&&!a(d.semver,String(t),n))return!1;if(c)if(v&&t.semver.prerelease&&t.semver.prerelease.length&&t.semver.major===v.major&&t.semver.minor===v.minor&&t.semver.patch===v.patch&&(v=!1),"<"===t.operator||"<="===t.operator){if(f=u(c,t,n),f===t&&f!==c)return!1}else if("<="===c.operator&&!a(c.semver,String(t),n))return!1;if(!t.operator&&(c||d)&&0!==h)return!1}return!(d&&y&&!c&&0!==h||c&&g&&!d&&0!==h||_||v)},s=(t,e,i)=>{if(!t)return e;const a=r(t.semver,e.semver,i);return a>0?t:a<0||">"===e.operator&&">="===t.operator?e:t},u=(t,e,i)=>{if(!t)return e;const a=r(t.semver,e.semver,i);return a<0?t:a>0||"<"===e.operator&&"<="===t.operator?e:t};return cl=(e,i,a={})=>{if(e===i)return!0;e=new t(e,a),i=new t(i,a);let r=!1;t:for(const t of e.set){for(const e of i.set){const i=n(t,e,a);if(r=r||null!==i,i)continue t}if(r)return!1}return!0}}();return ml={parse:r,valid:o,clean:l,inc:n,diff:s,major:u,minor:p,patch:d,prerelease:c,compare:h,rcompare:m,compareLoose:f,compareBuild:y,sort:g,rsort:v,gt:_,lt:w,eq:b,neq:N,gte:x,lte:S,cmp:k,coerce:A,Comparator:F,Range:M,satisfies:E,toComparators:T,maxSatisfying:$,minSatisfying:D,minVersion:L,validRange:C,outside:P,gtr:I,ltr:R,intersects:V,simplifyRange:O,subset:j,SemVer:i,re:t.re,src:t.src,tokens:t.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}}var jl,Ul="5.1.0",Gl={type:"object",properties:{privileges:{type:"array",description:"Defines required privileges for the visual",items:{$ref:"#/definitions/privilege"}},dataRoles:{type:"array",description:"Defines data roles for the visual",items:{$ref:"#/definitions/dataRole"}},dataViewMappings:{type:"array",description:"Defines data mappings for the visual",items:{$ref:"#/definitions/dataViewMapping"}},objects:{$ref:"#/definitions/objects"},tooltips:{$ref:"#/definitions/tooltips"},sorting:{$ref:"#/definitions/sorting"},drilldown:{$ref:"#/definitions/drilldown"},expandCollapse:{$ref:"#/definitions/expandCollapse"},suppressDefaultTitle:{type:"boolean",description:"Indicates whether the visual should show a default title"},supportsKeyboardFocus:{type:"boolean",description:"Allows the visual to receive focus through keyboard navigation"},supportsHighlight:{type:"boolean",description:"Tells the host to include highlight data"},supportsSynchronizingFilterState:{type:"boolean",description:"Indicates whether the visual supports synchronization across report pages (for slicer visuals only)"},advancedEditModeSupport:{type:"number",description:"Indicates the action requested from the host when this visual enters Advanced Edit mode."},supportsLandingPage:{type:"boolean",description:"Indicates whether the visual supports a landing page"},supportsEmptyDataView:{type:"boolean",description:"Indicates whether the visual can receive formatting pane properties when it has no dataroles"},supportsMultiVisualSelection:{type:"boolean",description:"Indicates whether the visual supports multi selection"},subtotals:{description:"Specifies the subtotal customizations applied in the customizeQuery method",$ref:"#/definitions/subtotals"},migration:{$ref:"#/definitions/migration"},keepAllMetadataColumns:{type:"boolean",description:"Indicates that visual is going to receive all metadata columns, no matter what the active projections are"}},required:["privileges"],additionalProperties:!1,definitions:{privilege:{type:"object",description:"privilege - Defines the name, essentiality, and optional parameters for a privilege",properties:{name:{type:"string",description:"The internal name of the privilege",enum:["WebAccess","LocalStorage","ExportContent"]},essential:{type:"boolean",description:"Determines if the privilege is essential for the visual. Default value is false"},parameters:{type:"array",description:"Determines a list of privilege parameters if any",items:{type:"string",description:"The privilege parameter"}}},required:["name"]},dataRole:{type:"object",description:"dataRole - Defines the name, displayName, and kind of a data role",properties:{name:{type:"string",description:"The internal name for this data role used for all references to this role"},displayName:{type:"string",description:"The name of this data role that is shown to the user"},displayNameKey:{type:"string",description:"The localization key for the displayed name in the stringResourced file"},kind:{description:"The kind of data that can be bound do this role",$ref:"#/definitions/dataRole.kind"},description:{type:"string",description:"A description of this role shown to the user as a tooltip"},descriptionKey:{type:"string",description:"The localization key for the description in the stringResourced file"},preferredTypes:{type:"array",description:"Defines the preferred type of data for this data role",items:{$ref:"#/definitions/valueType"}},requiredTypes:{type:"array",description:"Defines the required type of data for this data role. Any values that do not match will be set to null",items:{$ref:"#/definitions/valueType"}}},required:["name","displayName","kind"],additionalProperties:!1},dataViewMapping:{type:"object",description:"dataMapping - Defines how data is mapped to data roles",properties:{conditions:{type:"array",description:"List of conditions that must be met for this data mapping",items:{type:"object",description:"condition - Defines conditions for a data mapping (each key needs to be a valid data role)",patternProperties:{"^[\\w\\s-]+$":{description:"Specifies the number of values that can be assigned to this data role in this mapping",$ref:"#/definitions/dataViewMapping.numberRangeWithKind"}},additionalProperties:!1}},single:{$ref:"#/definitions/dataViewMapping.single"},categorical:{$ref:"#/definitions/dataViewMapping.categorical"},table:{$ref:"#/definitions/dataViewMapping.table"},matrix:{$ref:"#/definitions/dataViewMapping.matrix"},scriptResult:{$ref:"#/definitions/dataViewMapping.scriptResult"}},anyOf:[{required:["single"]},{required:["categorical"]},{required:["table"]},{required:["matrix"]},{required:["scriptResult"]}],additionalProperties:!1},"dataViewMapping.single":{type:"object",description:"single - Defines a single data mapping",properties:{role:{type:"string",description:"The data role to bind to this mapping"}},required:["role"],additionalProperties:!1},"dataViewMapping.categorical":{type:"object",description:"categorical - Defines a categorical data mapping",properties:{categories:{type:"object",description:"Defines data roles to be used as categories",properties:{bind:{$ref:"#/definitions/dataViewMapping.bindTo"},for:{$ref:"#/definitions/dataViewMapping.forIn"},select:{$ref:"#/definitions/dataViewMapping.select"},dataReductionAlgorithm:{$ref:"#/definitions/dataViewMapping.dataReductionAlgorithm"}},oneOf:[{required:["for"]},{required:["bind"]},{required:["select"]}]},values:{type:"object",description:"Defines data roles to be used as values",properties:{bind:{$ref:"#/definitions/dataViewMapping.bindTo"},for:{$ref:"#/definitions/dataViewMapping.forIn"},select:{$ref:"#/definitions/dataViewMapping.select"},group:{type:"object",description:"Groups on a a specific data role",properties:{by:{description:"Specifies a data role to use for grouping",type:"string"},select:{$ref:"#/definitions/dataViewMapping.select"},dataReductionAlgorithm:{$ref:"#/definitions/dataViewMapping.dataReductionAlgorithm"}},required:["by","select"]}},oneOf:[{required:["for"]},{required:["bind"]},{required:["select"]},{required:["group"]}]},dataVolume:{$ref:"#/definitions/dataViewMapping.dataVolume"}},additionalProperties:!1},"dataViewMapping.table":{type:"object",description:"table - Defines a table data mapping",properties:{rows:{type:"object",description:"Rows to use for the table",properties:{bind:{$ref:"#/definitions/dataViewMapping.bindTo"},for:{$ref:"#/definitions/dataViewMapping.forIn"},select:{$ref:"#/definitions/dataViewMapping.select"},dataReductionAlgorithm:{$ref:"#/definitions/dataViewMapping.dataReductionAlgorithm"}},oneOf:[{required:["for"]},{required:["bind"]},{required:["select"]}]},rowCount:{type:"object",description:"Specifies a constraint on the number of data rows supported by the visual",properties:{preferred:{description:"Specifies a preferred range of values for the constraint",$ref:"#/definitions/dataViewMapping.numberRange"},supported:{description:"Specifies a supported range of values for the constraint. Defaults to preferred if not specified.",$ref:"#/definitions/dataViewMapping.numberRange"}}},dataVolume:{$ref:"#/definitions/dataViewMapping.dataVolume"}},requires:["rows"]},"dataViewMapping.matrix":{type:"object",description:"matrix - Defines a matrix data mapping",properties:{rows:{type:"object",description:"Defines the rows used for the matrix",properties:{for:{$ref:"#/definitions/dataViewMapping.forIn"},select:{$ref:"#/definitions/dataViewMapping.select"},dataReductionAlgorithm:{$ref:"#/definitions/dataViewMapping.dataReductionAlgorithm"}},oneOf:[{required:["for"]},{required:["select"]}]},columns:{type:"object",description:"Defines the columns used for the matrix",properties:{for:{$ref:"#/definitions/dataViewMapping.forIn"},dataReductionAlgorithm:{$ref:"#/definitions/dataViewMapping.dataReductionAlgorithm"}},required:["for"]},values:{type:"object",description:"Defines the values used for the matrix",properties:{for:{$ref:"#/definitions/dataViewMapping.forIn"},select:{$ref:"#/definitions/dataViewMapping.select"}},oneOf:[{required:["for"]},{required:["select"]}]},dataVolume:{$ref:"#/definitions/dataViewMapping.dataVolume"}}},"dataViewMapping.scriptResult":{type:"object",description:"scriptResult - Defines a scriptResult data mapping",properties:{dataInput:{type:"object",description:"dataInput - Defines how data is mapped to data roles",properties:{table:{$ref:"#/definitions/dataViewMapping.table"}}},script:{type:"object",description:"script - Defines where the script text and provider are stored",properties:{scriptSourceDefault:{type:"string",description:"scriptSourceDefault - Defines the default script source value to be used when no script object is defined"},scriptProviderDefault:{type:"string",description:"scriptProviderDefault - Defines the default script provider value to be used when no provider object is defined"},scriptOutputType:{type:"string",description:"scriptOutputType - Defines the output type that the R script will generate"},source:{$ref:"#/definitions/dataViewObjectPropertyIdentifier"},provider:{$ref:"#/definitions/dataViewObjectPropertyIdentifier"}}}}},dataViewObjectPropertyIdentifier:{type:"object",description:"Points to an object property",properties:{objectName:{type:"string",description:"The name of a object"},propertyName:{type:"string",description:"The name of a property inside the object"}}},"dataViewMapping.bindTo":{type:"object",description:"Binds this data mapping to a single value",properties:{to:{type:"string",description:"The name of a data role to bind to"}},additionalProperties:!1,required:["to"]},"dataViewMapping.numberRange":{type:"object",description:"A number range from min to max",properties:{min:{type:"number",description:"Minimum value supported"},max:{type:"number",description:"Maximum value supported"}}},"dataViewMapping.numberRangeWithKind":{allOf:[{$ref:"#/definitions/dataViewMapping.numberRange"},{properties:{kind:{$ref:"#/definitions/dataRole.kind"}}}]},"dataRole.kind":{type:"string",enum:["Grouping","Measure","GroupingOrMeasure"]},"dataViewMapping.select":{type:"array",description:"Defines a list of properties to bind",items:{type:"object",properties:{bind:{$ref:"#/definitions/dataViewMapping.bindTo"},for:{$ref:"#/definitions/dataViewMapping.forIn"}},oneOf:[{required:["for"]},{required:["bind"]}]}},"dataViewMapping.dataReductionAlgorithm":{type:"object",description:"Describes how to reduce the amount of data exposed to the visual",properties:{top:{type:"object",description:"Reduce the data to the Top count items",properties:{count:{type:"number"}}},bottom:{type:"object",description:"Reduce the data to the Bottom count items",properties:{count:{type:"number"}}},sample:{type:"object",description:"Reduce the data using a simple Sample of count items",properties:{count:{type:"number"}}},window:{type:"object",description:"Allow the data to be loaded one window, containing count items, at a time",properties:{count:{type:"number"}}}},additionalProperties:!1,oneOf:[{required:["top"]},{required:["bottom"]},{required:["sample"]},{required:["window"]}]},"dataViewMapping.dataVolume":{description:"Specifies the volume of data the query should return (1-6)",type:"number",enum:[1,2,3,4,5,6]},"dataViewMapping.forIn":{type:"object",description:"Binds this data mapping for all items in a collection",properties:{in:{type:"string",description:"The name of a data role to iterate over"}},additionalProperties:!1,required:["in"]},objects:{type:"object",description:"A list of unique property groups",patternProperties:{"^[\\w\\s-]+$":{type:"object",description:"Settings for a group of properties",properties:{displayName:{type:"string",description:"The name shown to the user to describe this group of properties"},displayNameKey:{type:"string",description:"The localization key for the displayed name in the stringResourced file"},objectCategory:{type:"number",description:"What aspect of the visual this object controlls (1 = Formatting, 2 = Analytics). Formatting: look & feel, colors, axes, labels etc. Analytics: forcasts, trendlines, reference lines and shapes etc."},description:{type:"string",description:"A description of this object shown to the user as a tooltip"},descriptionKey:{type:"string",description:"The localization key for the description in the stringResourced file"},properties:{type:"object",description:"A list of unique properties contained in this group",patternProperties:{"^[\\w\\s-]+$":{$ref:"#/definitions/object.propertySettings"}},additionalProperties:!1}},additionalProperties:!1}},additionalProperties:!1},tooltips:{type:"object",description:"Instructs the host to include tooltips ability",properties:{supportedTypes:{type:"object",description:"Instructs the host what tooltip types to support",properties:{default:{type:"boolean",description:"Instructs the host to support showing default tooltips"},canvas:{type:"boolean",description:"Instructs the host to support showing canvas tooltips"}}},roles:{type:"array",items:{type:"string",description:"The name of the data role to bind the tooltips selected info to"}},supportEnhancedTooltips:{type:"boolean",description:"Indicates whether the visual support modern tooltip feature"}}},"object.propertySettings":{type:"object",description:"Settings for a property",properties:{displayName:{type:"string",description:"The name shown to the user to describe this property"},displayNameKey:{type:"string",description:"The localization key for the displayed name in the stringResourced file"},description:{type:"string",description:"A description of this property shown to the user as a tooltip"},descriptionKey:{type:"string",description:"The localization key for the description in the stringResourced file"},placeHolderText:{type:"string",description:"Text to display if the field is empty"},placeHolderTextKey:{type:"string",description:"The localization key for the placeHolderText in the stringResources file"},suppressFormatPainterCopy:{type:"boolean",description:"Indicates whether the Format Painter should ignore this property"},type:{description:"Describes what type of property this is and how it should be displayed to the user",$ref:"#/definitions/valueType"},rule:{type:"object",description:"Describes substitution rule that replaces property object, described inside the rule, to current property object that contains this rule",$ref:"#/definitions/substitutionRule"},filterState:{type:"boolean",description:"Indicates whether the property is a part of filtration information"}},additionalProperties:!1},substitutionRule:{type:"object",description:"Describes substitution rule that replaces property object, described inside the rule, to current property object that contains this rule",properties:{inputRole:{type:"string",description:"The name of role. If this role is set, the substitution will be applied"},output:{type:"object",description:"Describes what exactly is necessary to replace",properties:{property:{type:"string",description:"The name of property object that will be replaced"},selector:{type:"array",description:"The array of selector names. Usually, it contains only one selector -- 'Category'",items:{type:"string",description:"The name of selector"}}}}}},sorting:{type:"object",description:"Specifies the default sorting behavior for the visual",properties:{default:{type:"object",additionalProperties:!1},custom:{type:"object",additionalProperties:!1},implicit:{type:"object",description:"implicit sort",properties:{clauses:{type:"array",items:{type:"object",properties:{role:{type:"string"},direction:{type:"number",description:"Determines sort direction (1 = Ascending, 2 = Descending)",enum:[1,2]}},additionalProperties:!1}}},additionalProperties:!1}},additionalProperties:!1,anyOf:[{required:["default"]},{required:["custom"]},{required:["implicit"]}]},drilldown:{type:"object",description:"Defines the visual's drill capability",properties:{roles:{type:"array",description:"The drillable role names for this visual",items:{type:"string",description:"The name of the role"}}}},expandCollapse:{type:"object",description:"Defines the visual's expandCollapse capability",properties:{roles:{type:"array",description:"The expandCollapsed role names for this visual",items:{type:"string",description:"The name of the role"}},addDataViewFlags:{type:"object",description:"The data view flags",defaultValue:{type:"boolean",description:"Indicates if the DataViewTreeNode will contain the isCollapsed flag by default"}},supportsMerge:{type:"boolean",description:"Indicates that the expansion state should be updated when query projections change, instead of being reset."},restoreProjectionsOrderFromBookmark:{type:"boolean",description:"Indicates that the bookmarked expansion state should be restored even if the query projections order no longer matches the expansion state levels."}}},valueType:{type:"object",properties:{bool:{type:"boolean",description:"A boolean value that will be displayed to the user as a toggle switch"},enumeration:{type:"array",description:"A list of values that will be displayed as a drop down list",items:{type:"object",description:"Describes an item in the enumeration list",properties:{displayName:{type:"string",description:"The name shown to the user to describe this item"},displayNameKey:{type:"string",description:"The localization key for the displayed name in the stringResourced file"},value:{type:"string",description:"The internal value of this property when this item is selected"}}}},fill:{type:"object",description:"A color value that will be displayed to the user as a color picker",properties:{solid:{type:"object",description:"A solid color value that will be displayed to the user as a color picker",properties:{color:{oneOf:[{type:"boolean"},{type:"object",properties:{nullable:{description:"Allows the user to select 'no fill' for the color",type:"boolean"}}}]}}}}},fillRule:{type:"object",description:"A color gradient that will be dispalyed to the user as a minimum (,medium) and maximum color pickers",properties:{linearGradient2:{type:"object",description:"Two color gradient",properties:{max:{type:"object",description:"Maximum color for gradient",properties:{color:{type:"string"},value:{type:"number"}}},min:{type:"object",description:"Minimum color for gradient",properties:{color:{type:"string"},value:{type:"number"}}},nullColoringStrategy:{type:"object",description:"Null color strategy"}}},linearGradient3:{type:"object",description:"Three color gradient",properties:{max:{type:"object",description:"Maximum color for gradient",properties:{color:{type:"string"},value:{type:"number"}}},min:{type:"object",description:"Minimum color for gradient",properties:{color:{type:"string"},value:{type:"number"}}},mid:{type:"object",description:"Middle color for gradient",properties:{color:{type:"string"},value:{type:"number"}}},nullColoringStrategy:{type:"object",description:"Null color strategy"}}}}},formatting:{type:"object",description:"A numeric value that will be displayed to the user as a text input",properties:{labelDisplayUnits:{type:"boolean",description:"Displays a dropdown with common display units (Auto, None, Thousands, Millions, Billions, Trillions)"},alignment:{type:"boolean",description:"Displays a selector to allow the user to choose left, center, or right alignment"},fontSize:{type:"boolean",description:"Displays a slider that allows the user to choose a font size in points"},fontFamily:{type:"boolean",description:"Displays a dropdown with font families"},formatString:{type:"boolean",description:"Displays dynamic format string"}},additionalProperties:!1,oneOf:[{required:["labelDisplayUnits"]},{required:["alignment"]},{required:["fontSize"]},{required:["fontFamily"]},{required:["formatString"]}]},integer:{type:"boolean",description:"An integer (whole number) value that will be displayed to the user as a text input"},numeric:{type:"boolean",description:"A numeric value that will be displayed to the user as a text input"},filter:{oneOf:[{type:"boolean"},{type:"object",properties:{selfFilter:{type:"boolean"}}}],description:"A filter"},operations:{type:"object",description:"A visual operation",properties:{searchEnabled:{type:"boolean",description:"Turns search ability on"}}},text:{type:"boolean",description:"A text value that will be displayed to the user as a text input"},scripting:{type:"object",description:"A text value that will be displayed to the user as a script",properties:{source:{type:"boolean",description:"A source code"}}},geography:{type:"object",description:"Geographical data",properties:{address:{type:"boolean"},city:{type:"boolean"},continent:{type:"boolean"},country:{type:"boolean"},county:{type:"boolean"},region:{type:"boolean"},postalCode:{type:"boolean"},stateOrProvince:{type:"boolean"},place:{type:"boolean"},latitude:{type:"boolean"},longitude:{type:"boolean"}}}},additionalProperties:!1,oneOf:[{required:["bool"]},{required:["enumeration"]},{required:["fill"]},{required:["fillRule"]},{required:["formatting"]},{required:["integer"]},{required:["numeric"]},{required:["text"]},{required:["geography"]},{required:["scripting"]},{required:["filter"]},{required:["operations"]}]},subtotals:{type:"object",description:"Specifies the subtotal request customizations applied to the outgoing data query",properties:{matrix:{description:"Defines the subtotal customizations of the outgoing data query of a matrix-dataview visual",$ref:"#/definitions/subtotals.matrix"}},requires:["matrix"]},"subtotals.matrix":{type:"object",description:"Specifies the subtotal customizations of the outgoing data query of a matrix-dataview visual",properties:{rowSubtotals:{type:"object",description:"Indicates if the subtotal data should be requested for all fields in the rows field well",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"boolean"}}},rowSubtotalsPerLevel:{type:"object",description:"Indicates if the subtotal data can be toggled for individual fields in the rows field well",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"boolean"}}},columnSubtotals:{type:"object",description:"Indicates if the subtotal data should be requested for all fields in the columns field well",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"boolean"}}},columnSubtotalsPerLevel:{type:"object",description:"Indicates if the subtotal data can be toggled for individual fields in the columns field well",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"boolean"}}},levelSubtotalEnabled:{type:"object",description:"Unlike all other properites, this property is applied to individual rows/columns. The property indicates if the subtotals are requested for the row/column",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"boolean"}}},rowSubtotalsType:{type:"object",description:"Indicates location of row subtotals locations (Top, Bottom). Top means subtotals located at the start of datasource and calculated even before all datasource rows fetched, Bottom means subtotals located at the end of datasource and shown only after all rows are fetched",properties:{propertyIdentifier:{type:"object",properties:{objectName:{type:"string"},propertyName:{type:"string"}}},defaultValue:{type:"string",enum:["Top","Bottom"]}}}},requires:["matrix"]},migration:{type:"object",description:"Defines the supported APIs for migration",properties:{filter:{$ref:"#/definitions/migration.filter"}}},"migration.filter":{type:"object",description:"Defines the capabilities for migrating the filter API",properties:{shouldUseIdentityFilter:{type:"boolean",description:"Indicates whether the new filter should migrate to an identity filter"}}}}},zl={type:"object",properties:{apiVersion:{type:"string",description:"Version of the IVisual API"},author:{type:"object",description:"Information about the author of the visual",properties:{name:{type:"string",description:"Name of the visual author. This is displayed to users."},email:{type:"string",description:"E-mail of the visual author. This is displayed to users for support."}}},assets:{type:"object",description:"Assets used by the visual",properties:{icon:{type:"string",description:"A 20x20 png icon used to represent the visual"}}},externalJS:{type:"array",description:"An array of relative paths to 3rd party javascript libraries to load",items:{type:"string"}},stringResources:{type:"array",description:"An array of relative paths to string resources to load",items:{type:"string"},uniqueItems:!0},style:{type:"string",description:"Relative path to the stylesheet (less) for the visual"},capabilities:{type:"string",description:"Relative path to the visual capabilities json file"},visual:{type:"object",description:"Details about this visual",properties:{description:{type:"string",description:"What does this visual do?"},name:{type:"string",description:"Internal visual name"},displayName:{type:"string",description:"A friendly name"},externals:{type:"array",description:"External files (such as JavaScript) that you would like to include"},guid:{type:"string",description:"Unique identifier for the visual"},visualClassName:{type:"string",description:"Class of your IVisual"},icon:{type:"string",description:"Icon path"},version:{type:"string",description:"Visual version"},gitHubUrl:{type:"string",description:"Url to the github repository for this visual"},supportUrl:{type:"string",description:"Url to the support page for this visual"}}}}},Bl={type:"object",properties:{cranPackages:{type:"array",description:"An array of the Cran packages required for the custom R visual script to operate",items:{$ref:"#/definitions/cranPackage"}}},definitions:{cranPackage:{type:"object",description:"cranPackage - Defines the name and displayName of a required Cran package",properties:{name:{type:"string",description:"The name for this Cran package"},displayName:{type:"string",description:"The name for this Cran package that is shown to the user"},url:{type:"string",description:"A url for package documentation in Cran website"}},required:["name","url"],additionalProperties:!1}}},ql={type:"object",properties:{locale:{$ref:"#/definitions/localeOptions"},values:{type:"object",description:"translations for the display name keys in the capabilities",additionalProperties:{type:"string"}}},required:["locale"],definitions:{localeOptions:{description:"Specifies the locale key from a list of supported locales",type:"string",enum:["ar-SA","bg-BG","ca-ES","cs-CZ","da-DK","de-DE","el-GR","en-US","es-ES","et-EE","eu-ES","fi-FI","fr-FR","gl-ES","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-IT","ja-JP","kk-KZ","ko-KR","lt-LT","lv-LV","ms-MY","nb-NO","nl-NL","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","sr-Cyrl-RS","sr-Latn-RS","sv-SE","th-TH","tr-TR","uk-UA","vi-VN","zh-CN","zh-TW"]}}};!function(){if(jl)return yl;jl=1;const t=Ol();let e=Ul,i=`${t.major(e)}.${t.minor(e)}.0`;yl.version=i,yl.schemas={capabilities:Gl,pbiviz:zl,dependencies:Bl,stringResources:ql}}();const Hl={i:"Observation",i_m:"Observation",i_mm:"Observation",c:"Count",t:"Time",xbar:"Group Mean",s:"Group SD",g:"Non-Events",run:"Observation",mr:"Moving Range",p:"Proportion",pp:"Proportion",u:"Rate",up:"Rate"};class Zl{update(t){const e=t.chart_type,i=["p","pp"].includes(e),a=t.perc_labels;let r,o=t.multiplier;"Yes"===a&&(o=100),i&&"No"!==a&&(o=1===o?100:o),r="Automatic"===a?i&&100===o:"Yes"===a,this.chart_type_props={name:e,needs_denominator:["p","pp","u","up","xbar","s"].includes(e),denominator_optional:["i","i_m","i_mm","run","mr"].includes(e),numerator_non_negative:["p","pp","u","up","s","c","g","t"].includes(e),numerator_leq_denominator:["p","pp","u","up"].includes(e),has_control_limits:!["run"].includes(e),needs_sd:["xbar"].includes(e),integer_num_den:["c","p","pp"].includes(e),value_name:Hl[e],x_axis_use_date:!["g","t"].includes(e),date_name:["g","t"].includes(e)?"Event":"Date"},this.multiplier=o,this.percentLabels=r}}class Yl{update(t,e){var i,a,r;this.validationStatus=JSON.parse(JSON.stringify({status:0,messages:new Array,error:""}));const o=Object.keys(this.settings),l=null!==(r=null===(a=null===(i=null==t?void 0:t.categorical)||void 0===i?void 0:i.categories)||void 0===a?void 0:a.some((t=>t.source.roles.indicator)))&&void 0!==r&&r;this.settingsGrouped=new Array,l&&e.forEach((()=>{this.settingsGrouped.push(Object.fromEntries(Object.keys(ua).map((t=>[t,Object.fromEntries(Object.keys(ua[t]).map((e=>[e,ua[t][e]])))]))))}));const n=e.flat();if(o.forEach((i=>{const a=Ra(null==t?void 0:t.categorical,i,this.settings,n);0!==a.validation.status&&(this.validationStatus.status=a.validation.status,this.validationStatus.error=a.validation.error),0===this.validationStatus.messages.length?this.validationStatus.messages=a.validation.messages:a.validation.messages.every((t=>0===t.length))||a.validation.messages.forEach(((t,e)=>{t.length>0&&(this.validationStatus.messages[e]=this.validationStatus.messages[e].concat(t))}));Object.keys(this.settings[i]).forEach((t=>{this.settings[i][t]=(null==a?void 0:a.values)?null==a?void 0:a.values[0][t]:ua[i][t].default,l&&e.forEach(((e,r)=>{this.settingsGrouped[r][i][t]=(null==a?void 0:a.values)?null==a?void 0:a.values[e[0]][t]:ua[i][t].default}))}))})),this.settings.nhs_icons.show_variation_icons){["astronomical","shift","trend","two_in_three"].some((t=>this.settings.outliers[t]))||(this.validationStatus.status=1,this.validationStatus.error="Variation icons require at least one outlier pattern to be selected")}this.derivedSettings.update(this.settings.spc),this.derivedSettingsGrouped=new Array,l&&this.settingsGrouped.forEach((t=>{const e=new Zl;e.update(t.spc),this.derivedSettingsGrouped.push(e)}))}getFormattingModel(){var t,e;const i={cards:[]};for(const a in na){let r={description:na[a].description,displayName:na[a].displayName,uid:a+"_card_uid",groups:[],revertToDefaultDescriptors:[]};for(const i in na[a].settingsGroups){let o={displayName:"all"===i?na[a].displayName:i,uid:a+"_"+i+"_uid",slices:[]};for(const l in na[a].settingsGroups[i]){r.revertToDefaultDescriptors.push({objectName:a,propertyName:l});let n={uid:a+"_"+i+"_"+l+"_slice_uid",displayName:na[a].settingsGroups[i][l].displayName,control:{type:na[a].settingsGroups[i][l].type,properties:{descriptor:{objectName:a,propertyName:l,selector:{data:[{dataViewWildcard:{matchingOption:0}}]},instanceKind:"boolean"!=typeof this.settings[a][l]?3:null},value:this.valueLookup(a,i,l),items:null===(t=na[a].settingsGroups[i][l])||void 0===t?void 0:t.items,options:null===(e=na[a].settingsGroups[i][l])||void 0===e?void 0:e.options}}};o.slices.push(n)}r.groups.push(o)}i.cards.push(r)}return i}valueLookup(t,e,i){var a;if(i.includes("colour"))return{value:this.settings[t][i]};if(!ca(null===(a=na[t].settingsGroups[e][i])||void 0===a?void 0:a.items)){const a=na[t].settingsGroups[e][i].items,r=this.settings[t][i];return a.find((t=>t.value===r))}return this.settings[t][i]}constructor(){this.settings=Object.fromEntries(Object.keys(ua).map((t=>[t,Object.fromEntries(Object.keys(ua[t]).map((e=>[e,ua[t][e]])))]))),this.derivedSettings=new Zl}}function Xl(t){const e=t.denominators&&t.denominators.length>0,i=e?va(t.numerators,t.denominators):t.numerators,a=Ga(i,t.subset_points),r=Wa(a),o=Na(Ca(a)),l=3.267*Wa(o),n=Wa(t.outliers_in_limits?o:o.filter((t=>t<l)))/1.128;return{keys:t.keys,values:i.map((t=>isNaN(t)?0:t)),numerators:e?t.numerators:void 0,denominators:e?t.denominators:void 0,targets:Pa(r,t.keys.length),ll99:Pa(r-3*n,t.keys.length),ll95:Pa(r-2*n,t.keys.length),ll68:Pa(r-1*n,t.keys.length),ul68:Pa(r+1*n,t.keys.length),ul95:Pa(r+2*n,t.keys.length),ul99:Pa(r+3*n,t.keys.length)}}function Wl(t){const e=t.denominators&&t.denominators.length>0,i=e?va(t.numerators,t.denominators):t.numerators,a=Za(Ga(i,t.subset_points));return{keys:t.keys,values:i.map((t=>isNaN(t)?0:t)),numerators:e?t.numerators:void 0,denominators:e?t.denominators:void 0,targets:Pa(a,t.keys.length)}}var Kl=Object.freeze({__proto__:null,c:function(t){const e=Wa(Ga(t.numerators,t.subset_points)),i=Math.sqrt(e);return{keys:t.keys,values:t.numerators,targets:Pa(e,t.keys.length),ll99:Pa(qa(e-3*i,{lower:0}),t.keys.length),ll95:Pa(qa(e-2*i,{lower:0}),t.keys.length),ll68:Pa(qa(e-1*i,{lower:0}),t.keys.length),ul68:Pa(e+1*i,t.keys.length),ul95:Pa(e+2*i,t.keys.length),ul99:Pa(e+3*i,t.keys.length)}},g:function(t){const e=Wa(Ga(t.numerators,t.subset_points)),i=ba(e*(e+1));return{keys:t.keys,values:t.numerators,targets:Pa(Za(Ga(t.numerators,t.subset_points)),t.keys.length),ll99:Pa(0,t.keys.length),ll95:Pa(0,t.keys.length),ll68:Pa(0,t.keys.length),ul68:Pa(e+1*i,t.keys.length),ul95:Pa(e+2*i,t.keys.length),ul99:Pa(e+3*i,t.keys.length)}},i:Xl,i_m:function(t){const e=t.denominators&&t.denominators.length>0,i=e?va(t.numerators,t.denominators):t.numerators,a=Ga(i,t.subset_points),r=Za(a),o=Na(Ca(a)),l=3.267*Wa(o),n=Wa(t.outliers_in_limits?o:o.filter((t=>t<l)))/1.128;return{keys:t.keys,values:i.map((t=>isNaN(t)?0:t)),numerators:e?t.numerators:void 0,denominators:e?t.denominators:void 0,targets:Pa(r,t.keys.length),ll99:Pa(r-3*n,t.keys.length),ll95:Pa(r-2*n,t.keys.length),ll68:Pa(r-1*n,t.keys.length),ul68:Pa(r+1*n,t.keys.length),ul95:Pa(r+2*n,t.keys.length),ul99:Pa(r+3*n,t.keys.length)}},i_mm:function(t){const e=t.denominators&&t.denominators.length>0,i=e?va(t.numerators,t.denominators):t.numerators,a=Ga(i,t.subset_points),r=Za(a),o=Na(Ca(a)),l=3.267*Za(o),n=Za(t.outliers_in_limits?o:o.filter((t=>t<l)))/1.128;return{keys:t.keys,values:i.map((t=>isNaN(t)?0:t)),numerators:e?t.numerators:void 0,denominators:e?t.denominators:void 0,targets:Pa(r,t.keys.length),ll99:Pa(r-3*n,t.keys.length),ll95:Pa(r-2*n,t.keys.length),ll68:Pa(r-1*n,t.keys.length),ul68:Pa(r+1*n,t.keys.length),ul95:Pa(r+2*n,t.keys.length),ul99:Pa(r+3*n,t.keys.length)}},mr:function(t){const e=t.denominators&&t.denominators.length>0,i=e?va(t.numerators,t.denominators):t.numerators,a=Na(Ca(i)),r=Wa(Ga(a,t.subset_points));return{keys:t.keys.slice(1),values:a.slice(1),numerators:e?t.numerators.slice(1):void 0,denominators:e?t.denominators.slice(1):void 0,targets:Pa(r,t.keys.length-1),ll99:Pa(0,t.keys.length-1),ll95:Pa(0,t.keys.length-1),ll68:Pa(0,t.keys.length-1),ul68:Pa(1.089*r,t.keys.length-1),ul95:Pa(2.178*r,t.keys.length-1),ul99:Pa(3.267*r,t.keys.length-1)}},p:function(t){const e=Ka(Ga(t.numerators,t.subset_points))/Ka(Ga(t.denominators,t.subset_points)),i=ba(va(e*(1-e),t.denominators));return{keys:t.keys,values:va(t.numerators,t.denominators),numerators:t.numerators,denominators:t.denominators,targets:Pa(e,t.keys.length),ll99:qa(ga(e,_a(3,i)),{lower:0}),ll95:qa(ga(e,_a(2,i)),{lower:0}),ll68:qa(ga(e,_a(1,i)),{lower:0}),ul68:qa(ya(e,_a(1,i)),{upper:1}),ul95:qa(ya(e,_a(2,i)),{upper:1}),ul99:qa(ya(e,_a(3,i)),{upper:1})}},pp:function(t){const e=va(t.numerators,t.denominators),i=Ka(Ga(t.numerators,t.subset_points))/Ka(Ga(t.denominators,t.subset_points)),a=ba(va(i*(1-i),t.denominators)),r=Ga(va(ga(e,i),a),t.subset_points),o=Na(Ca(r)),l=3.267*Wa(o),n=t.outliers_in_limits?o:o.filter((t=>t<l)),s=_a(a,Wa(n)/1.128);return{keys:t.keys,values:e,numerators:t.numerators,denominators:t.denominators,targets:Pa(i,t.keys.length),ll99:qa(ga(i,_a(3,s)),{lower:0}),ll95:qa(ga(i,_a(2,s)),{lower:0}),ll68:qa(ga(i,_a(1,s)),{lower:0}),ul68:qa(ya(i,_a(1,s)),{upper:1}),ul95:qa(ya(i,_a(2,s)),{upper:1}),ul99:qa(ya(i,_a(3,s)),{upper:1})}},r:Wl,run:Wl,s:function(t){const e=t.numerators,i=t.denominators,a=ga(Ga(i,t.subset_points),1),r=ba(Ka(_a(a,fa(Ga(e,t.subset_points),2)))/Ka(a));return{keys:t.keys,values:e,targets:Pa(r,t.keys.length),ll99:_a(r,Da(i,3)),ll95:_a(r,Da(i,2)),ll68:_a(r,Da(i,1)),ul68:_a(r,La(i,1)),ul95:_a(r,La(i,2)),ul99:_a(r,La(i,3))}},t:function(t){const e=fa(t.numerators,1/3.6),i=JSON.parse(JSON.stringify(t));i.numerators=e,i.denominators=null;const a=Xl(i);return a.targets=fa(a.targets,3.6),a.values=fa(a.values,3.6),a.ll99=qa(fa(a.ll99,3.6),{lower:0}),a.ll95=qa(fa(a.ll95,3.6),{lower:0}),a.ll68=qa(fa(a.ll68,3.6),{lower:0}),a.ul68=fa(a.ul68,3.6),a.ul95=fa(a.ul95,3.6),a.ul99=fa(a.ul99,3.6),a},u:function(t){const e=Ka(Ga(t.numerators,t.subset_points))/Ka(Ga(t.denominators,t.subset_points)),i=ba(va(e,t.denominators));return{keys:t.keys,values:va(t.numerators,t.denominators),numerators:t.numerators,denominators:t.denominators,targets:Pa(e,t.keys.length),ll99:qa(ga(e,_a(3,i)),{lower:0}),ll95:qa(ga(e,_a(2,i)),{lower:0}),ll68:qa(ga(e,_a(1,i)),{lower:0}),ul68:ya(e,_a(1,i)),ul95:ya(e,_a(2,i)),ul99:ya(e,_a(3,i))}},up:function(t){const e=va(t.numerators,t.denominators),i=Ka(Ga(t.numerators,t.subset_points))/Ka(Ga(t.denominators,t.subset_points)),a=ba(va(i,t.denominators)),r=Ga(va(ga(e,i),a),t.subset_points),o=Na(Ca(r)),l=3.267*Wa(o),n=t.outliers_in_limits?o:o.filter((t=>t<l)),s=_a(a,Wa(n)/1.128);return{keys:t.keys,values:e,numerators:t.numerators,denominators:t.denominators,targets:Pa(i,t.keys.length),ll99:qa(ga(i,_a(3,s)),{lower:0}),ll95:qa(ga(i,_a(2,s)),{lower:0}),ll68:qa(ga(i,_a(1,s)),{lower:0}),ul68:ya(i,_a(1,s)),ul95:ya(i,_a(2,s)),ul99:ya(i,_a(3,s))}},xbar:function(t){const e=t.denominators,i=Ga(e,t.subset_points),a=t.numerators,r=Ga(a,t.subset_points),o=Ga(t.xbar_sds,t.subset_points),l=ga(i,1),n=ba(Ka(_a(l,Sa(o)))/Ka(l)),s=Ka(_a(i,r))/Ka(i),u=Ta(e);return{keys:t.keys,values:a,targets:Pa(s,t.keys.length),ll99:ga(s,_a(u,n)),ll95:ga(s,_a(_a(va(u,3),2),n)),ll68:ga(s,_a(va(u,3),n)),ul68:ya(s,_a(va(u,3),n)),ul95:ya(s,_a(_a(va(u,3),2),n)),ul99:ya(s,_a(u,n)),count:e}}});function Jl(t,e,i){return t.map(((t,a)=>ha(t,e[a],i[a])?"none":t>i[a]?"upper":"lower"))}function Ql(t,e,i){const a=t.map(((t,i)=>Math.sign(t-e[i]))),r=a.map(((t,e)=>Ka(a.slice(Math.max(0,e-(i-1)),e+1)))).map((t=>Na(t)>=i?t>=i?"upper":"lower":"none"));for(let t=0;t<r.length;t++)if("none"!==r[t])for(let e=t-1;e>=t-(i-1);e--)r[e]=r[t];return r}function tn(t,e){const i=t.map(((e,i)=>0==i?i:Math.sign(e-t[i-1]))),a=i.map(((t,a)=>Ka(i.slice(Math.max(0,a-(e-2)),a+1)))).map((t=>Na(t)>=e-1?t>=e-1?"upper":"lower":"none"));for(let t=0;t<a.length;t++)if("none"!==a[t])for(let i=t-1;i>=t-(e-1);i--)a[i]=a[t];return a}function en(t,e,i,a){const r=t.map(((t,a)=>t>i[a]?1:t<e[a]?-1:0)),o=r.map(((t,e)=>Ka(r.slice(Math.max(0,e-2),e+1)))).map((t=>Na(t)>=2?t>=2?"upper":"lower":"none"));for(let t=0;t<o.length;t++)if("none"!==o[t]){for(let e=t-1;e>=t-2;e--)(0!==r[e]||a)&&(o[e]=o[t]);0!==r[t]||a||(o[t]="none")}return o}class an{constructor(){this.inputData=null,this.inputSettings=new Yl,this.controlLimits=null,this.plotPoints=new Array,this.groupedLines=new Array,this.firstRun=!0,this.splitIndexes=new Array,this.colourPalette=null,this.headless=!1,this.frontend=!1}update(t,e){var i,a,r,o,l,n,s,u,p,d,c,h,m,f,y,g,v,_,w;ca(this.colourPalette)&&(this.colourPalette={isHighContrast:e.colorPalette.isHighContrast,foregroundColour:e.colorPalette.foreground.value,backgroundColour:e.colorPalette.background.value,foregroundSelectedColour:e.colorPalette.foregroundSelected.value,hyperlinkColour:e.colorPalette.hyperlink.value}),this.svgWidth=t.viewport.width,this.svgHeight=t.viewport.height,this.headless=null!==(i=null==t?void 0:t.headless)&&void 0!==i&&i,this.frontend=null!==(a=null==t?void 0:t.frontend)&&void 0!==a&&a;const b=null===(l=null===(o=null===(r=t.dataViews[0])||void 0===r?void 0:r.categorical)||void 0===o?void 0:o.categories)||void 0===l?void 0:l.filter((t=>t.source.roles.indicator));this.indicatorVarNames=null!==(n=null==b?void 0:b.map((t=>t.source.displayName)))&&void 0!==n?n:[];const N=null==b?void 0:b.length,x=null!==(h=null===(c=null===(d=null===(p=null===(u=null===(s=t.dataViews[0])||void 0===s?void 0:s.categorical)||void 0===u?void 0:u.categories)||void 0===p?void 0:p[0])||void 0===d?void 0:d.values)||void 0===c?void 0:c.length)&&void 0!==h?h:1,S={status:!0},k=new Array;k.push([0]),this.groupNames=new Array,this.groupNames.push(null!==(m=null==b?void 0:b.map((t=>t.values[0])))&&void 0!==m?m:[]);let A=0;for(let t=1;t<x;t++){let e=!0;for(let i=0;i<N;i++)e=e&&(null==b?void 0:b[i].values[t])===(null==b?void 0:b[i].values[t-1]);e?k[A].push(t):(k.push([t]),this.groupNames.push(null!==(f=null==b?void 0:b.map((e=>e.values[t])))&&void 0!==f?f:[]),A+=1)}if((2===t.type||this.firstRun)&&this.inputSettings.update(t.dataViews[0],k),""!==this.inputSettings.validationStatus.error)return S.status=!1,S.error=this.inputSettings.validationStatus.error,S.type="settings",S;const F=function(t,e){var i,a,r,o,l,n,s,u,p,d,c,h,m,f,y;if(ca(null==t?void 0:t[0])||0===(null===(l=null===(o=null===(r=null===(a=null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.categorical)||void 0===a?void 0:a.categories)||void 0===r?void 0:r[0])||void 0===o?void 0:o.identity)||void 0===l?void 0:l.length))return"";if(ca(null===(s=null===(n=t[0])||void 0===n?void 0:n.categorical)||void 0===s?void 0:s.categories)||ca(null===(p=null===(u=t[0])||void 0===u?void 0:u.categorical)||void 0===p?void 0:p.categories.some((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.roles)||void 0===i?void 0:i.key}))))return"";const g=null===(c=null===(d=t[0].categorical)||void 0===d?void 0:d.values)||void 0===c?void 0:c.some((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.roles)||void 0===i?void 0:i.numerators}));if(!g)return"No Numerators passed!";let v,_,w;if((null==e?void 0:e.derivedSettingsGrouped.length)>0?null==e||e.derivedSettingsGrouped.forEach((t=>{t.chart_type_props.needs_denominator&&(w=t.chart_type_props.name,v=!0),t.chart_type_props.needs_sd&&(w=t.chart_type_props.name,_=!0)})):(w=e.settings.spc.chart_type,v=e.derivedSettings.chart_type_props.needs_denominator,_=e.derivedSettings.chart_type_props.needs_sd),v){const e=null===(m=null===(h=t[0].categorical)||void 0===h?void 0:h.values)||void 0===m?void 0:m.some((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.roles)||void 0===i?void 0:i.denominators}));if(!e)return`Chart type '${w}' requires denominators!`}if(_){const e=null===(y=null===(f=t[0].categorical)||void 0===f?void 0:f.values)||void 0===y?void 0:y.some((t=>{var e,i;return null===(i=null===(e=t.source)||void 0===e?void 0:e.roles)||void 0===i?void 0:i.xbar_sds}));if(!e)return`Chart type '${w}' requires SDs!`}return"valid"}(t.dataViews,this.inputSettings);if("valid"!==F)return S.status=!1,S.error=F,S;if(2===t.type||this.firstRun)if(t.dataViews[0].categorical.categories.some((t=>t.source.roles.indicator)))this.showGrouped=!0,this.inputDataGrouped=new Array,this.groupStartEndIndexesGrouped=new Array,this.controlLimitsGrouped=new Array,this.outliersGrouped=new Array,this.identitiesGrouped=new Array,k.forEach(((i,a)=>{const r=Ua(t.dataViews[0].categorical,this.inputSettings.settingsGrouped[a],this.inputSettings.derivedSettingsGrouped[a],this.inputSettings.validationStatus.messages,i),o=0!==r.validationStatus.status,l=o?new Array:this.getGroupingIndexes(r),n=o?null:this.calculateLimits(r,l,this.inputSettings.settingsGrouped[a]),s=o?null:this.flagOutliers(n,l,this.inputSettings.settingsGrouped[a],this.inputSettings.derivedSettingsGrouped[a]);o||this.scaleAndTruncateLimits(n,this.inputSettings.settingsGrouped[a],this.inputSettings.derivedSettingsGrouped[a]);const u=i.map((i=>e.createSelectionIdBuilder().withCategory(t.dataViews[0].categorical.categories[0],i).createSelectionId()));this.identitiesGrouped.push(u),this.inputDataGrouped.push(r),this.groupStartEndIndexesGrouped.push(l),this.controlLimitsGrouped.push(n),this.outliersGrouped.push(s)})),this.initialisePlotDataGrouped();else{this.showGrouped=!1,this.groupNames=null,this.inputDataGrouped=null,this.groupStartEndIndexesGrouped=null,this.controlLimitsGrouped=null;const i=null!==(w=null===(_=null===(v=null===(g=null===(y=t.dataViews[0])||void 0===y?void 0:y.metadata)||void 0===g?void 0:g.objects)||void 0===v?void 0:v.split_indexes_storage)||void 0===_?void 0:_.split_indexes)&&void 0!==w?w:"[]",a=JSON.parse(i);this.splitIndexes=a,this.inputData=Ua(t.dataViews[0].categorical,this.inputSettings.settings,this.inputSettings.derivedSettings,this.inputSettings.validationStatus.messages,k[0]),0===this.inputData.validationStatus.status&&(this.groupStartEndIndexes=this.getGroupingIndexes(this.inputData,this.splitIndexes),this.controlLimits=this.calculateLimits(this.inputData,this.groupStartEndIndexes,this.inputSettings.settings),this.scaleAndTruncateLimits(this.controlLimits,this.inputSettings.settings,this.inputSettings.derivedSettings),this.outliers=this.flagOutliers(this.controlLimits,this.groupStartEndIndexes,this.inputSettings.settings,this.inputSettings.derivedSettings),this.initialisePlotData(e),this.initialiseGroupedLines())}if(this.firstRun=!1,this.showGrouped){if(this.inputDataGrouped.map((t=>t.validationStatus.status)).some((t=>0!==t)))return S.status=!1,S.error=this.inputDataGrouped.map((t=>t.validationStatus.error)).join("\n"),S;this.inputDataGrouped.some((t=>""!==t.warningMessage))&&(S.warning=this.inputDataGrouped.map((t=>t.warningMessage)).join("\n"))}else{if(0!==this.inputData.validationStatus.status)return S.status=!1,S.error=this.inputData.validationStatus.error,S;""!==this.inputData.warningMessage&&(S.warning=this.inputData.warningMessage)}return S}getGroupingIndexes(t,e){const i=(null!=e?e:[]).concat([-1]).concat(t.groupingIndexes).concat([t.limitInputArgs.keys.length-1]).filter(((t,e,i)=>i.indexOf(t)===e)).sort(((t,e)=>t-e)),a=new Array;for(let t=0;t<i.length-1;t++)a.push([i[t]+1,i[t+1]+1]);return a}calculateLimits(t,e,i){var a;const r=Kl[i.spc.chart_type];let o;if(t.limitInputArgs.outliers_in_limits=i.spc.outliers_in_limits,e.length>1){o=e.map((e=>{const i=JSON.parse(JSON.stringify(t));return i.limitInputArgs.denominators=i.limitInputArgs.denominators.slice(e[0],e[1]),i.limitInputArgs.numerators=i.limitInputArgs.numerators.slice(e[0],e[1]),i.limitInputArgs.keys=i.limitInputArgs.keys.slice(e[0],e[1]),i})).map((t=>{const e=r(t.limitInputArgs);return e.trend_line=lr(e.values),e})).reduce(((t,e)=>{const i=t;return Object.entries(t).forEach(((t,a)=>{var r;const o=Object.entries(e)[a][1];i[t[0]]=null===(r=t[1])||void 0===r?void 0:r.concat(o)})),i}))}else o=r(t.limitInputArgs),o.trend_line=lr(o.values);o.alt_targets=t.alt_targets,o.speclimits_lower=t.speclimits_lower,o.speclimits_upper=t.speclimits_upper;for(const t of Object.keys(o))"keys"!==t&&(o[t]=null===(a=o[t])||void 0===a?void 0:a.map((t=>isNaN(t)?null:t)));return o}initialisePlotDataGrouped(){var t,e,i,a,r,o,l,n,s,u,p,d,c,h,m;this.plotPointsGrouped=new Array,this.tableColumnsGrouped=new Array,this.indicatorVarNames.forEach((t=>{this.tableColumnsGrouped.push({name:t,label:t})})),this.tableColumnsGrouped.push({name:"latest_date",label:"Latest Date"});const f=this.inputSettings.settings.lines;f.show_main&&this.tableColumnsGrouped.push({name:"value",label:"Value"}),this.inputSettings.settings.spc.ttip_show_numerator&&this.tableColumnsGrouped.push({name:"numerator",label:"Numerator"}),this.inputSettings.settings.spc.ttip_show_denominator&&this.tableColumnsGrouped.push({name:"denominator",label:"Denominator"}),f.show_target&&this.tableColumnsGrouped.push({name:"target",label:f.ttip_label_target}),f.show_alt_target&&this.tableColumnsGrouped.push({name:"alt_target",label:f.ttip_label_alt_target}),["99","95","68"].forEach((t=>{f[`show_${t}`]&&this.tableColumnsGrouped.push({name:`ucl${t}`,label:`${f[`ttip_label_${t}_prefix_upper`]}${f[`ttip_label_${t}`]}`})})),["68","95","99"].forEach((t=>{f[`show_${t}`]&&this.tableColumnsGrouped.push({name:`lcl${t}`,label:`${f[`ttip_label_${t}_prefix_lower`]}${f[`ttip_label_${t}`]}`})}));const y=this.inputSettings.settings.nhs_icons;y.show_variation_icons&&this.tableColumnsGrouped.push({name:"variation",label:"Variation"}),y.show_assurance_icons&&this.tableColumnsGrouped.push({name:"assurance",label:"Assurance"});const g=this.inputDataGrouped.some((t=>{var e;return null===(e=null==t?void 0:t.tooltips)||void 0===e?void 0:e.some((t=>t.length>0))}));g&&(null===(e=null===(t=this.inputDataGrouped)||void 0===t?void 0:t[0].tooltips)||void 0===e||e[0].forEach((t=>{this.tableColumnsGrouped.push({name:t.displayName,label:t.displayName})})));for(let t=0;t<this.groupNames.length;t++){if(ca(null===(i=this.inputDataGrouped[t])||void 0===i?void 0:i.categories))continue;const e=ka(this.inputSettings.settingsGrouped[t],this.inputSettings.derivedSettingsGrouped[t]),f=this.inputSettings.settingsGrouped[t].summary_table.table_variation_filter,y=this.inputSettings.settingsGrouped[t].summary_table.table_assurance_filter,v=this.controlLimitsGrouped[t],_=this.outliersGrouped[t],w=v.keys.length-1,b=Ha(_,this.inputSettings.settingsGrouped[t]);if("all"!==f){if("improvement"===f&&!["improvementHigh","improvementLow"].includes(b[0]))continue;if("deterioration"===f&&!["concernHigh","concernLow"].includes(b[0]))continue;if("neutral"===f&&!["neutralHigh","neutralLow"].includes(b[0]))continue;if("common"===f&&"commonCause"!==b[0])continue;if("special"===f&&"commonCause"===b[0])continue}const N=da(v,this.inputSettings.settingsGrouped[t],this.inputSettings.derivedSettingsGrouped[t]);if("all"!==y){if("any"===y&&"inconsistent"===N)continue;if("pass"===y&&"consistentPass"!==N)continue;if("fail"===y&&"consistentFail"!==N)continue;if("inconsistent"===y&&"inconsistent"!==N)continue}const x=new Array;this.indicatorVarNames.forEach(((e,i)=>{x.push([e,this.groupNames[t][i]])})),x.push(["latest_date",null===(a=v.keys)||void 0===a?void 0:a[w].label]),x.push(["value",e(null===(r=v.values)||void 0===r?void 0:r[w],"value")]),x.push(["numerator",e(null===(o=v.numerators)||void 0===o?void 0:o[w],"integer")]),x.push(["denominator",e(null===(l=v.denominators)||void 0===l?void 0:l[w],"integer")]),x.push(["target",e(null===(n=v.targets)||void 0===n?void 0:n[w],"value")]),x.push(["alt_target",e(null===(s=v.alt_targets)||void 0===s?void 0:s[w],"value")]),x.push(["ucl99",e(null===(u=v.ul99)||void 0===u?void 0:u[w],"value")]),x.push(["ucl95",e(null===(p=v.ul95)||void 0===p?void 0:p[w],"value")]),x.push(["ucl68",e(null===(d=v.ul68)||void 0===d?void 0:d[w],"value")]),x.push(["lcl68",e(null===(c=v.ll68)||void 0===c?void 0:c[w],"value")]),x.push(["lcl95",e(null===(h=v.ll95)||void 0===h?void 0:h[w],"value")]),x.push(["lcl99",e(null===(m=v.ll99)||void 0===m?void 0:m[w],"value")]),x.push(["variation",b[0]]),x.push(["assurance",N]),g&&this.inputDataGrouped[t].tooltips[w].forEach((t=>{x.push([t.displayName,t.value])})),this.plotPointsGrouped.push({table_row:Object.fromEntries(x),identity:this.identitiesGrouped[t],aesthetics:this.inputSettings.settingsGrouped[t].summary_table,highlighted:this.inputDataGrouped[t].anyHighlights})}}initialisePlotData(t){var e,i,a,r,o,l,n,s,u,p,d,c,h,m,f,y,g,v,_,w,b,N,x,S;this.plotPoints=new Array,this.tickLabels=new Array,this.tableColumns=new Array,this.tableColumns.push({name:"date",label:"Date"}),this.tableColumns.push({name:"value",label:"Value"}),ca(this.controlLimits.numerators)||this.tableColumns.push({name:"numerator",label:"Numerator"}),ca(this.controlLimits.denominators)||this.tableColumns.push({name:"denominator",label:"Denominator"}),this.inputSettings.settings.lines.show_target&&this.tableColumns.push({name:"target",label:"Target"}),this.inputSettings.settings.lines.show_alt_target&&this.tableColumns.push({name:"alt_target",label:"Alt. Target"}),this.inputSettings.settings.lines.show_specification&&this.tableColumns.push({name:"speclimits_lower",label:"Spec. Lower"},{name:"speclimits_upper",label:"Spec. Upper"}),this.inputSettings.settings.lines.show_trend&&this.tableColumns.push({name:"trend_line",label:"Trend Line"}),this.inputSettings.derivedSettings.chart_type_props.has_control_limits&&(this.inputSettings.settings.lines.show_99&&this.tableColumns.push({name:"ll99",label:"LL 99%"},{name:"ul99",label:"UL 99%"}),this.inputSettings.settings.lines.show_95&&this.tableColumns.push({name:"ll95",label:"LL 95%"},{name:"ul95",label:"UL 95%"}),this.inputSettings.settings.lines.show_68&&this.tableColumns.push({name:"ll68",label:"LL 68%"},{name:"ul68",label:"UL 68%"})),this.inputSettings.settings.outliers.astronomical&&this.tableColumns.push({name:"astpoint",label:"Ast. Point"}),this.inputSettings.settings.outliers.trend&&this.tableColumns.push({name:"trend",label:"Trend"}),this.inputSettings.settings.outliers.shift&&this.tableColumns.push({name:"shift",label:"Shift"});for(let k=0;k<this.controlLimits.keys.length;k++){const A=this.controlLimits.keys[k].x,F=this.inputData.scatter_formatting[k];this.colourPalette.isHighContrast&&(F.colour=this.colourPalette.foregroundColour),"none"!==this.outliers.shift[k]&&(F.colour=Ba(this.outliers.shift[k],"outliers","shift_colour",this.inputSettings.settings),F.colour_outline=Ba(this.outliers.shift[k],"outliers","shift_colour",this.inputSettings.settings)),"none"!==this.outliers.trend[k]&&(F.colour=Ba(this.outliers.trend[k],"outliers","trend_colour",this.inputSettings.settings),F.colour_outline=Ba(this.outliers.trend[k],"outliers","trend_colour",this.inputSettings.settings)),"none"!==this.outliers.two_in_three[k]&&(F.colour=Ba(this.outliers.two_in_three[k],"outliers","twointhree_colour",this.inputSettings.settings),F.colour_outline=Ba(this.outliers.two_in_three[k],"outliers","twointhree_colour",this.inputSettings.settings)),"none"!==this.outliers.astpoint[k]&&(F.colour=Ba(this.outliers.astpoint[k],"outliers","ast_colour",this.inputSettings.settings),F.colour_outline=Ba(this.outliers.astpoint[k],"outliers","ast_colour",this.inputSettings.settings));const M={date:this.controlLimits.keys[k].label,numerator:null===(e=this.controlLimits.numerators)||void 0===e?void 0:e[k],denominator:null===(i=this.controlLimits.denominators)||void 0===i?void 0:i[k],value:this.controlLimits.values[k],target:this.controlLimits.targets[k],alt_target:this.controlLimits.alt_targets[k],ll99:null===(r=null===(a=this.controlLimits)||void 0===a?void 0:a.ll99)||void 0===r?void 0:r[k],ll95:null===(l=null===(o=this.controlLimits)||void 0===o?void 0:o.ll95)||void 0===l?void 0:l[k],ll68:null===(s=null===(n=this.controlLimits)||void 0===n?void 0:n.ll68)||void 0===s?void 0:s[k],ul68:null===(p=null===(u=this.controlLimits)||void 0===u?void 0:u.ul68)||void 0===p?void 0:p[k],ul95:null===(c=null===(d=this.controlLimits)||void 0===d?void 0:d.ul95)||void 0===c?void 0:c[k],ul99:null===(m=null===(h=this.controlLimits)||void 0===h?void 0:h.ul99)||void 0===m?void 0:m[k],speclimits_lower:null===(y=null===(f=this.controlLimits)||void 0===f?void 0:f.speclimits_lower)||void 0===y?void 0:y[k],speclimits_upper:null===(v=null===(g=this.controlLimits)||void 0===g?void 0:g.speclimits_upper)||void 0===v?void 0:v[k],trend_line:null===(w=null===(_=this.controlLimits)||void 0===_?void 0:_.trend_line)||void 0===w?void 0:w[k],astpoint:this.outliers.astpoint[k],trend:this.outliers.trend[k],shift:this.outliers.shift[k],two_in_three:this.outliers.two_in_three[k]};this.plotPoints.push({x:A,value:this.controlLimits.values[k],aesthetics:F,table_row:M,identity:t.createSelectionIdBuilder().withCategory(this.inputData.categories,this.inputData.limitInputArgs.keys[k].id).createSelectionId(),highlighted:!ca(null===(b=this.inputData.highlights)||void 0===b?void 0:b[A]),tooltip:Aa(M,null===(x=null===(N=this.inputData)||void 0===N?void 0:N.tooltips)||void 0===x?void 0:x[A],this.inputSettings.settings,this.inputSettings.derivedSettings),label:{text_value:null===(S=this.inputData.labels)||void 0===S?void 0:S[A],aesthetics:this.inputData.label_formatting[A],angle:null,distance:null,line_offset:null,marker_offset:null}}),this.tickLabels.push({x:A,label:this.controlLimits.keys[k].label})}}initialiseGroupedLines(){const t=new Array;this.inputSettings.settings.lines.show_main&&t.push("values"),this.inputSettings.settings.lines.show_target&&t.push("targets"),this.inputSettings.settings.lines.show_alt_target&&t.push("alt_targets"),this.inputSettings.settings.lines.show_specification&&t.push("speclimits_lower","speclimits_upper"),this.inputSettings.settings.lines.show_trend&&t.push("trend_line"),this.inputSettings.derivedSettings.chart_type_props.has_control_limits&&(this.inputSettings.settings.lines.show_99&&t.push("ll99","ul99"),this.inputSettings.settings.lines.show_95&&t.push("ll95","ul95"),this.inputSettings.settings.lines.show_68&&t.push("ll68","ul68"));const e=new Array,i=this.controlLimits.keys.length;for(let a=0;a<i;a++){const i=this.splitIndexes.includes(a-1)||this.inputData.groupingIndexes.includes(a-1);let r=!1;a>0&&this.inputSettings.settings.lines.show_alt_target&&(r=this.controlLimits.alt_targets[a]!==this.controlLimits.alt_targets[a-1]),t.forEach((t=>{var o,l;const n=this.inputSettings.settings.lines[`join_rebaselines_${za[t]}`];if(i||r){const l="alt_targets"===t&&r,s="alt_targets"!==t&&i;e.push({x:this.controlLimits.keys[a].x,line_value:n||!l&&!s?null===(o=this.controlLimits[t])||void 0===o?void 0:o[a]:null,group:t,aesthetics:this.inputData.line_formatting[a]})}e.push({x:this.controlLimits.keys[a].x,line_value:null===(l=this.controlLimits[t])||void 0===l?void 0:l[a],group:t,aesthetics:this.inputData.line_formatting[a]})}))}this.groupedLines=function(t,e){const i=new Map;return t.forEach((t=>{var a;const r=t[e];i.has(r)||i.set(r,[]),null===(a=i.get(r))||void 0===a||a.push(t)})),Array.from(i)}(e,"group")}scaleAndTruncateLimits(t,e,i){const a=i.multiplier;let r=["values","targets"];i.chart_type_props.has_control_limits&&(r=r.concat(["ll99","ll95","ll68","ul68","ul95","ul99"]));let o=r;e.lines.show_alt_target&&(o=o.concat(["alt_targets"]),e.lines.multiplier_alt_target&&(r=r.concat(["alt_targets"]))),e.lines.show_specification&&(o=o.concat(["speclimits_lower","speclimits_upper"]),e.lines.multiplier_specification&&(r=r.concat(["speclimits_lower","speclimits_upper"])));const l={lower:e.spc.ll_truncate,upper:e.spc.ul_truncate};r.forEach((e=>{t[e]=_a(t[e],a)})),o.forEach((e=>{t[e]=qa(t[e],l)}))}flagOutliers(t,e,i,a){var r,o,l,n;const s=i.outliers.process_flag_type,u=i.outliers.improvement_direction,p=i.outliers.trend_n,d=i.outliers.shift_n,c="Specification"===i.outliers.astronomical_limit,h="Specification"===i.outliers.two_in_three_limit,m={astpoint:Pa("none",t.values.length),two_in_three:Pa("none",t.values.length),trend:Pa("none",t.values.length),shift:Pa("none",t.values.length)};for(let s=0;s<e.length;s++){const u=e[s][0],f=e[s][1],y=t.values.slice(u,f),g=t.targets.slice(u,f);if(a.chart_type_props.has_control_limits||c||h){const e={"1 Sigma":"68","2 Sigma":"95","3 Sigma":"99",Specification:""};if(i.outliers.astronomical){const a=e[i.outliers.astronomical_limit],l=c?"speclimits_upper":"ul";Jl(y,null===(r=null==t?void 0:t[`${c?"speclimits_lower":"ll"}${a}`])||void 0===r?void 0:r.slice(u,f),null===(o=null==t?void 0:t[`${l}${a}`])||void 0===o?void 0:o.slice(u,f)).forEach(((t,e)=>m.astpoint[u+e]=t))}if(i.outliers.two_in_three){const a=i.outliers.two_in_three_highlight_series,r=e[i.outliers.two_in_three_limit],o=h?"speclimits_upper":"ul";en(y,null===(l=null==t?void 0:t[`${h?"speclimits_lower":"ll"}${r}`])||void 0===l?void 0:l.slice(u,f),null===(n=null==t?void 0:t[`${o}${r}`])||void 0===n?void 0:n.slice(u,f),a).forEach(((t,e)=>m.two_in_three[u+e]=t))}}i.outliers.trend&&tn(y,p).forEach(((t,e)=>m.trend[u+e]=t)),i.outliers.shift&&Ql(y,g,d).forEach(((t,e)=>m.shift[u+e]=t))}return Object.keys(m).forEach((t=>{m[t]=Fa(m[t],{process_flag_type:s,improvement_direction:u})})),m}}return t.Visual=class{constructor(t){this.tableDiv=ut(t.element).append("div").style("overflow","auto"),this.svg=ut(t.element).append("svg"),this.host=t.host,this.viewModel=new an,this.plotProperties=new Lr,this.selectionManager=this.host.createSelectionManager(),this.selectionManager.registerOnSelectCallback((()=>this.updateHighlighting())),this.svg.call(wr);const e=this.tableDiv.append("table").classed("table-group",!0).style("border-collapse","collapse").style("width","100%").style("height","100%");e.append("thead").append("tr").classed("table-header",!0),e.append("tbody").classed("table-body",!0)}update(t){var e,i,a,r,o;try{this.host.eventService.renderingStarted(t),this.svg.select(".errormessage").remove();const l=this.viewModel.update(t,this.host);if(!l.status)return this.resizeCanvas(t.viewport.width,t.viewport.height),null===(o=null===(r=null===(a=null===(i=null===(e=this.viewModel)||void 0===e?void 0:e.inputSettings)||void 0===i?void 0:i.settings)||void 0===a?void 0:a.canvas)||void 0===r?void 0:r.show_errors)||void 0===o||o?this.svg.call(br,t,this.viewModel.colourPalette,null==l?void 0:l.error,null==l?void 0:l.type):this.svg.call(wr,!0),void this.host.eventService.renderingFailed(t);this.plotProperties.update(t,this.viewModel),l.warning&&this.host.displayWarningIcon("Invalid inputs or settings ignored.\n",l.warning),this.viewModel.showGrouped||this.viewModel.inputSettings.settings.summary_table.show_table?(this.resizeCanvas(0,0),this.tableDiv.call(Ar,this).call(pa,this)):(this.resizeCanvas(t.viewport.width,t.viewport.height),this.drawVisual(),this.adjustPaddingForOverflow()),this.updateHighlighting(),this.host.eventService.renderingFinished(t)}catch(e){this.resizeCanvas(t.viewport.width,t.viewport.height),this.svg.call(br,t,this.viewModel.colourPalette,e.message,"internal"),console.error(e),this.host.eventService.renderingFailed(t)}}drawVisual(){this.svg.call(vr,this).call(_r,this).call(gr,this).call(yr,this).call(Dr,this).call(dr,this).call(fr,this).call(pa,this).call(Fr,this).call(Mr,this)}adjustPaddingForOverflow(){if(this.viewModel.headless)return;const t=this.viewModel.svgWidth,e=this.viewModel.svgHeight,i=this.svg.node().getBBox(),a=Math.abs(Math.min(0,i.x)),r=Math.max(0,i.width+i.x-t),o=Math.abs(Math.min(0,i.y)),l=Math.max(0,i.height+i.y-e);a>0&&(this.plotProperties.xAxis.start_padding+=a+this.plotProperties.xAxis.start_padding),r>0&&(this.plotProperties.xAxis.end_padding+=r+this.plotProperties.xAxis.end_padding),o>0&&(this.plotProperties.yAxis.end_padding+=o+this.plotProperties.yAxis.end_padding),l>0&&(this.plotProperties.yAxis.start_padding+=l+this.plotProperties.yAxis.start_padding),(a>0||r>0||o>0||l>0)&&(this.plotProperties.initialiseScale(t,e),this.drawVisual())}resizeCanvas(t,e){this.svg.attr("width",t).attr("height",e),0===t&&0===e?this.tableDiv.style("width","100%").style("height","100%"):this.tableDiv.style("width","0%").style("height","0%")}updateHighlighting(){const t=!!this.viewModel.inputData&&this.viewModel.inputData.anyHighlights,e=!!this.viewModel.inputDataGrouped&&this.viewModel.inputDataGrouped.some((t=>t.anyHighlights)),i=this.selectionManager.getSelectionIds(),a=this.svg.selectAll(".dotsgroup").selectChildren(),r=this.svg.selectAll(".linesgroup").selectChildren(),o=this.tableDiv.selectAll(".table-body").selectChildren();r.style("stroke-opacity",(t=>Ba(t[0],"lines","opacity",this.viewModel.inputSettings.settings))),a.style("fill-opacity",(t=>t.aesthetics.opacity)),a.style("stroke-opacity",(t=>t.aesthetics.opacity)),o.style("opacity",(t=>t.aesthetics.table_opacity)),(t||i.length>0||e)&&(r.style("stroke-opacity",(t=>Ba(t[0],"lines","opacity_unselected",this.viewModel.inputSettings.settings))),a.nodes().forEach((t=>{const e=ut(t).datum(),i=rr(e.identity,this.selectionManager),a=e.highlighted,r=i||a?e.aesthetics.opacity_selected:e.aesthetics.opacity_unselected;ut(t).style("fill-opacity",r),ut(t).style("stroke-opacity",r)})),o.nodes().forEach((t=>{const e=ut(t).datum(),i=rr(e.identity,this.selectionManager),a=e.highlighted,r=i||a?e.aesthetics.table_opacity_selected:e.aesthetics.table_opacity_unselected;ut(t).style("opacity",r)})))}getFormattingModel(){return this.viewModel.inputSettings.getFormattingModel()}},t.d3=Ki,t.defaultSettings=ua,t}({});
