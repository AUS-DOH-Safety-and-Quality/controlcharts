name: "Update SPC/Funnel Chart Library"
on:
  workflow_dispatch:
    inputs:
      library:
        description: "Library to update"
        required: true
        type: choice
        options:
          - SPC
          - Funnel
permissions:
  contents: write

jobs:
  update-lib:
    name: "Update Library"
    runs-on: "ubuntu-latest"

    steps:
    - uses: actions/checkout@v5

    - name: Set name variables
      run: |
        if [ "${{ github.event.inputs.library }}" == "SPC" ]; then
          echo "REPO_NAME=PowerBI-SPC" >> $GITHUB_ENV
          echo "LIB_NAME=PBISPC" >> $GITHUB_ENV
          echo "YAML_NAME=spc" >> $GITHUB_ENV
        elif [ "${{ github.event.inputs.library }}" == "Funnel" ]; then
          echo "REPO_NAME=PowerBI-Funnels" >> $GITHUB_ENV
          echo "LIB_NAME=PBIFUN" >> $GITHUB_ENV
          echo "YAML_NAME=funnel" >> $GITHUB_ENV
        fi

    - name: Clone Library Repo
      uses: actions/checkout@v5
      with:
        repository: "AUS-DOH-Safety-and-Quality/$REPO_NAME"
        path: $REPO_NAME

    - name: Install Dependencies
      run: npm install
      working-directory: $REPO_NAME
